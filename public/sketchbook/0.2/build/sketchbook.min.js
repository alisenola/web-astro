/*!
 * Sketchbook 0.1 (https://github.com/swift502/Sketchbook)
 * Built on three.js (https://github.com/mrdoob/three.js) and cannon.js (https://github.com/schteppe/cannon.js)
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("THREE"),require("CANNON")):"function"==typeof define&&define.amd?define(["THREE","CANNON"],t):"object"==typeof exports?exports.Sketchbook=t(require("THREE"),require("CANNON")):e.Sketchbook=t(e.THREE,e.CANNON)}(window,function(e,t){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=16)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t,n){(function(e,r){var i;
/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright JS Foundation and other contributors <https://js.foundation/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(){var a,o=200,s="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",l="Expected a function",u="__lodash_hash_undefined__",c=500,h="__lodash_placeholder__",f=1,d=2,p=4,m=1,v=2,g=1,_=2,y=4,A=8,x=16,b=32,w=64,S=128,F=256,T=512,E=30,L="...",P=800,I=16,M=1,C=2,N=1/0,R=9007199254740991,O=1.7976931348623157e308,U=NaN,k=4294967295,D=k-1,B=k>>>1,X=[["ary",S],["bind",g],["bindKey",_],["curry",A],["curryRight",x],["flip",T],["partial",b],["partialRight",w],["rearg",F]],V="[object Arguments]",j="[object Array]",G="[object AsyncFunction]",H="[object Boolean]",z="[object Date]",Y="[object DOMException]",Q="[object Error]",W="[object Function]",K="[object GeneratorFunction]",q="[object Map]",Z="[object Number]",J="[object Null]",$="[object Object]",ee="[object Proxy]",te="[object RegExp]",ne="[object Set]",re="[object String]",ie="[object Symbol]",ae="[object Undefined]",oe="[object WeakMap]",se="[object WeakSet]",le="[object ArrayBuffer]",ue="[object DataView]",ce="[object Float32Array]",he="[object Float64Array]",fe="[object Int8Array]",de="[object Int16Array]",pe="[object Int32Array]",me="[object Uint8Array]",ve="[object Uint8ClampedArray]",ge="[object Uint16Array]",_e="[object Uint32Array]",ye=/\b__p \+= '';/g,Ae=/\b(__p \+=) '' \+/g,xe=/(__e\(.*?\)|\b__t\)) \+\n'';/g,be=/&(?:amp|lt|gt|quot|#39);/g,we=/[&<>"']/g,Se=RegExp(be.source),Fe=RegExp(we.source),Te=/<%-([\s\S]+?)%>/g,Ee=/<%([\s\S]+?)%>/g,Le=/<%=([\s\S]+?)%>/g,Pe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ie=/^\w*$/,Me=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Ce=/[\\^$.*+?()[\]{}|]/g,Ne=RegExp(Ce.source),Re=/^\s+|\s+$/g,Oe=/^\s+/,Ue=/\s+$/,ke=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,De=/\{\n\/\* \[wrapped with (.+)\] \*/,Be=/,? & /,Xe=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Ve=/\\(\\)?/g,je=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ge=/\w*$/,He=/^[-+]0x[0-9a-f]+$/i,ze=/^0b[01]+$/i,Ye=/^\[object .+?Constructor\]$/,Qe=/^0o[0-7]+$/i,We=/^(?:0|[1-9]\d*)$/,Ke=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,qe=/($^)/,Ze=/['\n\r\u2028\u2029\\]/g,Je="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",$e="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",et="[\\ud800-\\udfff]",tt="["+$e+"]",nt="["+Je+"]",rt="\\d+",it="[\\u2700-\\u27bf]",at="[a-z\\xdf-\\xf6\\xf8-\\xff]",ot="[^\\ud800-\\udfff"+$e+rt+"\\u2700-\\u27bfa-z\\xdf-\\xf6\\xf8-\\xffA-Z\\xc0-\\xd6\\xd8-\\xde]",st="\\ud83c[\\udffb-\\udfff]",lt="[^\\ud800-\\udfff]",ut="(?:\\ud83c[\\udde6-\\uddff]){2}",ct="[\\ud800-\\udbff][\\udc00-\\udfff]",ht="[A-Z\\xc0-\\xd6\\xd8-\\xde]",ft="(?:"+at+"|"+ot+")",dt="(?:"+ht+"|"+ot+")",pt="(?:"+nt+"|"+st+")"+"?",mt="[\\ufe0e\\ufe0f]?"+pt+("(?:\\u200d(?:"+[lt,ut,ct].join("|")+")[\\ufe0e\\ufe0f]?"+pt+")*"),vt="(?:"+[it,ut,ct].join("|")+")"+mt,gt="(?:"+[lt+nt+"?",nt,ut,ct,et].join("|")+")",_t=RegExp("['’]","g"),yt=RegExp(nt,"g"),At=RegExp(st+"(?="+st+")|"+gt+mt,"g"),xt=RegExp([ht+"?"+at+"+(?:['’](?:d|ll|m|re|s|t|ve))?(?="+[tt,ht,"$"].join("|")+")",dt+"+(?:['’](?:D|LL|M|RE|S|T|VE))?(?="+[tt,ht+ft,"$"].join("|")+")",ht+"?"+ft+"+(?:['’](?:d|ll|m|re|s|t|ve))?",ht+"+(?:['’](?:D|LL|M|RE|S|T|VE))?","\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",rt,vt].join("|"),"g"),bt=RegExp("[\\u200d\\ud800-\\udfff"+Je+"\\ufe0e\\ufe0f]"),wt=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,St=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ft=-1,Tt={};Tt[ce]=Tt[he]=Tt[fe]=Tt[de]=Tt[pe]=Tt[me]=Tt[ve]=Tt[ge]=Tt[_e]=!0,Tt[V]=Tt[j]=Tt[le]=Tt[H]=Tt[ue]=Tt[z]=Tt[Q]=Tt[W]=Tt[q]=Tt[Z]=Tt[$]=Tt[te]=Tt[ne]=Tt[re]=Tt[oe]=!1;var Et={};Et[V]=Et[j]=Et[le]=Et[ue]=Et[H]=Et[z]=Et[ce]=Et[he]=Et[fe]=Et[de]=Et[pe]=Et[q]=Et[Z]=Et[$]=Et[te]=Et[ne]=Et[re]=Et[ie]=Et[me]=Et[ve]=Et[ge]=Et[_e]=!0,Et[Q]=Et[W]=Et[oe]=!1;var Lt={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Pt=parseFloat,It=parseInt,Mt="object"==typeof e&&e&&e.Object===Object&&e,Ct="object"==typeof self&&self&&self.Object===Object&&self,Nt=Mt||Ct||Function("return this")(),Rt="object"==typeof t&&t&&!t.nodeType&&t,Ot=Rt&&"object"==typeof r&&r&&!r.nodeType&&r,Ut=Ot&&Ot.exports===Rt,kt=Ut&&Mt.process,Dt=function(){try{var e=Ot&&Ot.require&&Ot.require("util").types;return e||kt&&kt.binding&&kt.binding("util")}catch(e){}}(),Bt=Dt&&Dt.isArrayBuffer,Xt=Dt&&Dt.isDate,Vt=Dt&&Dt.isMap,jt=Dt&&Dt.isRegExp,Gt=Dt&&Dt.isSet,Ht=Dt&&Dt.isTypedArray;function zt(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function Yt(e,t,n,r){for(var i=-1,a=null==e?0:e.length;++i<a;){var o=e[i];t(r,o,n(o),e)}return r}function Qt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n,e););return e}function Wt(e,t){for(var n=null==e?0:e.length;n--&&!1!==t(e[n],n,e););return e}function Kt(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}function qt(e,t){for(var n=-1,r=null==e?0:e.length,i=0,a=[];++n<r;){var o=e[n];t(o,n,e)&&(a[i++]=o)}return a}function Zt(e,t){return!!(null==e?0:e.length)&&ln(e,t,0)>-1}function Jt(e,t,n){for(var r=-1,i=null==e?0:e.length;++r<i;)if(n(t,e[r]))return!0;return!1}function $t(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}function en(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}function tn(e,t,n,r){var i=-1,a=null==e?0:e.length;for(r&&a&&(n=e[++i]);++i<a;)n=t(n,e[i],i,e);return n}function nn(e,t,n,r){var i=null==e?0:e.length;for(r&&i&&(n=e[--i]);i--;)n=t(n,e[i],i,e);return n}function rn(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var an=fn("length");function on(e,t,n){var r;return n(e,function(e,n,i){if(t(e,n,i))return r=n,!1}),r}function sn(e,t,n,r){for(var i=e.length,a=n+(r?1:-1);r?a--:++a<i;)if(t(e[a],a,e))return a;return-1}function ln(e,t,n){return t==t?function(e,t,n){var r=n-1,i=e.length;for(;++r<i;)if(e[r]===t)return r;return-1}(e,t,n):sn(e,cn,n)}function un(e,t,n,r){for(var i=n-1,a=e.length;++i<a;)if(r(e[i],t))return i;return-1}function cn(e){return e!=e}function hn(e,t){var n=null==e?0:e.length;return n?mn(e,t)/n:U}function fn(e){return function(t){return null==t?a:t[e]}}function dn(e){return function(t){return null==e?a:e[t]}}function pn(e,t,n,r,i){return i(e,function(e,i,a){n=r?(r=!1,e):t(n,e,i,a)}),n}function mn(e,t){for(var n,r=-1,i=e.length;++r<i;){var o=t(e[r]);o!==a&&(n=n===a?o:n+o)}return n}function vn(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}function gn(e){return function(t){return e(t)}}function _n(e,t){return $t(t,function(t){return e[t]})}function yn(e,t){return e.has(t)}function An(e,t){for(var n=-1,r=e.length;++n<r&&ln(t,e[n],0)>-1;);return n}function xn(e,t){for(var n=e.length;n--&&ln(t,e[n],0)>-1;);return n}var bn=dn({"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss","Ā":"A","Ă":"A","Ą":"A","ā":"a","ă":"a","ą":"a","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","ć":"c","ĉ":"c","ċ":"c","č":"c","Ď":"D","Đ":"D","ď":"d","đ":"d","Ē":"E","Ĕ":"E","Ė":"E","Ę":"E","Ě":"E","ē":"e","ĕ":"e","ė":"e","ę":"e","ě":"e","Ĝ":"G","Ğ":"G","Ġ":"G","Ģ":"G","ĝ":"g","ğ":"g","ġ":"g","ģ":"g","Ĥ":"H","Ħ":"H","ĥ":"h","ħ":"h","Ĩ":"I","Ī":"I","Ĭ":"I","Į":"I","İ":"I","ĩ":"i","ī":"i","ĭ":"i","į":"i","ı":"i","Ĵ":"J","ĵ":"j","Ķ":"K","ķ":"k","ĸ":"k","Ĺ":"L","Ļ":"L","Ľ":"L","Ŀ":"L","Ł":"L","ĺ":"l","ļ":"l","ľ":"l","ŀ":"l","ł":"l","Ń":"N","Ņ":"N","Ň":"N","Ŋ":"N","ń":"n","ņ":"n","ň":"n","ŋ":"n","Ō":"O","Ŏ":"O","Ő":"O","ō":"o","ŏ":"o","ő":"o","Ŕ":"R","Ŗ":"R","Ř":"R","ŕ":"r","ŗ":"r","ř":"r","Ś":"S","Ŝ":"S","Ş":"S","Š":"S","ś":"s","ŝ":"s","ş":"s","š":"s","Ţ":"T","Ť":"T","Ŧ":"T","ţ":"t","ť":"t","ŧ":"t","Ũ":"U","Ū":"U","Ŭ":"U","Ů":"U","Ű":"U","Ų":"U","ũ":"u","ū":"u","ŭ":"u","ů":"u","ű":"u","ų":"u","Ŵ":"W","ŵ":"w","Ŷ":"Y","ŷ":"y","Ÿ":"Y","Ź":"Z","Ż":"Z","Ž":"Z","ź":"z","ż":"z","ž":"z","Ĳ":"IJ","ĳ":"ij","Œ":"Oe","œ":"oe","ŉ":"'n","ſ":"s"}),wn=dn({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Sn(e){return"\\"+Lt[e]}function Fn(e){return bt.test(e)}function Tn(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n}function En(e,t){return function(n){return e(t(n))}}function Ln(e,t){for(var n=-1,r=e.length,i=0,a=[];++n<r;){var o=e[n];o!==t&&o!==h||(e[n]=h,a[i++]=n)}return a}function Pn(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n}function In(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=[e,e]}),n}function Mn(e){return Fn(e)?function(e){var t=At.lastIndex=0;for(;At.test(e);)++t;return t}(e):an(e)}function Cn(e){return Fn(e)?function(e){return e.match(At)||[]}(e):function(e){return e.split("")}(e)}var Nn=dn({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"});var Rn=function e(t){var n=(t=null==t?Nt:Rn.defaults(Nt.Object(),t,Rn.pick(Nt,St))).Array,r=t.Date,i=t.Error,Je=t.Function,$e=t.Math,et=t.Object,tt=t.RegExp,nt=t.String,rt=t.TypeError,it=n.prototype,at=Je.prototype,ot=et.prototype,st=t["__core-js_shared__"],lt=at.toString,ut=ot.hasOwnProperty,ct=0,ht=function(){var e=/[^.]+$/.exec(st&&st.keys&&st.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),ft=ot.toString,dt=lt.call(et),pt=Nt._,mt=tt("^"+lt.call(ut).replace(Ce,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),vt=Ut?t.Buffer:a,gt=t.Symbol,At=t.Uint8Array,bt=vt?vt.allocUnsafe:a,Lt=En(et.getPrototypeOf,et),Mt=et.create,Ct=ot.propertyIsEnumerable,Rt=it.splice,Ot=gt?gt.isConcatSpreadable:a,kt=gt?gt.iterator:a,Dt=gt?gt.toStringTag:a,an=function(){try{var e=ka(et,"defineProperty");return e({},"",{}),e}catch(e){}}(),dn=t.clearTimeout!==Nt.clearTimeout&&t.clearTimeout,On=r&&r.now!==Nt.Date.now&&r.now,Un=t.setTimeout!==Nt.setTimeout&&t.setTimeout,kn=$e.ceil,Dn=$e.floor,Bn=et.getOwnPropertySymbols,Xn=vt?vt.isBuffer:a,Vn=t.isFinite,jn=it.join,Gn=En(et.keys,et),Hn=$e.max,zn=$e.min,Yn=r.now,Qn=t.parseInt,Wn=$e.random,Kn=it.reverse,qn=ka(t,"DataView"),Zn=ka(t,"Map"),Jn=ka(t,"Promise"),$n=ka(t,"Set"),er=ka(t,"WeakMap"),tr=ka(et,"create"),nr=er&&new er,rr={},ir=uo(qn),ar=uo(Zn),or=uo(Jn),sr=uo($n),lr=uo(er),ur=gt?gt.prototype:a,cr=ur?ur.valueOf:a,hr=ur?ur.toString:a;function fr(e){if(Es(e)&&!vs(e)&&!(e instanceof vr)){if(e instanceof mr)return e;if(ut.call(e,"__wrapped__"))return co(e)}return new mr(e)}var dr=function(){function e(){}return function(t){if(!Ts(t))return{};if(Mt)return Mt(t);e.prototype=t;var n=new e;return e.prototype=a,n}}();function pr(){}function mr(e,t){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!t,this.__index__=0,this.__values__=a}function vr(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=k,this.__views__=[]}function gr(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function _r(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function yr(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Ar(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new yr;++t<n;)this.add(e[t])}function xr(e){var t=this.__data__=new _r(e);this.size=t.size}function br(e,t){var n=vs(e),r=!n&&ms(e),i=!n&&!r&&As(e),a=!n&&!r&&!i&&Os(e),o=n||r||i||a,s=o?vn(e.length,nt):[],l=s.length;for(var u in e)!t&&!ut.call(e,u)||o&&("length"==u||i&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||Ha(u,l))||s.push(u);return s}function wr(e){var t=e.length;return t?e[Ai(0,t-1)]:a}function Sr(e,t){return oo(ta(e),Nr(t,0,e.length))}function Fr(e){return oo(ta(e))}function Tr(e,t,n){(n===a||fs(e[t],n))&&(n!==a||t in e)||Mr(e,t,n)}function Er(e,t,n){var r=e[t];ut.call(e,t)&&fs(r,n)&&(n!==a||t in e)||Mr(e,t,n)}function Lr(e,t){for(var n=e.length;n--;)if(fs(e[n][0],t))return n;return-1}function Pr(e,t,n,r){return Dr(e,function(e,i,a){t(r,e,n(e),a)}),r}function Ir(e,t){return e&&na(t,rl(t),e)}function Mr(e,t,n){"__proto__"==t&&an?an(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function Cr(e,t){for(var r=-1,i=t.length,o=n(i),s=null==e;++r<i;)o[r]=s?a:Js(e,t[r]);return o}function Nr(e,t,n){return e==e&&(n!==a&&(e=e<=n?e:n),t!==a&&(e=e>=t?e:t)),e}function Rr(e,t,n,r,i,o){var s,l=t&f,u=t&d,c=t&p;if(n&&(s=i?n(e,r,i,o):n(e)),s!==a)return s;if(!Ts(e))return e;var h=vs(e);if(h){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&ut.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!l)return ta(e,s)}else{var m=Xa(e),v=m==W||m==K;if(As(e))return Ki(e,l);if(m==$||m==V||v&&!i){if(s=u||v?{}:ja(e),!l)return u?function(e,t){return na(e,Ba(e),t)}(e,function(e,t){return e&&na(t,il(t),e)}(s,e)):function(e,t){return na(e,Da(e),t)}(e,Ir(s,e))}else{if(!Et[m])return i?e:{};s=function(e,t,n){var r=e.constructor;switch(t){case le:return qi(e);case H:case z:return new r(+e);case ue:return function(e,t){var n=t?qi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case ce:case he:case fe:case de:case pe:case me:case ve:case ge:case _e:return Zi(e,n);case q:return new r;case Z:case re:return new r(e);case te:return function(e){var t=new e.constructor(e.source,Ge.exec(e));return t.lastIndex=e.lastIndex,t}(e);case ne:return new r;case ie:return function(e){return cr?et(cr.call(e)):{}}(e)}}(e,m,l)}}o||(o=new xr);var g=o.get(e);if(g)return g;if(o.set(e,s),Cs(e))return e.forEach(function(r){s.add(Rr(r,t,n,r,e,o))}),s;if(Ls(e))return e.forEach(function(r,i){s.set(i,Rr(r,t,n,i,e,o))}),s;var _=h?a:(c?u?Ia:Pa:u?il:rl)(e);return Qt(_||e,function(r,i){_&&(r=e[i=r]),Er(s,i,Rr(r,t,n,i,e,o))}),s}function Or(e,t,n){var r=n.length;if(null==e)return!r;for(e=et(e);r--;){var i=n[r],o=t[i],s=e[i];if(s===a&&!(i in e)||!o(s))return!1}return!0}function Ur(e,t,n){if("function"!=typeof e)throw new rt(l);return no(function(){e.apply(a,n)},t)}function kr(e,t,n,r){var i=-1,a=Zt,s=!0,l=e.length,u=[],c=t.length;if(!l)return u;n&&(t=$t(t,gn(n))),r?(a=Jt,s=!1):t.length>=o&&(a=yn,s=!1,t=new Ar(t));e:for(;++i<l;){var h=e[i],f=null==n?h:n(h);if(h=r||0!==h?h:0,s&&f==f){for(var d=c;d--;)if(t[d]===f)continue e;u.push(h)}else a(t,f,r)||u.push(h)}return u}fr.templateSettings={escape:Te,evaluate:Ee,interpolate:Le,variable:"",imports:{_:fr}},fr.prototype=pr.prototype,fr.prototype.constructor=fr,mr.prototype=dr(pr.prototype),mr.prototype.constructor=mr,vr.prototype=dr(pr.prototype),vr.prototype.constructor=vr,gr.prototype.clear=function(){this.__data__=tr?tr(null):{},this.size=0},gr.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},gr.prototype.get=function(e){var t=this.__data__;if(tr){var n=t[e];return n===u?a:n}return ut.call(t,e)?t[e]:a},gr.prototype.has=function(e){var t=this.__data__;return tr?t[e]!==a:ut.call(t,e)},gr.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=tr&&t===a?u:t,this},_r.prototype.clear=function(){this.__data__=[],this.size=0},_r.prototype.delete=function(e){var t=this.__data__,n=Lr(t,e);return!(n<0||(n==t.length-1?t.pop():Rt.call(t,n,1),--this.size,0))},_r.prototype.get=function(e){var t=this.__data__,n=Lr(t,e);return n<0?a:t[n][1]},_r.prototype.has=function(e){return Lr(this.__data__,e)>-1},_r.prototype.set=function(e,t){var n=this.__data__,r=Lr(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this},yr.prototype.clear=function(){this.size=0,this.__data__={hash:new gr,map:new(Zn||_r),string:new gr}},yr.prototype.delete=function(e){var t=Oa(this,e).delete(e);return this.size-=t?1:0,t},yr.prototype.get=function(e){return Oa(this,e).get(e)},yr.prototype.has=function(e){return Oa(this,e).has(e)},yr.prototype.set=function(e,t){var n=Oa(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Ar.prototype.add=Ar.prototype.push=function(e){return this.__data__.set(e,u),this},Ar.prototype.has=function(e){return this.__data__.has(e)},xr.prototype.clear=function(){this.__data__=new _r,this.size=0},xr.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},xr.prototype.get=function(e){return this.__data__.get(e)},xr.prototype.has=function(e){return this.__data__.has(e)},xr.prototype.set=function(e,t){var n=this.__data__;if(n instanceof _r){var r=n.__data__;if(!Zn||r.length<o-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new yr(r)}return n.set(e,t),this.size=n.size,this};var Dr=aa(Yr),Br=aa(Qr,!0);function Xr(e,t){var n=!0;return Dr(e,function(e,r,i){return n=!!t(e,r,i)}),n}function Vr(e,t,n){for(var r=-1,i=e.length;++r<i;){var o=e[r],s=t(o);if(null!=s&&(l===a?s==s&&!Rs(s):n(s,l)))var l=s,u=o}return u}function jr(e,t){var n=[];return Dr(e,function(e,r,i){t(e,r,i)&&n.push(e)}),n}function Gr(e,t,n,r,i){var a=-1,o=e.length;for(n||(n=Ga),i||(i=[]);++a<o;){var s=e[a];t>0&&n(s)?t>1?Gr(s,t-1,n,r,i):en(i,s):r||(i[i.length]=s)}return i}var Hr=oa(),zr=oa(!0);function Yr(e,t){return e&&Hr(e,t,rl)}function Qr(e,t){return e&&zr(e,t,rl)}function Wr(e,t){return qt(t,function(t){return ws(e[t])})}function Kr(e,t){for(var n=0,r=(t=zi(t,e)).length;null!=e&&n<r;)e=e[lo(t[n++])];return n&&n==r?e:a}function qr(e,t,n){var r=t(e);return vs(e)?r:en(r,n(e))}function Zr(e){return null==e?e===a?ae:J:Dt&&Dt in et(e)?function(e){var t=ut.call(e,Dt),n=e[Dt];try{e[Dt]=a;var r=!0}catch(e){}var i=ft.call(e);return r&&(t?e[Dt]=n:delete e[Dt]),i}(e):function(e){return ft.call(e)}(e)}function Jr(e,t){return e>t}function $r(e,t){return null!=e&&ut.call(e,t)}function ei(e,t){return null!=e&&t in et(e)}function ti(e,t,r){for(var i=r?Jt:Zt,o=e[0].length,s=e.length,l=s,u=n(s),c=1/0,h=[];l--;){var f=e[l];l&&t&&(f=$t(f,gn(t))),c=zn(f.length,c),u[l]=!r&&(t||o>=120&&f.length>=120)?new Ar(l&&f):a}f=e[0];var d=-1,p=u[0];e:for(;++d<o&&h.length<c;){var m=f[d],v=t?t(m):m;if(m=r||0!==m?m:0,!(p?yn(p,v):i(h,v,r))){for(l=s;--l;){var g=u[l];if(!(g?yn(g,v):i(e[l],v,r)))continue e}p&&p.push(v),h.push(m)}}return h}function ni(e,t,n){var r=null==(e=$a(e,t=zi(t,e)))?e:e[lo(bo(t))];return null==r?a:zt(r,e,n)}function ri(e){return Es(e)&&Zr(e)==V}function ii(e,t,n,r,i){return e===t||(null==e||null==t||!Es(e)&&!Es(t)?e!=e&&t!=t:function(e,t,n,r,i,o){var s=vs(e),l=vs(t),u=s?j:Xa(e),c=l?j:Xa(t),h=(u=u==V?$:u)==$,f=(c=c==V?$:c)==$,d=u==c;if(d&&As(e)){if(!As(t))return!1;s=!0,h=!1}if(d&&!h)return o||(o=new xr),s||Os(e)?Ea(e,t,n,r,i,o):function(e,t,n,r,i,a,o){switch(n){case ue:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case le:return!(e.byteLength!=t.byteLength||!a(new At(e),new At(t)));case H:case z:case Z:return fs(+e,+t);case Q:return e.name==t.name&&e.message==t.message;case te:case re:return e==t+"";case q:var s=Tn;case ne:var l=r&m;if(s||(s=Pn),e.size!=t.size&&!l)return!1;var u=o.get(e);if(u)return u==t;r|=v,o.set(e,t);var c=Ea(s(e),s(t),r,i,a,o);return o.delete(e),c;case ie:if(cr)return cr.call(e)==cr.call(t)}return!1}(e,t,u,n,r,i,o);if(!(n&m)){var p=h&&ut.call(e,"__wrapped__"),g=f&&ut.call(t,"__wrapped__");if(p||g){var _=p?e.value():e,y=g?t.value():t;return o||(o=new xr),i(_,y,n,r,o)}}return!!d&&(o||(o=new xr),function(e,t,n,r,i,o){var s=n&m,l=Pa(e),u=l.length,c=Pa(t).length;if(u!=c&&!s)return!1;for(var h=u;h--;){var f=l[h];if(!(s?f in t:ut.call(t,f)))return!1}var d=o.get(e);if(d&&o.get(t))return d==t;var p=!0;o.set(e,t),o.set(t,e);for(var v=s;++h<u;){f=l[h];var g=e[f],_=t[f];if(r)var y=s?r(_,g,f,t,e,o):r(g,_,f,e,t,o);if(!(y===a?g===_||i(g,_,n,r,o):y)){p=!1;break}v||(v="constructor"==f)}if(p&&!v){var A=e.constructor,x=t.constructor;A!=x&&"constructor"in e&&"constructor"in t&&!("function"==typeof A&&A instanceof A&&"function"==typeof x&&x instanceof x)&&(p=!1)}return o.delete(e),o.delete(t),p}(e,t,n,r,i,o))}(e,t,n,r,ii,i))}function ai(e,t,n,r){var i=n.length,o=i,s=!r;if(null==e)return!o;for(e=et(e);i--;){var l=n[i];if(s&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++i<o;){var u=(l=n[i])[0],c=e[u],h=l[1];if(s&&l[2]){if(c===a&&!(u in e))return!1}else{var f=new xr;if(r)var d=r(c,h,u,e,t,f);if(!(d===a?ii(h,c,m|v,r,f):d))return!1}}return!0}function oi(e){return!(!Ts(e)||function(e){return!!ht&&ht in e}(e))&&(ws(e)?mt:Ye).test(uo(e))}function si(e){return"function"==typeof e?e:null==e?Pl:"object"==typeof e?vs(e)?di(e[0],e[1]):fi(e):Dl(e)}function li(e){if(!Ka(e))return Gn(e);var t=[];for(var n in et(e))ut.call(e,n)&&"constructor"!=n&&t.push(n);return t}function ui(e){if(!Ts(e))return function(e){var t=[];if(null!=e)for(var n in et(e))t.push(n);return t}(e);var t=Ka(e),n=[];for(var r in e)("constructor"!=r||!t&&ut.call(e,r))&&n.push(r);return n}function ci(e,t){return e<t}function hi(e,t){var r=-1,i=_s(e)?n(e.length):[];return Dr(e,function(e,n,a){i[++r]=t(e,n,a)}),i}function fi(e){var t=Ua(e);return 1==t.length&&t[0][2]?Za(t[0][0],t[0][1]):function(n){return n===e||ai(n,e,t)}}function di(e,t){return Ya(e)&&qa(t)?Za(lo(e),t):function(n){var r=Js(n,e);return r===a&&r===t?$s(n,e):ii(t,r,m|v)}}function pi(e,t,n,r,i){e!==t&&Hr(t,function(o,s){if(Ts(o))i||(i=new xr),function(e,t,n,r,i,o,s){var l=eo(e,n),u=eo(t,n),c=s.get(u);if(c)Tr(e,n,c);else{var h=o?o(l,u,n+"",e,t,s):a,f=h===a;if(f){var d=vs(u),p=!d&&As(u),m=!d&&!p&&Os(u);h=u,d||p||m?vs(l)?h=l:ys(l)?h=ta(l):p?(f=!1,h=Ki(u,!0)):m?(f=!1,h=Zi(u,!0)):h=[]:Is(u)||ms(u)?(h=l,ms(l)?h=Gs(l):Ts(l)&&!ws(l)||(h=ja(u))):f=!1}f&&(s.set(u,h),i(h,u,r,o,s),s.delete(u)),Tr(e,n,h)}}(e,t,s,n,pi,r,i);else{var l=r?r(eo(e,s),o,s+"",e,t,i):a;l===a&&(l=o),Tr(e,s,l)}},il)}function mi(e,t){var n=e.length;if(n)return Ha(t+=t<0?n:0,n)?e[t]:a}function vi(e,t,n){var r=-1;return t=$t(t.length?t:[Pl],gn(Ra())),function(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}(hi(e,function(e,n,i){return{criteria:$t(t,function(t){return t(e)}),index:++r,value:e}}),function(e,t){return function(e,t,n){for(var r=-1,i=e.criteria,a=t.criteria,o=i.length,s=n.length;++r<o;){var l=Ji(i[r],a[r]);if(l){if(r>=s)return l;var u=n[r];return l*("desc"==u?-1:1)}}return e.index-t.index}(e,t,n)})}function gi(e,t,n){for(var r=-1,i=t.length,a={};++r<i;){var o=t[r],s=Kr(e,o);n(s,o)&&Fi(a,zi(o,e),s)}return a}function _i(e,t,n,r){var i=r?un:ln,a=-1,o=t.length,s=e;for(e===t&&(t=ta(t)),n&&(s=$t(e,gn(n)));++a<o;)for(var l=0,u=t[a],c=n?n(u):u;(l=i(s,c,l,r))>-1;)s!==e&&Rt.call(s,l,1),Rt.call(e,l,1);return e}function yi(e,t){for(var n=e?t.length:0,r=n-1;n--;){var i=t[n];if(n==r||i!==a){var a=i;Ha(i)?Rt.call(e,i,1):ki(e,i)}}return e}function Ai(e,t){return e+Dn(Wn()*(t-e+1))}function xi(e,t){var n="";if(!e||t<1||t>R)return n;do{t%2&&(n+=e),(t=Dn(t/2))&&(e+=e)}while(t);return n}function bi(e,t){return ro(Ja(e,t,Pl),e+"")}function wi(e){return wr(fl(e))}function Si(e,t){var n=fl(e);return oo(n,Nr(t,0,n.length))}function Fi(e,t,n,r){if(!Ts(e))return e;for(var i=-1,o=(t=zi(t,e)).length,s=o-1,l=e;null!=l&&++i<o;){var u=lo(t[i]),c=n;if(i!=s){var h=l[u];(c=r?r(h,u,l):a)===a&&(c=Ts(h)?h:Ha(t[i+1])?[]:{})}Er(l,u,c),l=l[u]}return e}var Ti=nr?function(e,t){return nr.set(e,t),e}:Pl,Ei=an?function(e,t){return an(e,"toString",{configurable:!0,enumerable:!1,value:Tl(t),writable:!0})}:Pl;function Li(e){return oo(fl(e))}function Pi(e,t,r){var i=-1,a=e.length;t<0&&(t=-t>a?0:a+t),(r=r>a?a:r)<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var o=n(a);++i<a;)o[i]=e[i+t];return o}function Ii(e,t){var n;return Dr(e,function(e,r,i){return!(n=t(e,r,i))}),!!n}function Mi(e,t,n){var r=0,i=null==e?r:e.length;if("number"==typeof t&&t==t&&i<=B){for(;r<i;){var a=r+i>>>1,o=e[a];null!==o&&!Rs(o)&&(n?o<=t:o<t)?r=a+1:i=a}return i}return Ci(e,t,Pl,n)}function Ci(e,t,n,r){t=n(t);for(var i=0,o=null==e?0:e.length,s=t!=t,l=null===t,u=Rs(t),c=t===a;i<o;){var h=Dn((i+o)/2),f=n(e[h]),d=f!==a,p=null===f,m=f==f,v=Rs(f);if(s)var g=r||m;else g=c?m&&(r||d):l?m&&d&&(r||!p):u?m&&d&&!p&&(r||!v):!p&&!v&&(r?f<=t:f<t);g?i=h+1:o=h}return zn(o,D)}function Ni(e,t){for(var n=-1,r=e.length,i=0,a=[];++n<r;){var o=e[n],s=t?t(o):o;if(!n||!fs(s,l)){var l=s;a[i++]=0===o?0:o}}return a}function Ri(e){return"number"==typeof e?e:Rs(e)?U:+e}function Oi(e){if("string"==typeof e)return e;if(vs(e))return $t(e,Oi)+"";if(Rs(e))return hr?hr.call(e):"";var t=e+"";return"0"==t&&1/e==-N?"-0":t}function Ui(e,t,n){var r=-1,i=Zt,a=e.length,s=!0,l=[],u=l;if(n)s=!1,i=Jt;else if(a>=o){var c=t?null:xa(e);if(c)return Pn(c);s=!1,i=yn,u=new Ar}else u=t?[]:l;e:for(;++r<a;){var h=e[r],f=t?t(h):h;if(h=n||0!==h?h:0,s&&f==f){for(var d=u.length;d--;)if(u[d]===f)continue e;t&&u.push(f),l.push(h)}else i(u,f,n)||(u!==l&&u.push(f),l.push(h))}return l}function ki(e,t){return null==(e=$a(e,t=zi(t,e)))||delete e[lo(bo(t))]}function Di(e,t,n,r){return Fi(e,t,n(Kr(e,t)),r)}function Bi(e,t,n,r){for(var i=e.length,a=r?i:-1;(r?a--:++a<i)&&t(e[a],a,e););return n?Pi(e,r?0:a,r?a+1:i):Pi(e,r?a+1:0,r?i:a)}function Xi(e,t){var n=e;return n instanceof vr&&(n=n.value()),tn(t,function(e,t){return t.func.apply(t.thisArg,en([e],t.args))},n)}function Vi(e,t,r){var i=e.length;if(i<2)return i?Ui(e[0]):[];for(var a=-1,o=n(i);++a<i;)for(var s=e[a],l=-1;++l<i;)l!=a&&(o[a]=kr(o[a]||s,e[l],t,r));return Ui(Gr(o,1),t,r)}function ji(e,t,n){for(var r=-1,i=e.length,o=t.length,s={};++r<i;){var l=r<o?t[r]:a;n(s,e[r],l)}return s}function Gi(e){return ys(e)?e:[]}function Hi(e){return"function"==typeof e?e:Pl}function zi(e,t){return vs(e)?e:Ya(e,t)?[e]:so(Hs(e))}var Yi=bi;function Qi(e,t,n){var r=e.length;return n=n===a?r:n,!t&&n>=r?e:Pi(e,t,n)}var Wi=dn||function(e){return Nt.clearTimeout(e)};function Ki(e,t){if(t)return e.slice();var n=e.length,r=bt?bt(n):new e.constructor(n);return e.copy(r),r}function qi(e){var t=new e.constructor(e.byteLength);return new At(t).set(new At(e)),t}function Zi(e,t){var n=t?qi(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function Ji(e,t){if(e!==t){var n=e!==a,r=null===e,i=e==e,o=Rs(e),s=t!==a,l=null===t,u=t==t,c=Rs(t);if(!l&&!c&&!o&&e>t||o&&s&&u&&!l&&!c||r&&s&&u||!n&&u||!i)return 1;if(!r&&!o&&!c&&e<t||c&&n&&i&&!r&&!o||l&&n&&i||!s&&i||!u)return-1}return 0}function $i(e,t,r,i){for(var a=-1,o=e.length,s=r.length,l=-1,u=t.length,c=Hn(o-s,0),h=n(u+c),f=!i;++l<u;)h[l]=t[l];for(;++a<s;)(f||a<o)&&(h[r[a]]=e[a]);for(;c--;)h[l++]=e[a++];return h}function ea(e,t,r,i){for(var a=-1,o=e.length,s=-1,l=r.length,u=-1,c=t.length,h=Hn(o-l,0),f=n(h+c),d=!i;++a<h;)f[a]=e[a];for(var p=a;++u<c;)f[p+u]=t[u];for(;++s<l;)(d||a<o)&&(f[p+r[s]]=e[a++]);return f}function ta(e,t){var r=-1,i=e.length;for(t||(t=n(i));++r<i;)t[r]=e[r];return t}function na(e,t,n,r){var i=!n;n||(n={});for(var o=-1,s=t.length;++o<s;){var l=t[o],u=r?r(n[l],e[l],l,n,e):a;u===a&&(u=e[l]),i?Mr(n,l,u):Er(n,l,u)}return n}function ra(e,t){return function(n,r){var i=vs(n)?Yt:Pr,a=t?t():{};return i(n,e,Ra(r,2),a)}}function ia(e){return bi(function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:a,s=i>2?n[2]:a;for(o=e.length>3&&"function"==typeof o?(i--,o):a,s&&za(n[0],n[1],s)&&(o=i<3?a:o,i=1),t=et(t);++r<i;){var l=n[r];l&&e(t,l,r,o)}return t})}function aa(e,t){return function(n,r){if(null==n)return n;if(!_s(n))return e(n,r);for(var i=n.length,a=t?i:-1,o=et(n);(t?a--:++a<i)&&!1!==r(o[a],a,o););return n}}function oa(e){return function(t,n,r){for(var i=-1,a=et(t),o=r(t),s=o.length;s--;){var l=o[e?s:++i];if(!1===n(a[l],l,a))break}return t}}function sa(e){return function(t){var n=Fn(t=Hs(t))?Cn(t):a,r=n?n[0]:t.charAt(0),i=n?Qi(n,1).join(""):t.slice(1);return r[e]()+i}}function la(e){return function(t){return tn(wl(ml(t).replace(_t,"")),e,"")}}function ua(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=dr(e.prototype),r=e.apply(n,t);return Ts(r)?r:n}}function ca(e){return function(t,n,r){var i=et(t);if(!_s(t)){var o=Ra(n,3);t=rl(t),n=function(e){return o(i[e],e,i)}}var s=e(t,n,r);return s>-1?i[o?t[s]:s]:a}}function ha(e){return La(function(t){var n=t.length,r=n,i=mr.prototype.thru;for(e&&t.reverse();r--;){var o=t[r];if("function"!=typeof o)throw new rt(l);if(i&&!s&&"wrapper"==Ca(o))var s=new mr([],!0)}for(r=s?r:n;++r<n;){var u=Ca(o=t[r]),c="wrapper"==u?Ma(o):a;s=c&&Qa(c[0])&&c[1]==(S|A|b|F)&&!c[4].length&&1==c[9]?s[Ca(c[0])].apply(s,c[3]):1==o.length&&Qa(o)?s[u]():s.thru(o)}return function(){var e=arguments,r=e[0];if(s&&1==e.length&&vs(r))return s.plant(r).value();for(var i=0,a=n?t[i].apply(this,e):r;++i<n;)a=t[i].call(this,a);return a}})}function fa(e,t,r,i,o,s,l,u,c,h){var f=t&S,d=t&g,p=t&_,m=t&(A|x),v=t&T,y=p?a:ua(e);return function g(){for(var _=arguments.length,A=n(_),x=_;x--;)A[x]=arguments[x];if(m)var b=Na(g),w=function(e,t){for(var n=e.length,r=0;n--;)e[n]===t&&++r;return r}(A,b);if(i&&(A=$i(A,i,o,m)),s&&(A=ea(A,s,l,m)),_-=w,m&&_<h){var S=Ln(A,b);return ya(e,t,fa,g.placeholder,r,A,S,u,c,h-_)}var F=d?r:this,T=p?F[e]:e;return _=A.length,u?A=function(e,t){for(var n=e.length,r=zn(t.length,n),i=ta(e);r--;){var o=t[r];e[r]=Ha(o,n)?i[o]:a}return e}(A,u):v&&_>1&&A.reverse(),f&&c<_&&(A.length=c),this&&this!==Nt&&this instanceof g&&(T=y||ua(T)),T.apply(F,A)}}function da(e,t){return function(n,r){return function(e,t,n,r){return Yr(e,function(e,i,a){t(r,n(e),i,a)}),r}(n,e,t(r),{})}}function pa(e,t){return function(n,r){var i;if(n===a&&r===a)return t;if(n!==a&&(i=n),r!==a){if(i===a)return r;"string"==typeof n||"string"==typeof r?(n=Oi(n),r=Oi(r)):(n=Ri(n),r=Ri(r)),i=e(n,r)}return i}}function ma(e){return La(function(t){return t=$t(t,gn(Ra())),bi(function(n){var r=this;return e(t,function(e){return zt(e,r,n)})})})}function va(e,t){var n=(t=t===a?" ":Oi(t)).length;if(n<2)return n?xi(t,e):t;var r=xi(t,kn(e/Mn(t)));return Fn(t)?Qi(Cn(r),0,e).join(""):r.slice(0,e)}function ga(e){return function(t,r,i){return i&&"number"!=typeof i&&za(t,r,i)&&(r=i=a),t=Bs(t),r===a?(r=t,t=0):r=Bs(r),function(e,t,r,i){for(var a=-1,o=Hn(kn((t-e)/(r||1)),0),s=n(o);o--;)s[i?o:++a]=e,e+=r;return s}(t,r,i=i===a?t<r?1:-1:Bs(i),e)}}function _a(e){return function(t,n){return"string"==typeof t&&"string"==typeof n||(t=js(t),n=js(n)),e(t,n)}}function ya(e,t,n,r,i,o,s,l,u,c){var h=t&A;t|=h?b:w,(t&=~(h?w:b))&y||(t&=~(g|_));var f=[e,t,i,h?o:a,h?s:a,h?a:o,h?a:s,l,u,c],d=n.apply(a,f);return Qa(e)&&to(d,f),d.placeholder=r,io(d,e,t)}function Aa(e){var t=$e[e];return function(e,n){if(e=js(e),n=null==n?0:zn(Xs(n),292)){var r=(Hs(e)+"e").split("e");return+((r=(Hs(t(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return t(e)}}var xa=$n&&1/Pn(new $n([,-0]))[1]==N?function(e){return new $n(e)}:Rl;function ba(e){return function(t){var n=Xa(t);return n==q?Tn(t):n==ne?In(t):function(e,t){return $t(t,function(t){return[t,e[t]]})}(t,e(t))}}function wa(e,t,r,i,o,s,u,c){var f=t&_;if(!f&&"function"!=typeof e)throw new rt(l);var d=i?i.length:0;if(d||(t&=~(b|w),i=o=a),u=u===a?u:Hn(Xs(u),0),c=c===a?c:Xs(c),d-=o?o.length:0,t&w){var p=i,m=o;i=o=a}var v=f?a:Ma(e),T=[e,t,r,i,o,p,m,s,u,c];if(v&&function(e,t){var n=e[1],r=t[1],i=n|r,a=i<(g|_|S),o=r==S&&n==A||r==S&&n==F&&e[7].length<=t[8]||r==(S|F)&&t[7].length<=t[8]&&n==A;if(!a&&!o)return e;r&g&&(e[2]=t[2],i|=n&g?0:y);var s=t[3];if(s){var l=e[3];e[3]=l?$i(l,s,t[4]):s,e[4]=l?Ln(e[3],h):t[4]}(s=t[5])&&(l=e[5],e[5]=l?ea(l,s,t[6]):s,e[6]=l?Ln(e[5],h):t[6]),(s=t[7])&&(e[7]=s),r&S&&(e[8]=null==e[8]?t[8]:zn(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=i}(T,v),e=T[0],t=T[1],r=T[2],i=T[3],o=T[4],!(c=T[9]=T[9]===a?f?0:e.length:Hn(T[9]-d,0))&&t&(A|x)&&(t&=~(A|x)),t&&t!=g)E=t==A||t==x?function(e,t,r){var i=ua(e);return function o(){for(var s=arguments.length,l=n(s),u=s,c=Na(o);u--;)l[u]=arguments[u];var h=s<3&&l[0]!==c&&l[s-1]!==c?[]:Ln(l,c);return(s-=h.length)<r?ya(e,t,fa,o.placeholder,a,l,h,a,a,r-s):zt(this&&this!==Nt&&this instanceof o?i:e,this,l)}}(e,t,c):t!=b&&t!=(g|b)||o.length?fa.apply(a,T):function(e,t,r,i){var a=t&g,o=ua(e);return function t(){for(var s=-1,l=arguments.length,u=-1,c=i.length,h=n(c+l),f=this&&this!==Nt&&this instanceof t?o:e;++u<c;)h[u]=i[u];for(;l--;)h[u++]=arguments[++s];return zt(f,a?r:this,h)}}(e,t,r,i);else var E=function(e,t,n){var r=t&g,i=ua(e);return function t(){return(this&&this!==Nt&&this instanceof t?i:e).apply(r?n:this,arguments)}}(e,t,r);return io((v?Ti:to)(E,T),e,t)}function Sa(e,t,n,r){return e===a||fs(e,ot[n])&&!ut.call(r,n)?t:e}function Fa(e,t,n,r,i,o){return Ts(e)&&Ts(t)&&(o.set(t,e),pi(e,t,a,Fa,o),o.delete(t)),e}function Ta(e){return Is(e)?a:e}function Ea(e,t,n,r,i,o){var s=n&m,l=e.length,u=t.length;if(l!=u&&!(s&&u>l))return!1;var c=o.get(e);if(c&&o.get(t))return c==t;var h=-1,f=!0,d=n&v?new Ar:a;for(o.set(e,t),o.set(t,e);++h<l;){var p=e[h],g=t[h];if(r)var _=s?r(g,p,h,t,e,o):r(p,g,h,e,t,o);if(_!==a){if(_)continue;f=!1;break}if(d){if(!rn(t,function(e,t){if(!yn(d,t)&&(p===e||i(p,e,n,r,o)))return d.push(t)})){f=!1;break}}else if(p!==g&&!i(p,g,n,r,o)){f=!1;break}}return o.delete(e),o.delete(t),f}function La(e){return ro(Ja(e,a,go),e+"")}function Pa(e){return qr(e,rl,Da)}function Ia(e){return qr(e,il,Ba)}var Ma=nr?function(e){return nr.get(e)}:Rl;function Ca(e){for(var t=e.name+"",n=rr[t],r=ut.call(rr,t)?n.length:0;r--;){var i=n[r],a=i.func;if(null==a||a==e)return i.name}return t}function Na(e){return(ut.call(fr,"placeholder")?fr:e).placeholder}function Ra(){var e=fr.iteratee||Il;return e=e===Il?si:e,arguments.length?e(arguments[0],arguments[1]):e}function Oa(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function Ua(e){for(var t=rl(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,qa(i)]}return t}function ka(e,t){var n=function(e,t){return null==e?a:e[t]}(e,t);return oi(n)?n:a}var Da=Bn?function(e){return null==e?[]:(e=et(e),qt(Bn(e),function(t){return Ct.call(e,t)}))}:Vl,Ba=Bn?function(e){for(var t=[];e;)en(t,Da(e)),e=Lt(e);return t}:Vl,Xa=Zr;function Va(e,t,n){for(var r=-1,i=(t=zi(t,e)).length,a=!1;++r<i;){var o=lo(t[r]);if(!(a=null!=e&&n(e,o)))break;e=e[o]}return a||++r!=i?a:!!(i=null==e?0:e.length)&&Fs(i)&&Ha(o,i)&&(vs(e)||ms(e))}function ja(e){return"function"!=typeof e.constructor||Ka(e)?{}:dr(Lt(e))}function Ga(e){return vs(e)||ms(e)||!!(Ot&&e&&e[Ot])}function Ha(e,t){var n=typeof e;return!!(t=null==t?R:t)&&("number"==n||"symbol"!=n&&We.test(e))&&e>-1&&e%1==0&&e<t}function za(e,t,n){if(!Ts(n))return!1;var r=typeof t;return!!("number"==r?_s(n)&&Ha(t,n.length):"string"==r&&t in n)&&fs(n[t],e)}function Ya(e,t){if(vs(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!Rs(e))||Ie.test(e)||!Pe.test(e)||null!=t&&e in et(t)}function Qa(e){var t=Ca(e),n=fr[t];if("function"!=typeof n||!(t in vr.prototype))return!1;if(e===n)return!0;var r=Ma(n);return!!r&&e===r[0]}(qn&&Xa(new qn(new ArrayBuffer(1)))!=ue||Zn&&Xa(new Zn)!=q||Jn&&"[object Promise]"!=Xa(Jn.resolve())||$n&&Xa(new $n)!=ne||er&&Xa(new er)!=oe)&&(Xa=function(e){var t=Zr(e),n=t==$?e.constructor:a,r=n?uo(n):"";if(r)switch(r){case ir:return ue;case ar:return q;case or:return"[object Promise]";case sr:return ne;case lr:return oe}return t});var Wa=st?ws:jl;function Ka(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||ot)}function qa(e){return e==e&&!Ts(e)}function Za(e,t){return function(n){return null!=n&&n[e]===t&&(t!==a||e in et(n))}}function Ja(e,t,r){return t=Hn(t===a?e.length-1:t,0),function(){for(var i=arguments,a=-1,o=Hn(i.length-t,0),s=n(o);++a<o;)s[a]=i[t+a];a=-1;for(var l=n(t+1);++a<t;)l[a]=i[a];return l[t]=r(s),zt(e,this,l)}}function $a(e,t){return t.length<2?e:Kr(e,Pi(t,0,-1))}function eo(e,t){if("__proto__"!=t)return e[t]}var to=ao(Ti),no=Un||function(e,t){return Nt.setTimeout(e,t)},ro=ao(Ei);function io(e,t,n){var r=t+"";return ro(e,function(e,t){var n=t.length;if(!n)return e;var r=n-1;return t[r]=(n>1?"& ":"")+t[r],t=t.join(n>2?", ":" "),e.replace(ke,"{\n/* [wrapped with "+t+"] */\n")}(r,function(e,t){return Qt(X,function(n){var r="_."+n[0];t&n[1]&&!Zt(e,r)&&e.push(r)}),e.sort()}(function(e){var t=e.match(De);return t?t[1].split(Be):[]}(r),n)))}function ao(e){var t=0,n=0;return function(){var r=Yn(),i=I-(r-n);if(n=r,i>0){if(++t>=P)return arguments[0]}else t=0;return e.apply(a,arguments)}}function oo(e,t){var n=-1,r=e.length,i=r-1;for(t=t===a?r:t;++n<t;){var o=Ai(n,i),s=e[o];e[o]=e[n],e[n]=s}return e.length=t,e}var so=function(e){var t=os(e,function(e){return n.size===c&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Me,function(e,n,r,i){t.push(r?i.replace(Ve,"$1"):n||e)}),t});function lo(e){if("string"==typeof e||Rs(e))return e;var t=e+"";return"0"==t&&1/e==-N?"-0":t}function uo(e){if(null!=e){try{return lt.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function co(e){if(e instanceof vr)return e.clone();var t=new mr(e.__wrapped__,e.__chain__);return t.__actions__=ta(e.__actions__),t.__index__=e.__index__,t.__values__=e.__values__,t}var ho=bi(function(e,t){return ys(e)?kr(e,Gr(t,1,ys,!0)):[]}),fo=bi(function(e,t){var n=bo(t);return ys(n)&&(n=a),ys(e)?kr(e,Gr(t,1,ys,!0),Ra(n,2)):[]}),po=bi(function(e,t){var n=bo(t);return ys(n)&&(n=a),ys(e)?kr(e,Gr(t,1,ys,!0),a,n):[]});function mo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:Xs(n);return i<0&&(i=Hn(r+i,0)),sn(e,Ra(t,3),i)}function vo(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r-1;return n!==a&&(i=Xs(n),i=n<0?Hn(r+i,0):zn(i,r-1)),sn(e,Ra(t,3),i,!0)}function go(e){return null!=e&&e.length?Gr(e,1):[]}function _o(e){return e&&e.length?e[0]:a}var yo=bi(function(e){var t=$t(e,Gi);return t.length&&t[0]===e[0]?ti(t):[]}),Ao=bi(function(e){var t=bo(e),n=$t(e,Gi);return t===bo(n)?t=a:n.pop(),n.length&&n[0]===e[0]?ti(n,Ra(t,2)):[]}),xo=bi(function(e){var t=bo(e),n=$t(e,Gi);return(t="function"==typeof t?t:a)&&n.pop(),n.length&&n[0]===e[0]?ti(n,a,t):[]});function bo(e){var t=null==e?0:e.length;return t?e[t-1]:a}var wo=bi(So);function So(e,t){return e&&e.length&&t&&t.length?_i(e,t):e}var Fo=La(function(e,t){var n=null==e?0:e.length,r=Cr(e,t);return yi(e,$t(t,function(e){return Ha(e,n)?+e:e}).sort(Ji)),r});function To(e){return null==e?e:Kn.call(e)}var Eo=bi(function(e){return Ui(Gr(e,1,ys,!0))}),Lo=bi(function(e){var t=bo(e);return ys(t)&&(t=a),Ui(Gr(e,1,ys,!0),Ra(t,2))}),Po=bi(function(e){var t=bo(e);return t="function"==typeof t?t:a,Ui(Gr(e,1,ys,!0),a,t)});function Io(e){if(!e||!e.length)return[];var t=0;return e=qt(e,function(e){if(ys(e))return t=Hn(e.length,t),!0}),vn(t,function(t){return $t(e,fn(t))})}function Mo(e,t){if(!e||!e.length)return[];var n=Io(e);return null==t?n:$t(n,function(e){return zt(t,a,e)})}var Co=bi(function(e,t){return ys(e)?kr(e,t):[]}),No=bi(function(e){return Vi(qt(e,ys))}),Ro=bi(function(e){var t=bo(e);return ys(t)&&(t=a),Vi(qt(e,ys),Ra(t,2))}),Oo=bi(function(e){var t=bo(e);return t="function"==typeof t?t:a,Vi(qt(e,ys),a,t)}),Uo=bi(Io);var ko=bi(function(e){var t=e.length,n=t>1?e[t-1]:a;return Mo(e,n="function"==typeof n?(e.pop(),n):a)});function Do(e){var t=fr(e);return t.__chain__=!0,t}function Bo(e,t){return t(e)}var Xo=La(function(e){var t=e.length,n=t?e[0]:0,r=this.__wrapped__,i=function(t){return Cr(t,e)};return!(t>1||this.__actions__.length)&&r instanceof vr&&Ha(n)?((r=r.slice(n,+n+(t?1:0))).__actions__.push({func:Bo,args:[i],thisArg:a}),new mr(r,this.__chain__).thru(function(e){return t&&!e.length&&e.push(a),e})):this.thru(i)});var Vo=ra(function(e,t,n){ut.call(e,n)?++e[n]:Mr(e,n,1)});var jo=ca(mo),Go=ca(vo);function Ho(e,t){return(vs(e)?Qt:Dr)(e,Ra(t,3))}function zo(e,t){return(vs(e)?Wt:Br)(e,Ra(t,3))}var Yo=ra(function(e,t,n){ut.call(e,n)?e[n].push(t):Mr(e,n,[t])});var Qo=bi(function(e,t,r){var i=-1,a="function"==typeof t,o=_s(e)?n(e.length):[];return Dr(e,function(e){o[++i]=a?zt(t,e,r):ni(e,t,r)}),o}),Wo=ra(function(e,t,n){Mr(e,n,t)});function Ko(e,t){return(vs(e)?$t:hi)(e,Ra(t,3))}var qo=ra(function(e,t,n){e[n?0:1].push(t)},function(){return[[],[]]});var Zo=bi(function(e,t){if(null==e)return[];var n=t.length;return n>1&&za(e,t[0],t[1])?t=[]:n>2&&za(t[0],t[1],t[2])&&(t=[t[0]]),vi(e,Gr(t,1),[])}),Jo=On||function(){return Nt.Date.now()};function $o(e,t,n){return t=n?a:t,t=e&&null==t?e.length:t,wa(e,S,a,a,a,a,t)}function es(e,t){var n;if("function"!=typeof t)throw new rt(l);return e=Xs(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=a),n}}var ts=bi(function(e,t,n){var r=g;if(n.length){var i=Ln(n,Na(ts));r|=b}return wa(e,r,t,n,i)}),ns=bi(function(e,t,n){var r=g|_;if(n.length){var i=Ln(n,Na(ns));r|=b}return wa(t,r,e,n,i)});function rs(e,t,n){var r,i,o,s,u,c,h=0,f=!1,d=!1,p=!0;if("function"!=typeof e)throw new rt(l);function m(t){var n=r,o=i;return r=i=a,h=t,s=e.apply(o,n)}function v(e){var n=e-c;return c===a||n>=t||n<0||d&&e-h>=o}function g(){var e=Jo();if(v(e))return _(e);u=no(g,function(e){var n=t-(e-c);return d?zn(n,o-(e-h)):n}(e))}function _(e){return u=a,p&&r?m(e):(r=i=a,s)}function y(){var e=Jo(),n=v(e);if(r=arguments,i=this,c=e,n){if(u===a)return function(e){return h=e,u=no(g,t),f?m(e):s}(c);if(d)return u=no(g,t),m(c)}return u===a&&(u=no(g,t)),s}return t=js(t)||0,Ts(n)&&(f=!!n.leading,o=(d="maxWait"in n)?Hn(js(n.maxWait)||0,t):o,p="trailing"in n?!!n.trailing:p),y.cancel=function(){u!==a&&Wi(u),h=0,r=c=i=u=a},y.flush=function(){return u===a?s:_(Jo())},y}var is=bi(function(e,t){return Ur(e,1,t)}),as=bi(function(e,t,n){return Ur(e,js(t)||0,n)});function os(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new rt(l);var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],a=n.cache;if(a.has(i))return a.get(i);var o=e.apply(this,r);return n.cache=a.set(i,o)||a,o};return n.cache=new(os.Cache||yr),n}function ss(e){if("function"!=typeof e)throw new rt(l);return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}os.Cache=yr;var ls=Yi(function(e,t){var n=(t=1==t.length&&vs(t[0])?$t(t[0],gn(Ra())):$t(Gr(t,1),gn(Ra()))).length;return bi(function(r){for(var i=-1,a=zn(r.length,n);++i<a;)r[i]=t[i].call(this,r[i]);return zt(e,this,r)})}),us=bi(function(e,t){var n=Ln(t,Na(us));return wa(e,b,a,t,n)}),cs=bi(function(e,t){var n=Ln(t,Na(cs));return wa(e,w,a,t,n)}),hs=La(function(e,t){return wa(e,F,a,a,a,t)});function fs(e,t){return e===t||e!=e&&t!=t}var ds=_a(Jr),ps=_a(function(e,t){return e>=t}),ms=ri(function(){return arguments}())?ri:function(e){return Es(e)&&ut.call(e,"callee")&&!Ct.call(e,"callee")},vs=n.isArray,gs=Bt?gn(Bt):function(e){return Es(e)&&Zr(e)==le};function _s(e){return null!=e&&Fs(e.length)&&!ws(e)}function ys(e){return Es(e)&&_s(e)}var As=Xn||jl,xs=Xt?gn(Xt):function(e){return Es(e)&&Zr(e)==z};function bs(e){if(!Es(e))return!1;var t=Zr(e);return t==Q||t==Y||"string"==typeof e.message&&"string"==typeof e.name&&!Is(e)}function ws(e){if(!Ts(e))return!1;var t=Zr(e);return t==W||t==K||t==G||t==ee}function Ss(e){return"number"==typeof e&&e==Xs(e)}function Fs(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=R}function Ts(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function Es(e){return null!=e&&"object"==typeof e}var Ls=Vt?gn(Vt):function(e){return Es(e)&&Xa(e)==q};function Ps(e){return"number"==typeof e||Es(e)&&Zr(e)==Z}function Is(e){if(!Es(e)||Zr(e)!=$)return!1;var t=Lt(e);if(null===t)return!0;var n=ut.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&lt.call(n)==dt}var Ms=jt?gn(jt):function(e){return Es(e)&&Zr(e)==te};var Cs=Gt?gn(Gt):function(e){return Es(e)&&Xa(e)==ne};function Ns(e){return"string"==typeof e||!vs(e)&&Es(e)&&Zr(e)==re}function Rs(e){return"symbol"==typeof e||Es(e)&&Zr(e)==ie}var Os=Ht?gn(Ht):function(e){return Es(e)&&Fs(e.length)&&!!Tt[Zr(e)]};var Us=_a(ci),ks=_a(function(e,t){return e<=t});function Ds(e){if(!e)return[];if(_s(e))return Ns(e)?Cn(e):ta(e);if(kt&&e[kt])return function(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}(e[kt]());var t=Xa(e);return(t==q?Tn:t==ne?Pn:fl)(e)}function Bs(e){return e?(e=js(e))===N||e===-N?(e<0?-1:1)*O:e==e?e:0:0===e?e:0}function Xs(e){var t=Bs(e),n=t%1;return t==t?n?t-n:t:0}function Vs(e){return e?Nr(Xs(e),0,k):0}function js(e){if("number"==typeof e)return e;if(Rs(e))return U;if(Ts(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=Ts(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(Re,"");var n=ze.test(e);return n||Qe.test(e)?It(e.slice(2),n?2:8):He.test(e)?U:+e}function Gs(e){return na(e,il(e))}function Hs(e){return null==e?"":Oi(e)}var zs=ia(function(e,t){if(Ka(t)||_s(t))na(t,rl(t),e);else for(var n in t)ut.call(t,n)&&Er(e,n,t[n])}),Ys=ia(function(e,t){na(t,il(t),e)}),Qs=ia(function(e,t,n,r){na(t,il(t),e,r)}),Ws=ia(function(e,t,n,r){na(t,rl(t),e,r)}),Ks=La(Cr);var qs=bi(function(e,t){e=et(e);var n=-1,r=t.length,i=r>2?t[2]:a;for(i&&za(t[0],t[1],i)&&(r=1);++n<r;)for(var o=t[n],s=il(o),l=-1,u=s.length;++l<u;){var c=s[l],h=e[c];(h===a||fs(h,ot[c])&&!ut.call(e,c))&&(e[c]=o[c])}return e}),Zs=bi(function(e){return e.push(a,Fa),zt(ol,a,e)});function Js(e,t,n){var r=null==e?a:Kr(e,t);return r===a?n:r}function $s(e,t){return null!=e&&Va(e,t,ei)}var el=da(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=ft.call(t)),e[t]=n},Tl(Pl)),tl=da(function(e,t,n){null!=t&&"function"!=typeof t.toString&&(t=ft.call(t)),ut.call(e,t)?e[t].push(n):e[t]=[n]},Ra),nl=bi(ni);function rl(e){return _s(e)?br(e):li(e)}function il(e){return _s(e)?br(e,!0):ui(e)}var al=ia(function(e,t,n){pi(e,t,n)}),ol=ia(function(e,t,n,r){pi(e,t,n,r)}),sl=La(function(e,t){var n={};if(null==e)return n;var r=!1;t=$t(t,function(t){return t=zi(t,e),r||(r=t.length>1),t}),na(e,Ia(e),n),r&&(n=Rr(n,f|d|p,Ta));for(var i=t.length;i--;)ki(n,t[i]);return n});var ll=La(function(e,t){return null==e?{}:function(e,t){return gi(e,t,function(t,n){return $s(e,n)})}(e,t)});function ul(e,t){if(null==e)return{};var n=$t(Ia(e),function(e){return[e]});return t=Ra(t),gi(e,n,function(e,n){return t(e,n[0])})}var cl=ba(rl),hl=ba(il);function fl(e){return null==e?[]:_n(e,rl(e))}var dl=la(function(e,t,n){return t=t.toLowerCase(),e+(n?pl(t):t)});function pl(e){return bl(Hs(e).toLowerCase())}function ml(e){return(e=Hs(e))&&e.replace(Ke,bn).replace(yt,"")}var vl=la(function(e,t,n){return e+(n?"-":"")+t.toLowerCase()}),gl=la(function(e,t,n){return e+(n?" ":"")+t.toLowerCase()}),_l=sa("toLowerCase");var yl=la(function(e,t,n){return e+(n?"_":"")+t.toLowerCase()});var Al=la(function(e,t,n){return e+(n?" ":"")+bl(t)});var xl=la(function(e,t,n){return e+(n?" ":"")+t.toUpperCase()}),bl=sa("toUpperCase");function wl(e,t,n){return e=Hs(e),(t=n?a:t)===a?function(e){return wt.test(e)}(e)?function(e){return e.match(xt)||[]}(e):function(e){return e.match(Xe)||[]}(e):e.match(t)||[]}var Sl=bi(function(e,t){try{return zt(e,a,t)}catch(e){return bs(e)?e:new i(e)}}),Fl=La(function(e,t){return Qt(t,function(t){t=lo(t),Mr(e,t,ts(e[t],e))}),e});function Tl(e){return function(){return e}}var El=ha(),Ll=ha(!0);function Pl(e){return e}function Il(e){return si("function"==typeof e?e:Rr(e,f))}var Ml=bi(function(e,t){return function(n){return ni(n,e,t)}}),Cl=bi(function(e,t){return function(n){return ni(e,n,t)}});function Nl(e,t,n){var r=rl(t),i=Wr(t,r);null!=n||Ts(t)&&(i.length||!r.length)||(n=t,t=e,e=this,i=Wr(t,rl(t)));var a=!(Ts(n)&&"chain"in n&&!n.chain),o=ws(e);return Qt(i,function(n){var r=t[n];e[n]=r,o&&(e.prototype[n]=function(){var t=this.__chain__;if(a||t){var n=e(this.__wrapped__);return(n.__actions__=ta(this.__actions__)).push({func:r,args:arguments,thisArg:e}),n.__chain__=t,n}return r.apply(e,en([this.value()],arguments))})}),e}function Rl(){}var Ol=ma($t),Ul=ma(Kt),kl=ma(rn);function Dl(e){return Ya(e)?fn(lo(e)):function(e){return function(t){return Kr(t,e)}}(e)}var Bl=ga(),Xl=ga(!0);function Vl(){return[]}function jl(){return!1}var Gl=pa(function(e,t){return e+t},0),Hl=Aa("ceil"),zl=pa(function(e,t){return e/t},1),Yl=Aa("floor");var Ql=pa(function(e,t){return e*t},1),Wl=Aa("round"),Kl=pa(function(e,t){return e-t},0);return fr.after=function(e,t){if("function"!=typeof t)throw new rt(l);return e=Xs(e),function(){if(--e<1)return t.apply(this,arguments)}},fr.ary=$o,fr.assign=zs,fr.assignIn=Ys,fr.assignInWith=Qs,fr.assignWith=Ws,fr.at=Ks,fr.before=es,fr.bind=ts,fr.bindAll=Fl,fr.bindKey=ns,fr.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return vs(e)?e:[e]},fr.chain=Do,fr.chunk=function(e,t,r){t=(r?za(e,t,r):t===a)?1:Hn(Xs(t),0);var i=null==e?0:e.length;if(!i||t<1)return[];for(var o=0,s=0,l=n(kn(i/t));o<i;)l[s++]=Pi(e,o,o+=t);return l},fr.compact=function(e){for(var t=-1,n=null==e?0:e.length,r=0,i=[];++t<n;){var a=e[t];a&&(i[r++]=a)}return i},fr.concat=function(){var e=arguments.length;if(!e)return[];for(var t=n(e-1),r=arguments[0],i=e;i--;)t[i-1]=arguments[i];return en(vs(r)?ta(r):[r],Gr(t,1))},fr.cond=function(e){var t=null==e?0:e.length,n=Ra();return e=t?$t(e,function(e){if("function"!=typeof e[1])throw new rt(l);return[n(e[0]),e[1]]}):[],bi(function(n){for(var r=-1;++r<t;){var i=e[r];if(zt(i[0],this,n))return zt(i[1],this,n)}})},fr.conforms=function(e){return function(e){var t=rl(e);return function(n){return Or(n,e,t)}}(Rr(e,f))},fr.constant=Tl,fr.countBy=Vo,fr.create=function(e,t){var n=dr(e);return null==t?n:Ir(n,t)},fr.curry=function e(t,n,r){var i=wa(t,A,a,a,a,a,a,n=r?a:n);return i.placeholder=e.placeholder,i},fr.curryRight=function e(t,n,r){var i=wa(t,x,a,a,a,a,a,n=r?a:n);return i.placeholder=e.placeholder,i},fr.debounce=rs,fr.defaults=qs,fr.defaultsDeep=Zs,fr.defer=is,fr.delay=as,fr.difference=ho,fr.differenceBy=fo,fr.differenceWith=po,fr.drop=function(e,t,n){var r=null==e?0:e.length;return r?Pi(e,(t=n||t===a?1:Xs(t))<0?0:t,r):[]},fr.dropRight=function(e,t,n){var r=null==e?0:e.length;return r?Pi(e,0,(t=r-(t=n||t===a?1:Xs(t)))<0?0:t):[]},fr.dropRightWhile=function(e,t){return e&&e.length?Bi(e,Ra(t,3),!0,!0):[]},fr.dropWhile=function(e,t){return e&&e.length?Bi(e,Ra(t,3),!0):[]},fr.fill=function(e,t,n,r){var i=null==e?0:e.length;return i?(n&&"number"!=typeof n&&za(e,t,n)&&(n=0,r=i),function(e,t,n,r){var i=e.length;for((n=Xs(n))<0&&(n=-n>i?0:i+n),(r=r===a||r>i?i:Xs(r))<0&&(r+=i),r=n>r?0:Vs(r);n<r;)e[n++]=t;return e}(e,t,n,r)):[]},fr.filter=function(e,t){return(vs(e)?qt:jr)(e,Ra(t,3))},fr.flatMap=function(e,t){return Gr(Ko(e,t),1)},fr.flatMapDeep=function(e,t){return Gr(Ko(e,t),N)},fr.flatMapDepth=function(e,t,n){return n=n===a?1:Xs(n),Gr(Ko(e,t),n)},fr.flatten=go,fr.flattenDeep=function(e){return null!=e&&e.length?Gr(e,N):[]},fr.flattenDepth=function(e,t){return null!=e&&e.length?Gr(e,t=t===a?1:Xs(t)):[]},fr.flip=function(e){return wa(e,T)},fr.flow=El,fr.flowRight=Ll,fr.fromPairs=function(e){for(var t=-1,n=null==e?0:e.length,r={};++t<n;){var i=e[t];r[i[0]]=i[1]}return r},fr.functions=function(e){return null==e?[]:Wr(e,rl(e))},fr.functionsIn=function(e){return null==e?[]:Wr(e,il(e))},fr.groupBy=Yo,fr.initial=function(e){return null!=e&&e.length?Pi(e,0,-1):[]},fr.intersection=yo,fr.intersectionBy=Ao,fr.intersectionWith=xo,fr.invert=el,fr.invertBy=tl,fr.invokeMap=Qo,fr.iteratee=Il,fr.keyBy=Wo,fr.keys=rl,fr.keysIn=il,fr.map=Ko,fr.mapKeys=function(e,t){var n={};return t=Ra(t,3),Yr(e,function(e,r,i){Mr(n,t(e,r,i),e)}),n},fr.mapValues=function(e,t){var n={};return t=Ra(t,3),Yr(e,function(e,r,i){Mr(n,r,t(e,r,i))}),n},fr.matches=function(e){return fi(Rr(e,f))},fr.matchesProperty=function(e,t){return di(e,Rr(t,f))},fr.memoize=os,fr.merge=al,fr.mergeWith=ol,fr.method=Ml,fr.methodOf=Cl,fr.mixin=Nl,fr.negate=ss,fr.nthArg=function(e){return e=Xs(e),bi(function(t){return mi(t,e)})},fr.omit=sl,fr.omitBy=function(e,t){return ul(e,ss(Ra(t)))},fr.once=function(e){return es(2,e)},fr.orderBy=function(e,t,n,r){return null==e?[]:(vs(t)||(t=null==t?[]:[t]),vs(n=r?a:n)||(n=null==n?[]:[n]),vi(e,t,n))},fr.over=Ol,fr.overArgs=ls,fr.overEvery=Ul,fr.overSome=kl,fr.partial=us,fr.partialRight=cs,fr.partition=qo,fr.pick=ll,fr.pickBy=ul,fr.property=Dl,fr.propertyOf=function(e){return function(t){return null==e?a:Kr(e,t)}},fr.pull=wo,fr.pullAll=So,fr.pullAllBy=function(e,t,n){return e&&e.length&&t&&t.length?_i(e,t,Ra(n,2)):e},fr.pullAllWith=function(e,t,n){return e&&e.length&&t&&t.length?_i(e,t,a,n):e},fr.pullAt=Fo,fr.range=Bl,fr.rangeRight=Xl,fr.rearg=hs,fr.reject=function(e,t){return(vs(e)?qt:jr)(e,ss(Ra(t,3)))},fr.remove=function(e,t){var n=[];if(!e||!e.length)return n;var r=-1,i=[],a=e.length;for(t=Ra(t,3);++r<a;){var o=e[r];t(o,r,e)&&(n.push(o),i.push(r))}return yi(e,i),n},fr.rest=function(e,t){if("function"!=typeof e)throw new rt(l);return bi(e,t=t===a?t:Xs(t))},fr.reverse=To,fr.sampleSize=function(e,t,n){return t=(n?za(e,t,n):t===a)?1:Xs(t),(vs(e)?Sr:Si)(e,t)},fr.set=function(e,t,n){return null==e?e:Fi(e,t,n)},fr.setWith=function(e,t,n,r){return r="function"==typeof r?r:a,null==e?e:Fi(e,t,n,r)},fr.shuffle=function(e){return(vs(e)?Fr:Li)(e)},fr.slice=function(e,t,n){var r=null==e?0:e.length;return r?(n&&"number"!=typeof n&&za(e,t,n)?(t=0,n=r):(t=null==t?0:Xs(t),n=n===a?r:Xs(n)),Pi(e,t,n)):[]},fr.sortBy=Zo,fr.sortedUniq=function(e){return e&&e.length?Ni(e):[]},fr.sortedUniqBy=function(e,t){return e&&e.length?Ni(e,Ra(t,2)):[]},fr.split=function(e,t,n){return n&&"number"!=typeof n&&za(e,t,n)&&(t=n=a),(n=n===a?k:n>>>0)?(e=Hs(e))&&("string"==typeof t||null!=t&&!Ms(t))&&!(t=Oi(t))&&Fn(e)?Qi(Cn(e),0,n):e.split(t,n):[]},fr.spread=function(e,t){if("function"!=typeof e)throw new rt(l);return t=null==t?0:Hn(Xs(t),0),bi(function(n){var r=n[t],i=Qi(n,0,t);return r&&en(i,r),zt(e,this,i)})},fr.tail=function(e){var t=null==e?0:e.length;return t?Pi(e,1,t):[]},fr.take=function(e,t,n){return e&&e.length?Pi(e,0,(t=n||t===a?1:Xs(t))<0?0:t):[]},fr.takeRight=function(e,t,n){var r=null==e?0:e.length;return r?Pi(e,(t=r-(t=n||t===a?1:Xs(t)))<0?0:t,r):[]},fr.takeRightWhile=function(e,t){return e&&e.length?Bi(e,Ra(t,3),!1,!0):[]},fr.takeWhile=function(e,t){return e&&e.length?Bi(e,Ra(t,3)):[]},fr.tap=function(e,t){return t(e),e},fr.throttle=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new rt(l);return Ts(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),rs(e,t,{leading:r,maxWait:t,trailing:i})},fr.thru=Bo,fr.toArray=Ds,fr.toPairs=cl,fr.toPairsIn=hl,fr.toPath=function(e){return vs(e)?$t(e,lo):Rs(e)?[e]:ta(so(Hs(e)))},fr.toPlainObject=Gs,fr.transform=function(e,t,n){var r=vs(e),i=r||As(e)||Os(e);if(t=Ra(t,4),null==n){var a=e&&e.constructor;n=i?r?new a:[]:Ts(e)&&ws(a)?dr(Lt(e)):{}}return(i?Qt:Yr)(e,function(e,r,i){return t(n,e,r,i)}),n},fr.unary=function(e){return $o(e,1)},fr.union=Eo,fr.unionBy=Lo,fr.unionWith=Po,fr.uniq=function(e){return e&&e.length?Ui(e):[]},fr.uniqBy=function(e,t){return e&&e.length?Ui(e,Ra(t,2)):[]},fr.uniqWith=function(e,t){return t="function"==typeof t?t:a,e&&e.length?Ui(e,a,t):[]},fr.unset=function(e,t){return null==e||ki(e,t)},fr.unzip=Io,fr.unzipWith=Mo,fr.update=function(e,t,n){return null==e?e:Di(e,t,Hi(n))},fr.updateWith=function(e,t,n,r){return r="function"==typeof r?r:a,null==e?e:Di(e,t,Hi(n),r)},fr.values=fl,fr.valuesIn=function(e){return null==e?[]:_n(e,il(e))},fr.without=Co,fr.words=wl,fr.wrap=function(e,t){return us(Hi(t),e)},fr.xor=No,fr.xorBy=Ro,fr.xorWith=Oo,fr.zip=Uo,fr.zipObject=function(e,t){return ji(e||[],t||[],Er)},fr.zipObjectDeep=function(e,t){return ji(e||[],t||[],Fi)},fr.zipWith=ko,fr.entries=cl,fr.entriesIn=hl,fr.extend=Ys,fr.extendWith=Qs,Nl(fr,fr),fr.add=Gl,fr.attempt=Sl,fr.camelCase=dl,fr.capitalize=pl,fr.ceil=Hl,fr.clamp=function(e,t,n){return n===a&&(n=t,t=a),n!==a&&(n=(n=js(n))==n?n:0),t!==a&&(t=(t=js(t))==t?t:0),Nr(js(e),t,n)},fr.clone=function(e){return Rr(e,p)},fr.cloneDeep=function(e){return Rr(e,f|p)},fr.cloneDeepWith=function(e,t){return Rr(e,f|p,t="function"==typeof t?t:a)},fr.cloneWith=function(e,t){return Rr(e,p,t="function"==typeof t?t:a)},fr.conformsTo=function(e,t){return null==t||Or(e,t,rl(t))},fr.deburr=ml,fr.defaultTo=function(e,t){return null==e||e!=e?t:e},fr.divide=zl,fr.endsWith=function(e,t,n){e=Hs(e),t=Oi(t);var r=e.length,i=n=n===a?r:Nr(Xs(n),0,r);return(n-=t.length)>=0&&e.slice(n,i)==t},fr.eq=fs,fr.escape=function(e){return(e=Hs(e))&&Fe.test(e)?e.replace(we,wn):e},fr.escapeRegExp=function(e){return(e=Hs(e))&&Ne.test(e)?e.replace(Ce,"\\$&"):e},fr.every=function(e,t,n){var r=vs(e)?Kt:Xr;return n&&za(e,t,n)&&(t=a),r(e,Ra(t,3))},fr.find=jo,fr.findIndex=mo,fr.findKey=function(e,t){return on(e,Ra(t,3),Yr)},fr.findLast=Go,fr.findLastIndex=vo,fr.findLastKey=function(e,t){return on(e,Ra(t,3),Qr)},fr.floor=Yl,fr.forEach=Ho,fr.forEachRight=zo,fr.forIn=function(e,t){return null==e?e:Hr(e,Ra(t,3),il)},fr.forInRight=function(e,t){return null==e?e:zr(e,Ra(t,3),il)},fr.forOwn=function(e,t){return e&&Yr(e,Ra(t,3))},fr.forOwnRight=function(e,t){return e&&Qr(e,Ra(t,3))},fr.get=Js,fr.gt=ds,fr.gte=ps,fr.has=function(e,t){return null!=e&&Va(e,t,$r)},fr.hasIn=$s,fr.head=_o,fr.identity=Pl,fr.includes=function(e,t,n,r){e=_s(e)?e:fl(e),n=n&&!r?Xs(n):0;var i=e.length;return n<0&&(n=Hn(i+n,0)),Ns(e)?n<=i&&e.indexOf(t,n)>-1:!!i&&ln(e,t,n)>-1},fr.indexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=null==n?0:Xs(n);return i<0&&(i=Hn(r+i,0)),ln(e,t,i)},fr.inRange=function(e,t,n){return t=Bs(t),n===a?(n=t,t=0):n=Bs(n),function(e,t,n){return e>=zn(t,n)&&e<Hn(t,n)}(e=js(e),t,n)},fr.invoke=nl,fr.isArguments=ms,fr.isArray=vs,fr.isArrayBuffer=gs,fr.isArrayLike=_s,fr.isArrayLikeObject=ys,fr.isBoolean=function(e){return!0===e||!1===e||Es(e)&&Zr(e)==H},fr.isBuffer=As,fr.isDate=xs,fr.isElement=function(e){return Es(e)&&1===e.nodeType&&!Is(e)},fr.isEmpty=function(e){if(null==e)return!0;if(_s(e)&&(vs(e)||"string"==typeof e||"function"==typeof e.splice||As(e)||Os(e)||ms(e)))return!e.length;var t=Xa(e);if(t==q||t==ne)return!e.size;if(Ka(e))return!li(e).length;for(var n in e)if(ut.call(e,n))return!1;return!0},fr.isEqual=function(e,t){return ii(e,t)},fr.isEqualWith=function(e,t,n){var r=(n="function"==typeof n?n:a)?n(e,t):a;return r===a?ii(e,t,a,n):!!r},fr.isError=bs,fr.isFinite=function(e){return"number"==typeof e&&Vn(e)},fr.isFunction=ws,fr.isInteger=Ss,fr.isLength=Fs,fr.isMap=Ls,fr.isMatch=function(e,t){return e===t||ai(e,t,Ua(t))},fr.isMatchWith=function(e,t,n){return n="function"==typeof n?n:a,ai(e,t,Ua(t),n)},fr.isNaN=function(e){return Ps(e)&&e!=+e},fr.isNative=function(e){if(Wa(e))throw new i(s);return oi(e)},fr.isNil=function(e){return null==e},fr.isNull=function(e){return null===e},fr.isNumber=Ps,fr.isObject=Ts,fr.isObjectLike=Es,fr.isPlainObject=Is,fr.isRegExp=Ms,fr.isSafeInteger=function(e){return Ss(e)&&e>=-R&&e<=R},fr.isSet=Cs,fr.isString=Ns,fr.isSymbol=Rs,fr.isTypedArray=Os,fr.isUndefined=function(e){return e===a},fr.isWeakMap=function(e){return Es(e)&&Xa(e)==oe},fr.isWeakSet=function(e){return Es(e)&&Zr(e)==se},fr.join=function(e,t){return null==e?"":jn.call(e,t)},fr.kebabCase=vl,fr.last=bo,fr.lastIndexOf=function(e,t,n){var r=null==e?0:e.length;if(!r)return-1;var i=r;return n!==a&&(i=(i=Xs(n))<0?Hn(r+i,0):zn(i,r-1)),t==t?function(e,t,n){for(var r=n+1;r--;)if(e[r]===t)return r;return r}(e,t,i):sn(e,cn,i,!0)},fr.lowerCase=gl,fr.lowerFirst=_l,fr.lt=Us,fr.lte=ks,fr.max=function(e){return e&&e.length?Vr(e,Pl,Jr):a},fr.maxBy=function(e,t){return e&&e.length?Vr(e,Ra(t,2),Jr):a},fr.mean=function(e){return hn(e,Pl)},fr.meanBy=function(e,t){return hn(e,Ra(t,2))},fr.min=function(e){return e&&e.length?Vr(e,Pl,ci):a},fr.minBy=function(e,t){return e&&e.length?Vr(e,Ra(t,2),ci):a},fr.stubArray=Vl,fr.stubFalse=jl,fr.stubObject=function(){return{}},fr.stubString=function(){return""},fr.stubTrue=function(){return!0},fr.multiply=Ql,fr.nth=function(e,t){return e&&e.length?mi(e,Xs(t)):a},fr.noConflict=function(){return Nt._===this&&(Nt._=pt),this},fr.noop=Rl,fr.now=Jo,fr.pad=function(e,t,n){e=Hs(e);var r=(t=Xs(t))?Mn(e):0;if(!t||r>=t)return e;var i=(t-r)/2;return va(Dn(i),n)+e+va(kn(i),n)},fr.padEnd=function(e,t,n){e=Hs(e);var r=(t=Xs(t))?Mn(e):0;return t&&r<t?e+va(t-r,n):e},fr.padStart=function(e,t,n){e=Hs(e);var r=(t=Xs(t))?Mn(e):0;return t&&r<t?va(t-r,n)+e:e},fr.parseInt=function(e,t,n){return n||null==t?t=0:t&&(t=+t),Qn(Hs(e).replace(Oe,""),t||0)},fr.random=function(e,t,n){if(n&&"boolean"!=typeof n&&za(e,t,n)&&(t=n=a),n===a&&("boolean"==typeof t?(n=t,t=a):"boolean"==typeof e&&(n=e,e=a)),e===a&&t===a?(e=0,t=1):(e=Bs(e),t===a?(t=e,e=0):t=Bs(t)),e>t){var r=e;e=t,t=r}if(n||e%1||t%1){var i=Wn();return zn(e+i*(t-e+Pt("1e-"+((i+"").length-1))),t)}return Ai(e,t)},fr.reduce=function(e,t,n){var r=vs(e)?tn:pn,i=arguments.length<3;return r(e,Ra(t,4),n,i,Dr)},fr.reduceRight=function(e,t,n){var r=vs(e)?nn:pn,i=arguments.length<3;return r(e,Ra(t,4),n,i,Br)},fr.repeat=function(e,t,n){return t=(n?za(e,t,n):t===a)?1:Xs(t),xi(Hs(e),t)},fr.replace=function(){var e=arguments,t=Hs(e[0]);return e.length<3?t:t.replace(e[1],e[2])},fr.result=function(e,t,n){var r=-1,i=(t=zi(t,e)).length;for(i||(i=1,e=a);++r<i;){var o=null==e?a:e[lo(t[r])];o===a&&(r=i,o=n),e=ws(o)?o.call(e):o}return e},fr.round=Wl,fr.runInContext=e,fr.sample=function(e){return(vs(e)?wr:wi)(e)},fr.size=function(e){if(null==e)return 0;if(_s(e))return Ns(e)?Mn(e):e.length;var t=Xa(e);return t==q||t==ne?e.size:li(e).length},fr.snakeCase=yl,fr.some=function(e,t,n){var r=vs(e)?rn:Ii;return n&&za(e,t,n)&&(t=a),r(e,Ra(t,3))},fr.sortedIndex=function(e,t){return Mi(e,t)},fr.sortedIndexBy=function(e,t,n){return Ci(e,t,Ra(n,2))},fr.sortedIndexOf=function(e,t){var n=null==e?0:e.length;if(n){var r=Mi(e,t);if(r<n&&fs(e[r],t))return r}return-1},fr.sortedLastIndex=function(e,t){return Mi(e,t,!0)},fr.sortedLastIndexBy=function(e,t,n){return Ci(e,t,Ra(n,2),!0)},fr.sortedLastIndexOf=function(e,t){if(null!=e&&e.length){var n=Mi(e,t,!0)-1;if(fs(e[n],t))return n}return-1},fr.startCase=Al,fr.startsWith=function(e,t,n){return e=Hs(e),n=null==n?0:Nr(Xs(n),0,e.length),t=Oi(t),e.slice(n,n+t.length)==t},fr.subtract=Kl,fr.sum=function(e){return e&&e.length?mn(e,Pl):0},fr.sumBy=function(e,t){return e&&e.length?mn(e,Ra(t,2)):0},fr.template=function(e,t,n){var r=fr.templateSettings;n&&za(e,t,n)&&(t=a),e=Hs(e),t=Qs({},t,r,Sa);var i,o,s=Qs({},t.imports,r.imports,Sa),l=rl(s),u=_n(s,l),c=0,h=t.interpolate||qe,f="__p += '",d=tt((t.escape||qe).source+"|"+h.source+"|"+(h===Le?je:qe).source+"|"+(t.evaluate||qe).source+"|$","g"),p="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++Ft+"]")+"\n";e.replace(d,function(t,n,r,a,s,l){return r||(r=a),f+=e.slice(c,l).replace(Ze,Sn),n&&(i=!0,f+="' +\n__e("+n+") +\n'"),s&&(o=!0,f+="';\n"+s+";\n__p += '"),r&&(f+="' +\n((__t = ("+r+")) == null ? '' : __t) +\n'"),c=l+t.length,t}),f+="';\n";var m=t.variable;m||(f="with (obj) {\n"+f+"\n}\n"),f=(o?f.replace(ye,""):f).replace(Ae,"$1").replace(xe,"$1;"),f="function("+(m||"obj")+") {\n"+(m?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(i?", __e = _.escape":"")+(o?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+f+"return __p\n}";var v=Sl(function(){return Je(l,p+"return "+f).apply(a,u)});if(v.source=f,bs(v))throw v;return v},fr.times=function(e,t){if((e=Xs(e))<1||e>R)return[];var n=k,r=zn(e,k);t=Ra(t),e-=k;for(var i=vn(r,t);++n<e;)t(n);return i},fr.toFinite=Bs,fr.toInteger=Xs,fr.toLength=Vs,fr.toLower=function(e){return Hs(e).toLowerCase()},fr.toNumber=js,fr.toSafeInteger=function(e){return e?Nr(Xs(e),-R,R):0===e?e:0},fr.toString=Hs,fr.toUpper=function(e){return Hs(e).toUpperCase()},fr.trim=function(e,t,n){if((e=Hs(e))&&(n||t===a))return e.replace(Re,"");if(!e||!(t=Oi(t)))return e;var r=Cn(e),i=Cn(t);return Qi(r,An(r,i),xn(r,i)+1).join("")},fr.trimEnd=function(e,t,n){if((e=Hs(e))&&(n||t===a))return e.replace(Ue,"");if(!e||!(t=Oi(t)))return e;var r=Cn(e);return Qi(r,0,xn(r,Cn(t))+1).join("")},fr.trimStart=function(e,t,n){if((e=Hs(e))&&(n||t===a))return e.replace(Oe,"");if(!e||!(t=Oi(t)))return e;var r=Cn(e);return Qi(r,An(r,Cn(t))).join("")},fr.truncate=function(e,t){var n=E,r=L;if(Ts(t)){var i="separator"in t?t.separator:i;n="length"in t?Xs(t.length):n,r="omission"in t?Oi(t.omission):r}var o=(e=Hs(e)).length;if(Fn(e)){var s=Cn(e);o=s.length}if(n>=o)return e;var l=n-Mn(r);if(l<1)return r;var u=s?Qi(s,0,l).join(""):e.slice(0,l);if(i===a)return u+r;if(s&&(l+=u.length-l),Ms(i)){if(e.slice(l).search(i)){var c,h=u;for(i.global||(i=tt(i.source,Hs(Ge.exec(i))+"g")),i.lastIndex=0;c=i.exec(h);)var f=c.index;u=u.slice(0,f===a?l:f)}}else if(e.indexOf(Oi(i),l)!=l){var d=u.lastIndexOf(i);d>-1&&(u=u.slice(0,d))}return u+r},fr.unescape=function(e){return(e=Hs(e))&&Se.test(e)?e.replace(be,Nn):e},fr.uniqueId=function(e){var t=++ct;return Hs(e)+t},fr.upperCase=xl,fr.upperFirst=bl,fr.each=Ho,fr.eachRight=zo,fr.first=_o,Nl(fr,function(){var e={};return Yr(fr,function(t,n){ut.call(fr.prototype,n)||(e[n]=t)}),e}(),{chain:!1}),fr.VERSION="4.17.11",Qt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){fr[e].placeholder=fr}),Qt(["drop","take"],function(e,t){vr.prototype[e]=function(n){n=n===a?1:Hn(Xs(n),0);var r=this.__filtered__&&!t?new vr(this):this.clone();return r.__filtered__?r.__takeCount__=zn(n,r.__takeCount__):r.__views__.push({size:zn(n,k),type:e+(r.__dir__<0?"Right":"")}),r},vr.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}}),Qt(["filter","map","takeWhile"],function(e,t){var n=t+1,r=n==M||3==n;vr.prototype[e]=function(e){var t=this.clone();return t.__iteratees__.push({iteratee:Ra(e,3),type:n}),t.__filtered__=t.__filtered__||r,t}}),Qt(["head","last"],function(e,t){var n="take"+(t?"Right":"");vr.prototype[e]=function(){return this[n](1).value()[0]}}),Qt(["initial","tail"],function(e,t){var n="drop"+(t?"":"Right");vr.prototype[e]=function(){return this.__filtered__?new vr(this):this[n](1)}}),vr.prototype.compact=function(){return this.filter(Pl)},vr.prototype.find=function(e){return this.filter(e).head()},vr.prototype.findLast=function(e){return this.reverse().find(e)},vr.prototype.invokeMap=bi(function(e,t){return"function"==typeof e?new vr(this):this.map(function(n){return ni(n,e,t)})}),vr.prototype.reject=function(e){return this.filter(ss(Ra(e)))},vr.prototype.slice=function(e,t){e=Xs(e);var n=this;return n.__filtered__&&(e>0||t<0)?new vr(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==a&&(n=(t=Xs(t))<0?n.dropRight(-t):n.take(t-e)),n)},vr.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},vr.prototype.toArray=function(){return this.take(k)},Yr(vr.prototype,function(e,t){var n=/^(?:filter|find|map|reject)|While$/.test(t),r=/^(?:head|last)$/.test(t),i=fr[r?"take"+("last"==t?"Right":""):t],o=r||/^find/.test(t);i&&(fr.prototype[t]=function(){var t=this.__wrapped__,s=r?[1]:arguments,l=t instanceof vr,u=s[0],c=l||vs(t),h=function(e){var t=i.apply(fr,en([e],s));return r&&f?t[0]:t};c&&n&&"function"==typeof u&&1!=u.length&&(l=c=!1);var f=this.__chain__,d=!!this.__actions__.length,p=o&&!f,m=l&&!d;if(!o&&c){t=m?t:new vr(this);var v=e.apply(t,s);return v.__actions__.push({func:Bo,args:[h],thisArg:a}),new mr(v,f)}return p&&m?e.apply(this,s):(v=this.thru(h),p?r?v.value()[0]:v.value():v)})}),Qt(["pop","push","shift","sort","splice","unshift"],function(e){var t=it[e],n=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",r=/^(?:pop|shift)$/.test(e);fr.prototype[e]=function(){var e=arguments;if(r&&!this.__chain__){var i=this.value();return t.apply(vs(i)?i:[],e)}return this[n](function(n){return t.apply(vs(n)?n:[],e)})}}),Yr(vr.prototype,function(e,t){var n=fr[t];if(n){var r=n.name+"";(rr[r]||(rr[r]=[])).push({name:t,func:n})}}),rr[fa(a,_).name]=[{name:"wrapper",func:a}],vr.prototype.clone=function(){var e=new vr(this.__wrapped__);return e.__actions__=ta(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=ta(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=ta(this.__views__),e},vr.prototype.reverse=function(){if(this.__filtered__){var e=new vr(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},vr.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=vs(e),r=t<0,i=n?e.length:0,a=function(e,t,n){for(var r=-1,i=n.length;++r<i;){var a=n[r],o=a.size;switch(a.type){case"drop":e+=o;break;case"dropRight":t-=o;break;case"take":t=zn(t,e+o);break;case"takeRight":e=Hn(e,t-o)}}return{start:e,end:t}}(0,i,this.__views__),o=a.start,s=a.end,l=s-o,u=r?s:o-1,c=this.__iteratees__,h=c.length,f=0,d=zn(l,this.__takeCount__);if(!n||!r&&i==l&&d==l)return Xi(e,this.__actions__);var p=[];e:for(;l--&&f<d;){for(var m=-1,v=e[u+=t];++m<h;){var g=c[m],_=g.iteratee,y=g.type,A=_(v);if(y==C)v=A;else if(!A){if(y==M)continue e;break e}}p[f++]=v}return p},fr.prototype.at=Xo,fr.prototype.chain=function(){return Do(this)},fr.prototype.commit=function(){return new mr(this.value(),this.__chain__)},fr.prototype.next=function(){this.__values__===a&&(this.__values__=Ds(this.value()));var e=this.__index__>=this.__values__.length;return{done:e,value:e?a:this.__values__[this.__index__++]}},fr.prototype.plant=function(e){for(var t,n=this;n instanceof pr;){var r=co(n);r.__index__=0,r.__values__=a,t?i.__wrapped__=r:t=r;var i=r;n=n.__wrapped__}return i.__wrapped__=e,t},fr.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof vr){var t=e;return this.__actions__.length&&(t=new vr(this)),(t=t.reverse()).__actions__.push({func:Bo,args:[To],thisArg:a}),new mr(t,this.__chain__)}return this.thru(To)},fr.prototype.toJSON=fr.prototype.valueOf=fr.prototype.value=function(){return Xi(this.__wrapped__,this.__actions__)},fr.prototype.first=fr.prototype.head,kt&&(fr.prototype[kt]=function(){return this}),fr}();Nt._=Rn,(i=function(){return Rn}.call(t,n,t,r))===a||(r.exports=i)}).call(this)}).call(this,n(14),n(15)(e))},function(e,t,n){var r=n(1),i=function(){var e,t,n,r,i,a,o,s,l,u,c,h,f,d,p,m,v,g,_,y=[],A=[],x=0,b=function(){var e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3;return function(r,i,a){return e.subVectors(a,r),t.subVectors(i,r),n.crossVectors(e,t),n.normalize()}}();function w(e,t){if(void 0!==e.normal)return e.normal;var n=t[e[0]],r=t[e[2]];return c.subVectors(t[e[1]],n),h.subVectors(r,n),p.crossVectors(h,c),p.normalize(),e.normal=p.clone()}function S(e,t,n){var r=n[e[0]],i=[],a=w(e,n);t.sort(function(e,t){return i[e.x/3]=void 0!==i[e.x/3]?i[e.x/3]:a.dot(f.subVectors(e,r)),i[t.x/3]=void 0!==i[t.x/3]?i[t.x/3]:a.dot(d.subVectors(t,r)),i[e.x/3]-i[t.x/3]});var o=t.length;for(1===o&&(i[t[0].x/3]=a.dot(f.subVectors(t[0],r)));o-- >0&&i[t[o].x/3]>0;);o+1<t.length&&i[t[o+1].x/3]>0&&(e.visiblePoints=t.splice(o+1))}function F(e,t){for(var n,r=y.length,i=[e],a=t.indexOf(e.visiblePoints.pop());r-- >0;)(n=y[r])!==e&&w(n,t).dot(m.subVectors(t[a],t[n[0]]))>0&&i.push(n);var o,s,l,u,c=r=i.length,h=1===r,f=[],d=0,p=[];if(1===i.length)f=[(n=i[0])[0],n[1],n[1],n[2],n[2],n[0]],A.indexOf(n)>-1&&A.splice(A.indexOf(n),1),n.visiblePoints&&(p=p.concat(n.visiblePoints)),y.splice(y.indexOf(n),1);else for(;r-- >0;){var v;for(A.indexOf(n=i[r])>-1&&A.splice(A.indexOf(n),1),n.visiblePoints&&(p=p.concat(n.visiblePoints)),y.splice(y.indexOf(n),1),cEdgeIndex=0;cEdgeIndex<3;){for(v=!1,c=i.length,l=n[cEdgeIndex],u=n[(cEdgeIndex+1)%3];c-- >0&&!v;)if(d=0,(o=i[c])!==n)for(;d<3&&!v;)s=d+1,v=o[d]===l&&o[s%3]===u||o[d]===u&&o[s%3]===l,d++;v&&!h||(f.push(l),f.push(u)),cEdgeIndex++}}r=0;for(var g,_=f.length/2;r<_;)S(g=[f[2*r+1],a,f[2*r]],p,t),y.push(g),void 0!==g.visiblePoints&&A.push(g),r++}var T=function(){var e=new THREE.Vector3,t=new THREE.Vector3,n=new THREE.Vector3;return function(r,i,a){e.subVectors(i,r),t.subVectors(a,r),n.subVectors(a,i);var o=t.dot(e);if(o<0)return t.dot(t);var s=e.dot(e);return o>=s?n.dot(n):t.dot(t)-o*o/s}}();return function(w){for(c=new THREE.Vector3,h=new THREE.Vector3,new THREE.Vector3,f=new THREE.Vector3,d=new THREE.Vector3,p=new THREE.Vector3,m=new THREE.Vector3,v=new THREE.Vector3,g=new THREE.Vector3,_=new THREE.Vector3,points=w.vertices,y=[],A=[],N=e=points.length,t=points.slice(0,6),x=0;N-- >0;)points[N].x<t[0].x&&(t[0]=points[N]),points[N].x>t[1].x&&(t[1]=points[N]),points[N].y<t[2].y&&(t[2]=points[N]),points[N].y<t[3].y&&(t[3]=points[N]),points[N].z<t[4].z&&(t[4]=points[N]),points[N].z<t[5].z&&(t[5]=points[N]);for(r=N=6;N-- >0;)for(r=N-1;r-- >0;)x<(n=t[N].distanceToSquared(t[r]))&&(x=n,i=t[N],a=t[r]);for(N=6,x=0;N-- >0;)n=T(i,a,t[N]),x<n&&(x=n,o=t[N]);for(l=b(i,a,o),u=l.dot(i),x=0,N=e;N-- >0;)n=Math.abs(points[N].dot(l)-u),x<n&&(x=n,s=points[N]);var E=points.indexOf(i),L=points.indexOf(a),P=points.indexOf(o),I=points.indexOf(s),M=[[P,L,E],[L,I,E],[P,I,L],[E,I,P]];v.subVectors(a,i).normalize(),g.subVectors(o,i).normalize(),_.subVectors(s,i).normalize(),_.dot((new THREE.Vector3).crossVectors(g,v))<0&&(M[0].reverse(),M[1].reverse(),M[2].reverse(),M[3].reverse());var C=points.slice();C.splice(C.indexOf(i),1),C.splice(C.indexOf(a),1),C.splice(C.indexOf(o),1),C.splice(C.indexOf(s),1);for(var N=M.length;N-- >0;)S(M[N],C,points),void 0!==M[N].visiblePoints&&A.push(M[N]),y.push(M[N]);!function(e){for(;A.length>0;)F(A.shift(),e)}(points);for(var R=y.length;R-- >0;)w.faces[R]=new THREE.Face3(y[R][2],y[R][1],y[R][0],y[R].normal);return w.normalsNeedUpdate=!0,w}}(),a=Math.PI/2,o={BOX:"Box",CYLINDER:"Cylinder",SPHERE:"Sphere",HULL:"ConvexPolyhedron",MESH:"Trimesh"},s=function(e,t){var n;if((t=t||{}).type===o.BOX)return u(e);if(t.type===o.CYLINDER)return function(e,t){var n,i,o,s=new THREE.Box3,l=["x","y","z"],u=t.cylinderAxis||"y",c=l.splice(l.indexOf(u),1)&&l;return s.setFromObject(e),isFinite(s.min.lengthSq())?(i=s.max[u]-s.min[u],o=.5*Math.max(s.max[c[0]]-s.min[c[0]],s.max[c[1]]-s.min[c[1]]),(n=new r.Cylinder(o,o,i,12))._type=r.Shape.types.CYLINDER,n.radiusTop=o,n.radiusBottom=o,n.height=i,n.numSegments=12,n.orientation=new r.Quaternion,n.orientation.setFromEuler("y"===u?a:0,"z"===u?a:0,0,"XYZ").normalize(),n):null}(e,t);if(t.type===o.SPHERE)return function(e,t){if(t.sphereRadius)return new r.Sphere(t.sphereRadius);var n=c(e);return n?(n.computeBoundingSphere(),new r.Sphere(n.boundingSphere.radius)):null}(e,t);if(t.type===o.HULL)return function(e){var t,n,a,o,s=c(e);if(!s||!s.vertices.length)return null;for(t=0;t<s.vertices.length;t++)s.vertices[t].x+=1e-4*(Math.random()-.5),s.vertices[t].y+=1e-4*(Math.random()-.5),s.vertices[t].z+=1e-4*(Math.random()-.5);for(o=i(s),n=new Array(o.vertices.length),t=0;t<o.vertices.length;t++)n[t]=new r.Vec3(o.vertices[t].x,o.vertices[t].y,o.vertices[t].z);for(a=new Array(o.faces.length),t=0;t<o.faces.length;t++)a[t]=[o.faces[t].a,o.faces[t].b,o.faces[t].c];return new r.ConvexPolyhedron(n,a)}(e);if(t.type===o.MESH)return(n=c(e))?function(e){var t,i=h(n);return i.length?(t=Object.keys(i).map(Number),new r.Trimesh(i,t)):null}():null;if(t.type)throw new Error('[CANNON.threeToCannon] Invalid type "%s".',t.type);if(!(n=c(e)))return null;switch(n.metadata?n.metadata.type:n.type){case"BoxGeometry":case"BoxBufferGeometry":return l(n);case"CylinderGeometry":case"CylinderBufferGeometry":return function(e){var t,n=e.metadata?e.metadata.parameters:e.parameters;return(t=new r.Cylinder(n.radiusTop,n.radiusBottom,n.height,n.radialSegments))._type=r.Shape.types.CYLINDER,t.radiusTop=n.radiusTop,t.radiusBottom=n.radiusBottom,t.height=n.height,t.numSegments=n.radialSegments,t.orientation=new r.Quaternion,t.orientation.setFromEuler(THREE.Math.degToRad(90),0,0,"XYZ").normalize(),t}(n);case"PlaneGeometry":case"PlaneBufferGeometry":return function(e){e.computeBoundingBox();var t=e.boundingBox;return new r.Box(new r.Vec3((t.max.x-t.min.x)/2||.1,(t.max.y-t.min.y)/2||.1,(t.max.z-t.min.z)/2||.1))}(n);case"SphereGeometry":case"SphereBufferGeometry":return function(e){return new r.Sphere((e.metadata?e.metadata.parameters:e.parameters).radius)}(n);case"TubeGeometry":case"Geometry":case"BufferGeometry":return u(e);default:return console.warn('Unrecognized geometry: "%s". Using bounding box as shape.',n.type),l(n)}};function l(e){if(!h(e).length)return null;e.computeBoundingBox();var t=e.boundingBox;return new r.Box(new r.Vec3((t.max.x-t.min.x)/2,(t.max.y-t.min.y)/2,(t.max.z-t.min.z)/2))}function u(e){var t,n,i=new THREE.Box3,a=e.clone();return a.quaternion.set(0,0,0,1),a.updateMatrixWorld(),i.setFromObject(a),isFinite(i.min.lengthSq())?(t=new r.Box(new r.Vec3((i.max.x-i.min.x)/2,(i.max.y-i.min.y)/2,(i.max.z-i.min.z)/2)),(n=i.translate(a.position.negate()).getCenter(new THREE.Vector3)).lengthSq()&&(t.offset=n),t):null}function c(e){var t,n,r=function(e){var t=[];return e.traverse(function(e){"Mesh"===e.type&&t.push(e)}),t}(e),i=new THREE.Geometry,a=new THREE.Geometry;if(0===r.length)return null;if(1===r.length){var o=new THREE.Vector3,s=new THREE.Quaternion,l=new THREE.Vector3;return r[0].geometry.isBufferGeometry?r[0].geometry.attributes.position&&r[0].geometry.attributes.position.itemSize>2&&i.fromBufferGeometry(r[0].geometry):i=r[0].geometry.clone(),i.metadata=r[0].geometry.metadata,r[0].updateMatrixWorld(),r[0].matrixWorld.decompose(o,s,l),i.scale(l.x,l.y,l.z)}for(;n=r.pop();)if(n.updateMatrixWorld(),n.geometry.isBufferGeometry){if(n.geometry.attributes.position&&n.geometry.attributes.position.itemSize>2){var u=new THREE.Geometry;u.fromBufferGeometry(n.geometry),a.merge(u,n.matrixWorld),u.dispose()}}else a.merge(n.geometry,n.matrixWorld);return(t=new THREE.Matrix4).scale(e.scale),a.applyMatrix(t),a}function h(e){return e.attributes||(e=(new THREE.BufferGeometry).fromGeometry(e)),(e.attributes.position||{}).array||[]}s.Type=o,t.threeToCannon=s},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var i=function(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}(r),a=r.sources.map(function(e){return"/*# sourceURL="+r.sourceRoot+e+" */"});return[n].concat(a).concat([i]).join("\n")}return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},i=0;i<this.length;i++){var a=this[i][0];"number"==typeof a&&(r[a]=!0)}for(i=0;i<e.length;i++){var o=e[i];"number"==typeof o[0]&&r[o[0]]||(n&&!o[2]?o[2]=n:n&&(o[2]="("+o[2]+") and ("+n+")"),t.push(o))}},t}},function(e,t,n){var r={},i=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}}(function(){return window&&document&&document.all&&!window.atob}),a=function(e){var t={};return function(e,n){if("function"==typeof e)return e();if(void 0===t[e]){var r=function(e,t){return t?t.querySelector(e):document.querySelector(e)}.call(this,e,n);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}}(),o=null,s=0,l=[],u=n(11);function c(e,t){for(var n=0;n<e.length;n++){var i=e[n],a=r[i.id];if(a){a.refs++;for(var o=0;o<a.parts.length;o++)a.parts[o](i.parts[o]);for(;o<i.parts.length;o++)a.parts.push(v(i.parts[o],t))}else{var s=[];for(o=0;o<i.parts.length;o++)s.push(v(i.parts[o],t));r[i.id]={id:i.id,refs:1,parts:s}}}}function h(e,t){for(var n=[],r={},i=0;i<e.length;i++){var a=e[i],o=t.base?a[0]+t.base:a[0],s={css:a[1],media:a[2],sourceMap:a[3]};r[o]?r[o].parts.push(s):n.push(r[o]={id:o,parts:[s]})}return n}function f(e,t){var n=a(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=l[l.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),l.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=a(e.insertAt.before,n);n.insertBefore(t,i)}}function d(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=l.indexOf(e);t>=0&&l.splice(t,1)}function p(e){var t=document.createElement("style");if(void 0===e.attrs.type&&(e.attrs.type="text/css"),void 0===e.attrs.nonce){var r=function(){0;return n.nc}();r&&(e.attrs.nonce=r)}return m(t,e.attrs),f(e,t),t}function m(e,t){Object.keys(t).forEach(function(n){e.setAttribute(n,t[n])})}function v(e,t){var n,r,i,a;if(t.transform&&e.css){if(!(a="function"==typeof t.transform?t.transform(e.css):t.transform.default(e.css)))return function(){};e.css=a}if(t.singleton){var l=s++;n=o||(o=p(t)),r=_.bind(null,n,l,!1),i=_.bind(null,n,l,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",m(t,e.attrs),f(e,t),t}(t),r=function(e,t,n){var r=n.css,i=n.sourceMap,a=void 0===t.convertToAbsoluteUrls&&i;(t.convertToAbsoluteUrls||a)&&(r=u(r));i&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var o=new Blob([r],{type:"text/css"}),s=e.href;e.href=URL.createObjectURL(o),s&&URL.revokeObjectURL(s)}.bind(null,n,t),i=function(){d(n),n.href&&URL.revokeObjectURL(n.href)}):(n=p(t),r=function(e,t){var n=t.css,r=t.media;r&&e.setAttribute("media",r);if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,n),i=function(){d(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else i()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=i()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=h(e,t);return c(n,t),function(e){for(var i=[],a=0;a<n.length;a++){var o=n[a];(s=r[o.id]).refs--,i.push(s)}e&&c(h(e,t),t);for(a=0;a<i.length;a++){var s;if(0===(s=i[a]).refs){for(var l=0;l<s.parts.length;l++)s.parts[l]();delete r[s.id]}}}};var g=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}();function _(e,t,n,r){var i=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=g(t,i);else{var a=document.createTextNode(i),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(a,o[t]):e.appendChild(a)}}},function(e,t,n){var r=n(0),i=function(){function e(e){this.manager=void 0!==e?e:r.DefaultLoadingManager,this.dracoLoader=null}e.prototype={constructor:e,crossOrigin:"anonymous",load:function(e,t,n,i){var a,o=this;a=void 0!==this.resourcePath?this.resourcePath:void 0!==this.path?this.path:r.LoaderUtils.extractUrlBase(e),o.manager.itemStart(e);var s=function(t){i?i(t):console.error(t),o.manager.itemEnd(e),o.manager.itemError(e)},l=new r.FileLoader(o.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.load(e,function(n){try{o.parse(n,a,function(n){t(n),o.manager.itemEnd(e)},s)}catch(e){s(e)}},n,s)},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setDRACOLoader:function(e){return this.dracoLoader=e,this},parse:function(e,h,f,d){var p,m={};if("string"==typeof e)p=e;else if(r.LoaderUtils.decodeText(new Uint8Array(e,0,4))===o){try{m[t.KHR_BINARY_GLTF]=new function(e){this.name=t.KHR_BINARY_GLTF,this.content=null,this.body=null;var n=new DataView(e,0,s);if(this.header={magic:r.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:n.getUint32(4,!0),length:n.getUint32(8,!0)},this.header.magic!==o)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");var i=new DataView(e,s),a=0;for(;a<i.byteLength;){var u=i.getUint32(a,!0);a+=4;var c=i.getUint32(a,!0);if(a+=4,c===l.JSON){var h=new Uint8Array(e,s+a,u);this.content=r.LoaderUtils.decodeText(h)}else if(c===l.BIN){var f=s+a;this.body=e.slice(f,f+u)}a+=u}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}(e)}catch(e){return void(d&&d(e))}p=m[t.KHR_BINARY_GLTF].content}else p=r.LoaderUtils.decodeText(new Uint8Array(e));var v=JSON.parse(p);if(void 0===v.asset||v.asset.version[0]<2)d&&d(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead."));else{if(v.extensionsUsed)for(var g=0;g<v.extensionsUsed.length;++g){var _=v.extensionsUsed[g],y=v.extensionsRequired||[];switch(_){case t.KHR_LIGHTS_PUNCTUAL:m[_]=new i(v);break;case t.KHR_MATERIALS_UNLIT:m[_]=new a(v);break;case t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:m[_]=new c;break;case t.KHR_DRACO_MESH_COMPRESSION:m[_]=new u(v,this.dracoLoader);break;case t.MSFT_TEXTURE_DDS:m[t.MSFT_TEXTURE_DDS]=new n;break;default:y.indexOf(_)>=0&&console.warn('THREE.GLTFLoader: Unknown extension "'+_+'".')}}var A=new B(v,m,{path:h||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager});A.parse(function(e,t,n,r,i){var a={scene:e,scenes:t,cameras:n,animations:r,asset:i.asset,parser:A,userData:{}};M(m,a,i),f(a)},d)}}};var t={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};function n(){if(!r.DDSLoader)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=t.MSFT_TEXTURE_DDS,this.ddsLoader=new r.DDSLoader}function i(e){this.name=t.KHR_LIGHTS_PUNCTUAL,this.lights=[];for(var n=(e.extensions&&e.extensions[t.KHR_LIGHTS_PUNCTUAL]||{}).lights||[],i=0;i<n.length;i++){var a,o=n[i],s=new r.Color(16777215);void 0!==o.color&&s.fromArray(o.color);var l=void 0!==o.range?o.range:0;switch(o.type){case"directional":(a=new r.DirectionalLight(s)).target.position.set(0,0,-1),a.add(a.target);break;case"point":(a=new r.PointLight(s)).distance=l;break;case"spot":(a=new r.SpotLight(s)).distance=l,o.spot=o.spot||{},o.spot.innerConeAngle=void 0!==o.spot.innerConeAngle?o.spot.innerConeAngle:0,o.spot.outerConeAngle=void 0!==o.spot.outerConeAngle?o.spot.outerConeAngle:Math.PI/4,a.angle=o.spot.outerConeAngle,a.penumbra=1-o.spot.innerConeAngle/o.spot.outerConeAngle,a.target.position.set(0,0,-1),a.add(a.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type, "'+o.type+'".')}a.decay=2,void 0!==o.intensity&&(a.intensity=o.intensity),a.name=o.name||"light_"+i,this.lights.push(a)}}function a(e){this.name=t.KHR_MATERIALS_UNLIT}a.prototype.getMaterialType=function(e){return r.MeshBasicMaterial},a.prototype.extendParams=function(e,t,n){var i=[];e.color=new r.Color(1,1,1),e.opacity=1;var a=t.pbrMetallicRoughness;if(a){if(Array.isArray(a.baseColorFactor)){var o=a.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==a.baseColorTexture&&i.push(n.assignTexture(e,"map",a.baseColorTexture.index))}return Promise.all(i)};var o="glTF",s=12,l={JSON:1313821514,BIN:5130562};function u(e,n){if(!n)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=t.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=n}function c(){return{name:t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return r.ShaderMaterial},extendParams:function(e,t,n){var i=t.extensions[this.name],a=r.ShaderLib.standard,o=r.UniformsUtils.clone(a.uniforms),s=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),l=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),u=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),c=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),h=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb;","material.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );","material.specularColor = specularFactor.rgb;"].join("\n"),f=a.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",s).replace("#include <metalnessmap_pars_fragment>",l).replace("#include <roughnessmap_fragment>",u).replace("#include <metalnessmap_fragment>",c).replace("#include <lights_physical_fragment>",h);delete o.roughness,delete o.metalness,delete o.roughnessMap,delete o.metalnessMap,o.specular={value:(new r.Color).setHex(1118481)},o.glossiness={value:.5},o.specularMap={value:null},o.glossinessMap={value:null},e.vertexShader=a.vertexShader,e.fragmentShader=f,e.uniforms=o,e.defines={STANDARD:""},e.color=new r.Color(1,1,1),e.opacity=1;var d=[];if(Array.isArray(i.diffuseFactor)){var p=i.diffuseFactor;e.color.fromArray(p),e.opacity=p[3]}if(void 0!==i.diffuseTexture&&d.push(n.assignTexture(e,"map",i.diffuseTexture.index)),e.emissive=new r.Color(0,0,0),e.glossiness=void 0!==i.glossinessFactor?i.glossinessFactor:1,e.specular=new r.Color(1,1,1),Array.isArray(i.specularFactor)&&e.specular.fromArray(i.specularFactor),void 0!==i.specularGlossinessTexture){var m=i.specularGlossinessTexture.index;d.push(n.assignTexture(e,"glossinessMap",m)),d.push(n.assignTexture(e,"specularMap",m))}return Promise.all(d)},createMaterial:function(e){var t=new r.ShaderMaterial({defines:e.defines,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,uniforms:e.uniforms,fog:!0,lights:!0,opacity:e.opacity,transparent:e.transparent});return t.isGLTFSpecularGlossinessMaterial=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t.extensions.derivatives=!0,t},cloneMaterial:function(e){var t=e.clone();t.isGLTFSpecularGlossinessMaterial=!0;for(var n=this.specularGlossinessParams,r=0,i=n.length;r<i;r++)t[n[r]]=e[n[r]];return t},refreshUniforms:function(e,t,n,r,i,a){if(!0===i.isGLTFSpecularGlossinessMaterial){var o,s=i.uniforms,l=i.defines;s.opacity.value=i.opacity,s.diffuse.value.copy(i.color),s.emissive.value.copy(i.emissive).multiplyScalar(i.emissiveIntensity),s.map.value=i.map,s.specularMap.value=i.specularMap,s.alphaMap.value=i.alphaMap,s.lightMap.value=i.lightMap,s.lightMapIntensity.value=i.lightMapIntensity,s.aoMap.value=i.aoMap,s.aoMapIntensity.value=i.aoMapIntensity,i.map?o=i.map:i.specularMap?o=i.specularMap:i.displacementMap?o=i.displacementMap:i.normalMap?o=i.normalMap:i.bumpMap?o=i.bumpMap:i.glossinessMap?o=i.glossinessMap:i.alphaMap?o=i.alphaMap:i.emissiveMap&&(o=i.emissiveMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),s.uvTransform.value.copy(o.matrix)),s.envMap.value=i.envMap,s.envMapIntensity.value=i.envMapIntensity,s.flipEnvMap.value=i.envMap&&i.envMap.isCubeTexture?-1:1,s.refractionRatio.value=i.refractionRatio,s.specular.value.copy(i.specular),s.glossiness.value=i.glossiness,s.glossinessMap.value=i.glossinessMap,s.emissiveMap.value=i.emissiveMap,s.bumpMap.value=i.bumpMap,s.normalMap.value=i.normalMap,s.displacementMap.value=i.displacementMap,s.displacementScale.value=i.displacementScale,s.displacementBias.value=i.displacementBias,null!==s.glossinessMap.value&&void 0===l.USE_GLOSSINESSMAP&&(l.USE_GLOSSINESSMAP="",l.USE_ROUGHNESSMAP=""),null===s.glossinessMap.value&&void 0!==l.USE_GLOSSINESSMAP&&(delete l.USE_GLOSSINESSMAP,delete l.USE_ROUGHNESSMAP)}}}}function h(e,t,n,i){r.Interpolant.call(this,e,t,n,i)}u.prototype.decodePrimitive=function(e,t){var n=this.json,r=this.dracoLoader,i=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},s={},l={};for(var u in a)u in w&&(o[w[u]]=a[u]);for(u in e.attributes)if(void 0!==w[u]&&void 0!==a[u]){var c=n.accessors[e.attributes[u]],h=y[c.componentType];l[w[u]]=h,s[w[u]]=!0===c.normalized}return t.getDependency("bufferView",i).then(function(e){return new Promise(function(t){r.decodeDracoFile(e,function(e){for(var n in e.attributes){var r=e.attributes[n],i=s[n];void 0!==i&&(r.normalized=i)}t(e)},o,l)})})},h.prototype=Object.create(r.Interpolant.prototype),h.prototype.constructor=h,h.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=e*r*3+r,a=0;a!==r;a++)t[a]=n[i+a];return t},h.prototype.beforeStart_=h.prototype.copySampleValue_,h.prototype.afterEnd_=h.prototype.copySampleValue_,h.prototype.interpolate_=function(e,t,n,r){for(var i=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=2*o,l=3*o,u=r-t,c=(n-t)/u,h=c*c,f=h*c,d=e*l,p=d-l,m=2*f-3*h+1,v=f-2*h+c,g=-2*f+3*h,_=f-h,y=0;y!==o;y++){var A=a[p+y+o],x=a[p+y+s]*u,b=a[d+y+o],w=a[d+y]*u;i[y]=m*A+v*x+g*b+_*w}return i};var f=0,d=1,p=2,m=3,v=4,g=5,_=6,y=(Number,r.Matrix3,r.Matrix4,r.Vector2,r.Vector3,r.Vector4,r.Texture,{5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array}),A={9728:r.NearestFilter,9729:r.LinearFilter,9984:r.NearestMipMapNearestFilter,9985:r.LinearMipMapNearestFilter,9986:r.NearestMipMapLinearFilter,9987:r.LinearMipMapLinearFilter},x={33071:r.ClampToEdgeWrapping,33648:r.MirroredRepeatWrapping,10497:r.RepeatWrapping},b=(r.BackSide,r.FrontSide,r.NeverDepth,r.LessDepth,r.EqualDepth,r.LessEqualDepth,r.GreaterEqualDepth,r.NotEqualDepth,r.GreaterEqualDepth,r.AlwaysDepth,r.AddEquation,r.SubtractEquation,r.ReverseSubtractEquation,r.ZeroFactor,r.OneFactor,r.SrcColorFactor,r.OneMinusSrcColorFactor,r.SrcAlphaFactor,r.OneMinusSrcAlphaFactor,r.DstAlphaFactor,r.OneMinusDstAlphaFactor,r.DstColorFactor,r.OneMinusDstColorFactor,r.SrcAlphaSaturateFactor,{SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16}),w={POSITION:"position",NORMAL:"normal",TEXCOORD_0:"uv",TEXCOORD0:"uv",TEXCOORD:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",COLOR0:"color",COLOR:"color",WEIGHTS_0:"skinWeight",WEIGHT:"skinWeight",JOINTS_0:"skinIndex",JOINT:"skinIndex"},S={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},F={CUBICSPLINE:r.InterpolateSmooth,LINEAR:r.InterpolateLinear,STEP:r.InterpolateDiscrete},T="OPAQUE",E="MASK",L="BLEND",P={"image/png":r.RGBAFormat,"image/jpeg":r.RGBFormat};function I(e,t){return"string"!=typeof e||""===e?"":/^(https?:)?\/\//i.test(e)?e:/^data:.*,.*$/i.test(e)?e:/^blob:.*$/i.test(e)?e:t+e}function M(e,t,n){for(var r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function C(e,t){void 0!==t.extras&&("object"==typeof t.extras?e.userData=t.extras:console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function N(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){var i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(n=0,r=i.length;n<r;n++)e.morphTargetDictionary[i[n]]=n}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function R(e,t){return e.indices===t.indices&&O(e.attributes,t.attributes)}function O(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(var n in e)if(e[n]!==t[n])return!1;return!0}function U(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function k(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];if(R(i.primitive,t))return i.promise}return null}function D(e){if(e.isInterleavedBufferAttribute){for(var t=e.count,n=e.itemSize,i=e.array.slice(0,t*n),a=0;a<t;++a)i[a]=e.getX(a),n>=2&&(i[a+1]=e.getY(a)),n>=3&&(i[a+2]=e.getZ(a)),n>=4&&(i[a+3]=e.getW(a));return new r.BufferAttribute(i,n,e.normalized)}return e.clone()}function B(e,t,n){this.json=e||{},this.extensions=t||{},this.options=n||{},this.cache=new function(){var e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}},this.primitiveCache=[],this.multiplePrimitivesCache=[],this.multiPassGeometryCache=[],this.textureLoader=new r.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new r.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer")}function X(e,t,n){var r=t.attributes;for(var i in r){var a=w[i],o=n[r[i]];a&&(a in e.attributes||e.addAttribute(a,o))}void 0===t.indices||e.index||e.setIndex(n[t.indices]),void 0!==t.targets&&function(e,t,n){for(var r=!1,i=!1,a=0,o=t.length;a<o&&(void 0!==(u=t[a]).POSITION&&(r=!0),void 0!==u.NORMAL&&(i=!0),!r||!i);a++);if(r||i){var s=[],l=[];for(a=0,o=t.length;a<o;a++){var u=t[a],c="morphTarget"+a;if(r){if(void 0!==u.POSITION){var h=D(n[u.POSITION]);h.name=c;for(var f=e.attributes.position,d=0,p=h.count;d<p;d++)h.setXYZ(d,h.getX(d)+f.getX(d),h.getY(d)+f.getY(d),h.getZ(d)+f.getZ(d))}else h=e.attributes.position;s.push(h)}if(i){if(void 0!==u.NORMAL){var m;(m=D(n[u.NORMAL])).name=c;var v=e.attributes.normal;for(d=0,p=m.count;d<p;d++)m.setXYZ(d,m.getX(d)+v.getX(d),m.getY(d)+v.getY(d),m.getZ(d)+v.getZ(d))}else m=e.attributes.normal;l.push(m)}}r&&(e.morphAttributes.position=s),i&&(e.morphAttributes.normal=l)}}(e,t.targets,n),C(e,t)}return B.prototype.parse=function(e,t){var n=this.json;this.cache.removeAll(),this.markDefs(),this.getMultiDependencies(["scene","animation","camera"]).then(function(t){var r=t.scenes||[],i=r[n.scene||0],a=t.animations||[],o=t.cameras||[];e(i,r,o,a,n)}).catch(t)},B.prototype.markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],r={},i={},a=0,o=t.length;a<o;a++)for(var s=t[a].joints,l=0,u=s.length;l<u;l++)e[s[l]].isBone=!0;for(var c=0,h=e.length;c<h;c++){var f=e[c];void 0!==f.mesh&&(void 0===r[f.mesh]&&(r[f.mesh]=i[f.mesh]=0),r[f.mesh]++,void 0!==f.skin&&(n[f.mesh].isSkinnedMesh=!0))}this.json.meshReferences=r,this.json.meshUses=i},B.prototype.getDependency=function(e,t){var n=e+":"+t,r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this.loadMesh(t);break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this.loadBufferView(t);break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this.loadMaterial(t);break;case"texture":r=this.loadTexture(t);break;case"skin":r=this.loadSkin(t);break;case"animation":r=this.loadAnimation(t);break;case"camera":r=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r},B.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var n=this,r=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(r.map(function(t,r){return n.getDependency(e,r)})),this.cache.add(e,t)}return t},B.prototype.getMultiDependencies=function(e){for(var t={},n=[],r=0,i=e.length;r<i;r++){var a=e[r],o=this.getDependencies(a);o=o.then(function(e,n){t[e]=n}.bind(this,a+("mesh"===a?"es":"s"))),n.push(o)}return Promise.all(n).then(function(){return t})},B.prototype.loadBuffer=function(e){var n=this.json.buffers[e],r=this.fileLoader;if(n.type&&"arraybuffer"!==n.type)throw new Error("THREE.GLTFLoader: "+n.type+" buffer type is not supported.");if(void 0===n.uri&&0===e)return Promise.resolve(this.extensions[t.KHR_BINARY_GLTF].body);var i=this.options;return new Promise(function(e,t){r.load(I(n.uri,i.path),e,void 0,function(){t(new Error('THREE.GLTFLoader: Failed to load buffer "'+n.uri+'".'))})})},B.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then(function(e){var n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)})},B.prototype.loadAccessor=function(e){var t=this,n=this.json,i=this.json.accessors[e];if(void 0===i.bufferView&&void 0===i.sparse)return null;var a=[];return void 0!==i.bufferView?a.push(this.getDependency("bufferView",i.bufferView)):a.push(null),void 0!==i.sparse&&(a.push(this.getDependency("bufferView",i.sparse.indices.bufferView)),a.push(this.getDependency("bufferView",i.sparse.values.bufferView))),Promise.all(a).then(function(e){var a,o,s=e[0],l=b[i.type],u=y[i.componentType],c=u.BYTES_PER_ELEMENT,h=c*l,f=i.byteOffset||0,d=void 0!==i.bufferView?n.bufferViews[i.bufferView].byteStride:void 0,p=!0===i.normalized;if(d&&d!==h){var m="InterleavedBuffer:"+i.bufferView+":"+i.componentType,v=t.cache.get(m);v||(a=new u(s),v=new r.InterleavedBuffer(a,d/c),t.cache.add(m,v)),o=new r.InterleavedBufferAttribute(v,l,f/c,p)}else a=null===s?new u(i.count*l):new u(s,f,i.count*l),o=new r.BufferAttribute(a,l,p);if(void 0!==i.sparse){var g=b.SCALAR,_=y[i.sparse.indices.componentType],A=i.sparse.indices.byteOffset||0,x=i.sparse.values.byteOffset||0,w=new _(e[1],A,i.sparse.count*g),S=new u(e[2],x,i.sparse.count*l);null!==s&&o.setArray(o.array.slice());for(var F=0,T=w.length;F<T;F++){var E=w[F];if(o.setX(E,S[F*l]),l>=2&&o.setY(E,S[F*l+1]),l>=3&&o.setZ(E,S[F*l+2]),l>=4&&o.setW(E,S[F*l+3]),l>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return o})},B.prototype.loadTexture=function(e){var n,i=this,a=this.json,o=this.options,s=this.textureLoader,l=window.URL||window.webkitURL,u=a.textures[e],c=u.extensions||{},h=(n=c[t.MSFT_TEXTURE_DDS]?a.images[c[t.MSFT_TEXTURE_DDS].source]:a.images[u.source]).uri,f=!1;return void 0!==n.bufferView&&(h=i.getDependency("bufferView",n.bufferView).then(function(e){f=!0;var t=new Blob([e],{type:n.mimeType});return h=l.createObjectURL(t)})),Promise.resolve(h).then(function(e){var n=r.Loader.Handlers.get(e);return n||(n=c[t.MSFT_TEXTURE_DDS]?i.extensions[t.MSFT_TEXTURE_DDS].ddsLoader:s),new Promise(function(t,r){n.load(I(e,o.path),t,void 0,r)})}).then(function(e){!0===f&&l.revokeObjectURL(h),e.flipY=!1,void 0!==u.name&&(e.name=u.name),n.mimeType in P&&(e.format=P[n.mimeType]);var t=(a.samplers||{})[u.sampler]||{};return e.magFilter=A[t.magFilter]||r.LinearFilter,e.minFilter=A[t.minFilter]||r.LinearMipMapLinearFilter,e.wrapS=x[t.wrapS]||r.RepeatWrapping,e.wrapT=x[t.wrapT]||r.RepeatWrapping,e})},B.prototype.assignTexture=function(e,t,n){return this.getDependency("texture",n).then(function(n){e[t]=n})},B.prototype.loadMaterial=function(e){var n,i=this.json,a=this.extensions,o=i.materials[e],s={},l=o.extensions||{},u=[];if(l[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var c=a[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];n=c.getMaterialType(o),u.push(c.extendParams(s,o,this))}else if(l[t.KHR_MATERIALS_UNLIT]){var h=a[t.KHR_MATERIALS_UNLIT];n=h.getMaterialType(o),u.push(h.extendParams(s,o,this))}else{n=r.MeshStandardMaterial;var f=o.pbrMetallicRoughness||{};if(s.color=new r.Color(1,1,1),s.opacity=1,Array.isArray(f.baseColorFactor)){var d=f.baseColorFactor;s.color.fromArray(d),s.opacity=d[3]}if(void 0!==f.baseColorTexture&&u.push(this.assignTexture(s,"map",f.baseColorTexture.index)),s.metalness=void 0!==f.metallicFactor?f.metallicFactor:1,s.roughness=void 0!==f.roughnessFactor?f.roughnessFactor:1,void 0!==f.metallicRoughnessTexture){var p=f.metallicRoughnessTexture.index;u.push(this.assignTexture(s,"metalnessMap",p)),u.push(this.assignTexture(s,"roughnessMap",p))}}!0===o.doubleSided&&(s.side=r.DoubleSide);var m=o.alphaMode||T;return m===L?s.transparent=!0:(s.transparent=!1,m===E&&(s.alphaTest=void 0!==o.alphaCutoff?o.alphaCutoff:.5)),void 0!==o.normalTexture&&n!==r.MeshBasicMaterial&&(u.push(this.assignTexture(s,"normalMap",o.normalTexture.index)),s.normalScale=new r.Vector2(1,1),void 0!==o.normalTexture.scale&&s.normalScale.set(o.normalTexture.scale,o.normalTexture.scale)),void 0!==o.occlusionTexture&&n!==r.MeshBasicMaterial&&(u.push(this.assignTexture(s,"aoMap",o.occlusionTexture.index)),void 0!==o.occlusionTexture.strength&&(s.aoMapIntensity=o.occlusionTexture.strength)),void 0!==o.emissiveFactor&&n!==r.MeshBasicMaterial&&(s.emissive=(new r.Color).fromArray(o.emissiveFactor)),void 0!==o.emissiveTexture&&n!==r.MeshBasicMaterial&&u.push(this.assignTexture(s,"emissiveMap",o.emissiveTexture.index)),Promise.all(u).then(function(){var e;return e=n===r.ShaderMaterial?a[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(s):new n(s),void 0!==o.name&&(e.name=o.name),e.normalScale&&(e.normalScale.y=-e.normalScale.y),e.map&&(e.map.encoding=r.sRGBEncoding),e.emissiveMap&&(e.emissiveMap.encoding=r.sRGBEncoding),e.specularMap&&(e.specularMap.encoding=r.sRGBEncoding),C(e,o),o.extensions&&M(a,e,o),e})},B.prototype.loadGeometries=function(e){var n,i=this,a=this.extensions,o=this.primitiveCache,s=function(e){if(e.length<2)return!1;var t=e[0],n=t.targets||[];if(void 0===t.indices)return!1;for(var r=1,i=e.length;r<i;r++){var a=e[r];if(t.mode!==a.mode)return!1;if(void 0===a.indices)return!1;if(!O(t.attributes,a.attributes))return!1;var o=a.targets||[];if(n.length!==o.length)return!1;for(var s=0,l=n.length;s<l;s++)if(!O(n[s],o[s]))return!1}return!0}(e);return s&&(n=e,e=[e[0]]),this.getDependencies("accessor").then(function(l){for(var u=[],c=0,h=e.length;c<h;c++){var f=e[c],d=k(o,f);if(d)u.push(d);else if(f.extensions&&f.extensions[t.KHR_DRACO_MESH_COMPRESSION]){var p=a[t.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(f,i).then(function(e){return X(e,f,l),e});o.push({primitive:f,promise:p}),u.push(p)}else{var m=new r.BufferGeometry;X(m,f,l);p=Promise.resolve(m);o.push({primitive:f,promise:p}),u.push(p)}}return Promise.all(u).then(function(t){if(s){var a=t[0];if(null!==(_=function(e,t,n){for(var r=0,i=e.length;r<i;r++){var a=e[r];if(t===a.baseGeometry&&U(n,a.primitives))return a.geometry}return null}(g=i.multiPassGeometryCache,a,n)))return[_.geometry];var o=new r.BufferGeometry;for(var u in o.name=a.name,o.userData=a.userData,a.attributes)o.addAttribute(u,a.attributes[u]);for(var u in a.morphAttributes)o.morphAttributes[u]=a.morphAttributes[u];for(var c=[],h=0,f=0,d=n.length;f<d;f++){for(var p=l[n[f].indices],m=0,v=p.count;m<v;m++)c.push(p.array[m]);o.addGroup(h,p.count,f),h+=p.count}return o.setIndex(c),g.push({geometry:o,baseGeometry:a,primitives:n}),[o]}if(t.length>1&&void 0!==r.BufferGeometryUtils){for(f=1,d=e.length;f<d;f++)if(e[0].mode!==e[f].mode)return t;var g,_;if(_=function(e,t){for(var n=0,r=e.length;n<r;n++){var i=e[n];if(U(t,i.baseGeometries))return i.geometry}return null}(g=i.multiplePrimitivesCache,t)){if(null!==_.geometry)return[_.geometry]}else{o=r.BufferGeometryUtils.mergeBufferGeometries(t,!0);if(g.push({geometry:o,baseGeometries:t}),null!==o)return[o]}}return t})})},B.prototype.loadMesh=function(e){var n=this,i=this.json,a=this.extensions,o=i.meshes[e];return this.getMultiDependencies(["accessor","material"]).then(function(i){for(var s=o.primitives,l=[],u=0,c=s.length;u<c;u++)l[u]=void 0===s[u].material?new r.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:r.FrontSide}):i.materials[s[u].material];return n.loadGeometries(s).then(function(i){for(var u=1===i.length&&i[0].groups.length>0,c=[],h=0,y=i.length;h<y;h++){var A,x=i[h],b=s[h],w=u?l:l[h];if(b.mode===v||b.mode===g||b.mode===_||void 0===b.mode)A=!0===o.isSkinnedMesh?new r.SkinnedMesh(x,w):new r.Mesh(x,w),b.mode===g?A.drawMode=r.TriangleStripDrawMode:b.mode===_&&(A.drawMode=r.TriangleFanDrawMode);else if(b.mode===d)A=new r.LineSegments(x,w);else if(b.mode===m)A=new r.Line(x,w);else if(b.mode===p)A=new r.LineLoop(x,w);else{if(b.mode!==f)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+b.mode);A=new r.Points(x,w)}Object.keys(A.geometry.morphAttributes).length>0&&N(A,o),A.name=o.name||"mesh_"+e,i.length>1&&(A.name+="_"+h),C(A,o),c.push(A);for(var S=u?A.material:[A.material],F=void 0!==x.attributes.color,T=void 0===x.attributes.normal,E=!0===A.isSkinnedMesh,L=Object.keys(x.morphAttributes).length>0,P=L&&void 0!==x.morphAttributes.normal,I=0,M=S.length;I<M;I++){w=S[I];if(A.isPoints){var R="PointsMaterial:"+w.uuid,O=n.cache.get(R);O||(O=new r.PointsMaterial,r.Material.prototype.copy.call(O,w),O.color.copy(w.color),O.map=w.map,O.lights=!1,n.cache.add(R,O)),w=O}else if(A.isLine){R="LineBasicMaterial:"+w.uuid;var U=n.cache.get(R);U||(U=new r.LineBasicMaterial,r.Material.prototype.copy.call(U,w),U.color.copy(w.color),U.lights=!1,n.cache.add(R,U)),w=U}if(F||T||E||L){R="ClonedMaterial:"+w.uuid+":";w.isGLTFSpecularGlossinessMaterial&&(R+="specular-glossiness:"),E&&(R+="skinning:"),F&&(R+="vertex-colors:"),T&&(R+="flat-shading:"),L&&(R+="morph-targets:"),P&&(R+="morph-normals:");var k=n.cache.get(R);k||(k=w.isGLTFSpecularGlossinessMaterial?a[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(w):w.clone(),E&&(k.skinning=!0),F&&(k.vertexColors=r.VertexColors),T&&(k.flatShading=!0),L&&(k.morphTargets=!0),P&&(k.morphNormals=!0),n.cache.add(R,k)),w=k}S[I]=w,w.aoMap&&void 0===x.attributes.uv2&&void 0!==x.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),x.addAttribute("uv2",new r.BufferAttribute(x.attributes.uv.array,2))),w.isGLTFSpecularGlossinessMaterial&&(A.onBeforeRender=a[t.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms)}A.material=u?S:S[0]}if(1===c.length)return c[0];var D=new r.Group;for(h=0,y=c.length;h<y;h++)D.add(c[h]);return D})})},B.prototype.loadCamera=function(e){var t,n=this.json.cameras[e],i=n[n.type];if(i)return"perspective"===n.type?t=new r.PerspectiveCamera(r.Math.radToDeg(i.yfov),i.aspectRatio||1,i.znear||1,i.zfar||2e6):"orthographic"===n.type&&(t=new r.OrthographicCamera(i.xmag/-2,i.xmag/2,i.ymag/2,i.ymag/-2,i.znear,i.zfar)),void 0!==n.name&&(t.name=n.name),C(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},B.prototype.loadSkin=function(e){var t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then(function(e){return n.inverseBindMatrices=e,n})},B.prototype.loadAnimation=function(e){var t=this.json.animations[e];return this.getMultiDependencies(["accessor","node"]).then(function(n){for(var i=[],a=0,o=t.channels.length;a<o;a++){var s=t.channels[a],l=t.samplers[s.sampler];if(l){var u=s.target,c=void 0!==u.node?u.node:u.id,f=void 0!==t.parameters?t.parameters[l.input]:l.input,d=void 0!==t.parameters?t.parameters[l.output]:l.output,p=n.accessors[f],m=n.accessors[d],v=n.nodes[c];if(v){var g;switch(v.updateMatrix(),v.matrixAutoUpdate=!0,S[u.path]){case S.weights:g=r.NumberKeyframeTrack;break;case S.rotation:g=r.QuaternionKeyframeTrack;break;case S.position:case S.scale:default:g=r.VectorKeyframeTrack}var _=v.name?v.name:v.uuid,y=void 0!==l.interpolation?F[l.interpolation]:r.InterpolateLinear,A=[];S[u.path]===S.weights?v.traverse(function(e){!0===e.isMesh&&e.morphTargetInfluences&&A.push(e.name?e.name:e.uuid)}):A.push(_);for(var x=0,b=A.length;x<b;x++){var w=new g(A[x]+"."+S[u.path],r.AnimationUtils.arraySlice(p.array,0),r.AnimationUtils.arraySlice(m.array,0),y);"CUBICSPLINE"===l.interpolation&&(w.createInterpolant=function(e){return new h(this.times,this.values,this.getValueSize()/3,e)},w.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),i.push(w)}}}}c=void 0!==t.name?t.name:"animation_"+e;return new r.AnimationClip(c,void 0,i)})},B.prototype.loadNode=function(e){var n=this.json,i=this.extensions,a=n.meshReferences,o=n.meshUses,s=n.nodes[e];return this.getMultiDependencies(["mesh","skin","camera","light"]).then(function(e){var n;if(!0===s.isBone)n=new r.Bone;else if(void 0!==s.mesh){var l=e.meshes[s.mesh];if(a[s.mesh]>1){var u=o[s.mesh]++;(n=l.clone()).name+="_instance_"+u,n.onBeforeRender=l.onBeforeRender;for(var c=0,h=n.children.length;c<h;c++)n.children[c].name+="_instance_"+u,n.children[c].onBeforeRender=l.children[c].onBeforeRender}else n=l}else if(void 0!==s.camera)n=e.cameras[s.camera];else if(s.extensions&&s.extensions[t.KHR_LIGHTS_PUNCTUAL]&&void 0!==s.extensions[t.KHR_LIGHTS_PUNCTUAL].light){n=i[t.KHR_LIGHTS_PUNCTUAL].lights[s.extensions[t.KHR_LIGHTS_PUNCTUAL].light]}else n=new r.Object3D;if(void 0!==s.name&&(n.name=r.PropertyBinding.sanitizeNodeName(s.name)),C(n,s),s.extensions&&M(i,n,s),void 0!==s.matrix){var f=new r.Matrix4;f.fromArray(s.matrix),n.applyMatrix(f)}else void 0!==s.translation&&n.position.fromArray(s.translation),void 0!==s.rotation&&n.quaternion.fromArray(s.rotation),void 0!==s.scale&&n.scale.fromArray(s.scale);return n})},B.prototype.loadScene=function(){function e(t,n,i,a,o){var s=a[t],l=i.nodes[t];if(void 0!==l.skin)for(var u=!0===s.isGroup?s.children:[s],c=0,h=u.length;c<h;c++){for(var f=u[c],d=o[l.skin],p=[],m=[],v=0,g=d.joints.length;v<g;v++){var _=d.joints[v],y=a[_];if(y){p.push(y);var A=new r.Matrix4;void 0!==d.inverseBindMatrices&&A.fromArray(d.inverseBindMatrices.array,16*v),m.push(A)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',_)}f.bind(new r.Skeleton(p,m),f.matrixWorld)}if(n.add(s),l.children){var x=l.children;for(c=0,h=x.length;c<h;c++){e(x[c],s,i,a,o)}}}return function(t){var n=this.json,i=this.extensions,a=this.json.scenes[t];return this.getMultiDependencies(["node","skin"]).then(function(t){var o=new r.Scene;void 0!==a.name&&(o.name=a.name),C(o,a),a.extensions&&M(i,o,a);for(var s=a.nodes||[],l=0,u=s.length;l<u;l++)e(s[l],o,n,t.nodes,t.skins);return o})}}(),e}();e.exports=i},function(e,t,n){e.exports=function(){"use strict";function e(e,t){var n=e.__state.conversionName.toString(),r=Math.round(e.r),i=Math.round(e.g),a=Math.round(e.b),o=e.a,s=Math.round(e.h),l=e.s.toFixed(1),u=e.v.toFixed(1);if(t||"THREE_CHAR_HEX"===n||"SIX_CHAR_HEX"===n){for(var c=e.hex.toString(16);c.length<6;)c="0"+c;return"#"+c}return"CSS_RGB"===n?"rgb("+r+","+i+","+a+")":"CSS_RGBA"===n?"rgba("+r+","+i+","+a+","+o+")":"HEX"===n?"0x"+e.hex.toString(16):"RGB_ARRAY"===n?"["+r+","+i+","+a+"]":"RGBA_ARRAY"===n?"["+r+","+i+","+a+","+o+"]":"RGB_OBJ"===n?"{r:"+r+",g:"+i+",b:"+a+"}":"RGBA_OBJ"===n?"{r:"+r+",g:"+i+",b:"+a+",a:"+o+"}":"HSV_OBJ"===n?"{h:"+s+",s:"+l+",v:"+u+"}":"HSVA_OBJ"===n?"{h:"+s+",s:"+l+",v:"+u+",a:"+o+"}":"unknown format"}var t=Array.prototype.forEach,n=Array.prototype.slice,r={BREAK:{},extend:function(e){return this.each(n.call(arguments,1),function(t){var n=this.isObject(t)?Object.keys(t):[];n.forEach(function(n){this.isUndefined(t[n])||(e[n]=t[n])}.bind(this))},this),e},defaults:function(e){return this.each(n.call(arguments,1),function(t){var n=this.isObject(t)?Object.keys(t):[];n.forEach(function(n){this.isUndefined(e[n])&&(e[n]=t[n])}.bind(this))},this),e},compose:function(){var e=n.call(arguments);return function(){for(var t=n.call(arguments),r=e.length-1;r>=0;r--)t=[e[r].apply(this,t)];return t[0]}},each:function(e,n,r){if(e)if(t&&e.forEach&&e.forEach===t)e.forEach(n,r);else if(e.length===e.length+0){var i=void 0,a=void 0;for(i=0,a=e.length;i<a;i++)if(i in e&&n.call(r,e[i],i)===this.BREAK)return}else for(var o in e)if(n.call(r,e[o],o)===this.BREAK)return},defer:function(e){setTimeout(e,0)},debounce:function(e,t,n){var r=void 0;return function(){var i=this,a=arguments,o=n||!r;clearTimeout(r),r=setTimeout(function(){r=null,n||e.apply(i,a)},t),o&&e.apply(i,a)}},toArray:function(e){return e.toArray?e.toArray():n.call(e)},isUndefined:function(e){return void 0===e},isNull:function(e){return null===e},isNaN:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){return isNaN(e)}),isArray:Array.isArray||function(e){return e.constructor===Array},isObject:function(e){return e===Object(e)},isNumber:function(e){return e===e+0},isString:function(e){return e===e+""},isBoolean:function(e){return!1===e||!0===e},isFunction:function(e){return"[object Function]"===Object.prototype.toString.call(e)}},i=[{litmus:r.isString,conversions:{THREE_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9])([A-F0-9])([A-F0-9])$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString()+t[1].toString()+t[2].toString()+t[2].toString()+t[3].toString()+t[3].toString(),0)}},write:e},SIX_CHAR_HEX:{read:function(e){var t=e.match(/^#([A-F0-9]{6})$/i);return null!==t&&{space:"HEX",hex:parseInt("0x"+t[1].toString(),0)}},write:e},CSS_RGB:{read:function(e){var t=e.match(/^rgb\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3])}},write:e},CSS_RGBA:{read:function(e){var t=e.match(/^rgba\(\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*,\s*(.+)\s*\)/);return null!==t&&{space:"RGB",r:parseFloat(t[1]),g:parseFloat(t[2]),b:parseFloat(t[3]),a:parseFloat(t[4])}},write:e}}},{litmus:r.isNumber,conversions:{HEX:{read:function(e){return{space:"HEX",hex:e,conversionName:"HEX"}},write:function(e){return e.hex}}}},{litmus:r.isArray,conversions:{RGB_ARRAY:{read:function(e){return 3===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2]}},write:function(e){return[e.r,e.g,e.b]}},RGBA_ARRAY:{read:function(e){return 4===e.length&&{space:"RGB",r:e[0],g:e[1],b:e[2],a:e[3]}},write:function(e){return[e.r,e.g,e.b,e.a]}}}},{litmus:r.isObject,conversions:{RGBA_OBJ:{read:function(e){return!!(r.isNumber(e.r)&&r.isNumber(e.g)&&r.isNumber(e.b)&&r.isNumber(e.a))&&{space:"RGB",r:e.r,g:e.g,b:e.b,a:e.a}},write:function(e){return{r:e.r,g:e.g,b:e.b,a:e.a}}},RGB_OBJ:{read:function(e){return!!(r.isNumber(e.r)&&r.isNumber(e.g)&&r.isNumber(e.b))&&{space:"RGB",r:e.r,g:e.g,b:e.b}},write:function(e){return{r:e.r,g:e.g,b:e.b}}},HSVA_OBJ:{read:function(e){return!!(r.isNumber(e.h)&&r.isNumber(e.s)&&r.isNumber(e.v)&&r.isNumber(e.a))&&{space:"HSV",h:e.h,s:e.s,v:e.v,a:e.a}},write:function(e){return{h:e.h,s:e.s,v:e.v,a:e.a}}},HSV_OBJ:{read:function(e){return!!(r.isNumber(e.h)&&r.isNumber(e.s)&&r.isNumber(e.v))&&{space:"HSV",h:e.h,s:e.s,v:e.v}},write:function(e){return{h:e.h,s:e.s,v:e.v}}}}}],a=void 0,o=void 0,s=function(){o=!1;var e=arguments.length>1?r.toArray(arguments):arguments[0];return r.each(i,function(t){if(t.litmus(e))return r.each(t.conversions,function(t,n){if(a=t.read(e),!1===o&&!1!==a)return o=a,a.conversionName=n,a.conversion=t,r.BREAK}),r.BREAK}),o},l=void 0,u={hsv_to_rgb:function(e,t,n){var r=Math.floor(e/60)%6,i=e/60-Math.floor(e/60),a=n*(1-t),o=n*(1-i*t),s=n*(1-(1-i)*t),l=[[n,s,a],[o,n,a],[a,n,s],[a,o,n],[s,a,n],[n,a,o]][r];return{r:255*l[0],g:255*l[1],b:255*l[2]}},rgb_to_hsv:function(e,t,n){var r=Math.min(e,t,n),i=Math.max(e,t,n),a=i-r,o=void 0;return 0===i?{h:NaN,s:0,v:0}:(o=e===i?(t-n)/a:t===i?2+(n-e)/a:4+(e-t)/a,(o/=6)<0&&(o+=1),{h:360*o,s:a/i,v:i/255})},rgb_to_hex:function(e,t,n){var r=this.hex_with_component(0,2,e);return r=this.hex_with_component(r,1,t),r=this.hex_with_component(r,0,n)},component_from_hex:function(e,t){return e>>8*t&255},hex_with_component:function(e,t,n){return n<<(l=8*t)|e&~(255<<l)}},c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},f=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),d=function e(t,n,r){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,n);if(void 0===i){var a=Object.getPrototypeOf(t);return null===a?void 0:e(a,n,r)}if("value"in i)return i.value;var o=i.get;return void 0!==o?o.call(r):void 0},p=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},m=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},v=function(){function t(){if(h(this,t),this.__state=s.apply(this,arguments),!1===this.__state)throw new Error("Failed to interpret color arguments");this.__state.a=this.__state.a||1}return f(t,[{key:"toString",value:function(){return e(this)}},{key:"toHexString",value:function(){return e(this,!0)}},{key:"toOriginal",value:function(){return this.__state.conversion.write(this)}}]),t}();function g(e,t,n){Object.defineProperty(e,t,{get:function(){return"RGB"===this.__state.space?this.__state[t]:(v.recalculateRGB(this,t,n),this.__state[t])},set:function(e){"RGB"!==this.__state.space&&(v.recalculateRGB(this,t,n),this.__state.space="RGB"),this.__state[t]=e}})}function _(e,t){Object.defineProperty(e,t,{get:function(){return"HSV"===this.__state.space?this.__state[t]:(v.recalculateHSV(this),this.__state[t])},set:function(e){"HSV"!==this.__state.space&&(v.recalculateHSV(this),this.__state.space="HSV"),this.__state[t]=e}})}v.recalculateRGB=function(e,t,n){if("HEX"===e.__state.space)e.__state[t]=u.component_from_hex(e.__state.hex,n);else{if("HSV"!==e.__state.space)throw new Error("Corrupted color state");r.extend(e.__state,u.hsv_to_rgb(e.__state.h,e.__state.s,e.__state.v))}},v.recalculateHSV=function(e){var t=u.rgb_to_hsv(e.r,e.g,e.b);r.extend(e.__state,{s:t.s,v:t.v}),r.isNaN(t.h)?r.isUndefined(e.__state.h)&&(e.__state.h=0):e.__state.h=t.h},v.COMPONENTS=["r","g","b","h","s","v","hex","a"],g(v.prototype,"r",2),g(v.prototype,"g",1),g(v.prototype,"b",0),_(v.prototype,"h"),_(v.prototype,"s"),_(v.prototype,"v"),Object.defineProperty(v.prototype,"a",{get:function(){return this.__state.a},set:function(e){this.__state.a=e}}),Object.defineProperty(v.prototype,"hex",{get:function(){return"HEX"!==!this.__state.space&&(this.__state.hex=u.rgb_to_hex(this.r,this.g,this.b)),this.__state.hex},set:function(e){this.__state.space="HEX",this.__state.hex=e}});var y=function(){function e(t,n){h(this,e),this.initialValue=t[n],this.domElement=document.createElement("div"),this.object=t,this.property=n,this.__onChange=void 0,this.__onFinishChange=void 0}return f(e,[{key:"onChange",value:function(e){return this.__onChange=e,this}},{key:"onFinishChange",value:function(e){return this.__onFinishChange=e,this}},{key:"setValue",value:function(e){return this.object[this.property]=e,this.__onChange&&this.__onChange.call(this,e),this.updateDisplay(),this}},{key:"getValue",value:function(){return this.object[this.property]}},{key:"updateDisplay",value:function(){return this}},{key:"isModified",value:function(){return this.initialValue!==this.getValue()}}]),e}(),A={};r.each({HTMLEvents:["change"],MouseEvents:["click","mousemove","mousedown","mouseup","mouseover"],KeyboardEvents:["keydown"]},function(e,t){r.each(e,function(e){A[e]=t})});var x=/(\d+(\.\d+)?)px/;function b(e){if("0"===e||r.isUndefined(e))return 0;var t=e.match(x);return r.isNull(t)?0:parseFloat(t[1])}var w={makeSelectable:function(e,t){void 0!==e&&void 0!==e.style&&(e.onselectstart=t?function(){return!1}:function(){},e.style.MozUserSelect=t?"auto":"none",e.style.KhtmlUserSelect=t?"auto":"none",e.unselectable=t?"on":"off")},makeFullscreen:function(e,t,n){var i=n,a=t;r.isUndefined(a)&&(a=!0),r.isUndefined(i)&&(i=!0),e.style.position="absolute",a&&(e.style.left=0,e.style.right=0),i&&(e.style.top=0,e.style.bottom=0)},fakeEvent:function(e,t,n,i){var a=n||{},o=A[t];if(!o)throw new Error("Event type "+t+" not supported.");var s=document.createEvent(o);switch(o){case"MouseEvents":var l=a.x||a.clientX||0,u=a.y||a.clientY||0;s.initMouseEvent(t,a.bubbles||!1,a.cancelable||!0,window,a.clickCount||1,0,0,l,u,!1,!1,!1,!1,0,null);break;case"KeyboardEvents":var c=s.initKeyboardEvent||s.initKeyEvent;r.defaults(a,{cancelable:!0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,keyCode:void 0,charCode:void 0}),c(t,a.bubbles||!1,a.cancelable,window,a.ctrlKey,a.altKey,a.shiftKey,a.metaKey,a.keyCode,a.charCode);break;default:s.initEvent(t,a.bubbles||!1,a.cancelable||!0)}r.defaults(s,i),e.dispatchEvent(s)},bind:function(e,t,n,r){var i=r||!1;return e.addEventListener?e.addEventListener(t,n,i):e.attachEvent&&e.attachEvent("on"+t,n),w},unbind:function(e,t,n,r){var i=r||!1;return e.removeEventListener?e.removeEventListener(t,n,i):e.detachEvent&&e.detachEvent("on"+t,n),w},addClass:function(e,t){if(void 0===e.className)e.className=t;else if(e.className!==t){var n=e.className.split(/ +/);-1===n.indexOf(t)&&(n.push(t),e.className=n.join(" ").replace(/^\s+/,"").replace(/\s+$/,""))}return w},removeClass:function(e,t){if(t)if(e.className===t)e.removeAttribute("class");else{var n=e.className.split(/ +/),r=n.indexOf(t);-1!==r&&(n.splice(r,1),e.className=n.join(" "))}else e.className=void 0;return w},hasClass:function(e,t){return new RegExp("(?:^|\\s+)"+t+"(?:\\s+|$)").test(e.className)||!1},getWidth:function(e){var t=getComputedStyle(e);return b(t["border-left-width"])+b(t["border-right-width"])+b(t["padding-left"])+b(t["padding-right"])+b(t.width)},getHeight:function(e){var t=getComputedStyle(e);return b(t["border-top-width"])+b(t["border-bottom-width"])+b(t["padding-top"])+b(t["padding-bottom"])+b(t.height)},getOffset:function(e){var t=e,n={left:0,top:0};if(t.offsetParent)do{n.left+=t.offsetLeft,n.top+=t.offsetTop,t=t.offsetParent}while(t);return n},isActive:function(e){return e===document.activeElement&&(e.type||e.href)}},S=function(e){function t(e,n){h(this,t);var r=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),i=r;return r.__prev=r.getValue(),r.__checkbox=document.createElement("input"),r.__checkbox.setAttribute("type","checkbox"),w.bind(r.__checkbox,"change",function(){i.setValue(!i.__prev)},!1),r.domElement.appendChild(r.__checkbox),r.updateDisplay(),r}return p(t,e),f(t,[{key:"setValue",value:function(e){var n=d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),this.__prev=this.getValue(),n}},{key:"updateDisplay",value:function(){return!0===this.getValue()?(this.__checkbox.setAttribute("checked","checked"),this.__checkbox.checked=!0,this.__prev=!0):(this.__checkbox.checked=!1,this.__prev=!1),d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(y),F=function(e){function t(e,n,i){h(this,t);var a=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=i,s=a;if(a.__select=document.createElement("select"),r.isArray(o)){var l={};r.each(o,function(e){l[e]=e}),o=l}return r.each(o,function(e,t){var n=document.createElement("option");n.innerHTML=t,n.setAttribute("value",e),s.__select.appendChild(n)}),a.updateDisplay(),w.bind(a.__select,"change",function(){var e=this.options[this.selectedIndex].value;s.setValue(e)}),a.domElement.appendChild(a.__select),a}return p(t,e),f(t,[{key:"setValue",value:function(e){var n=d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,e);return this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue()),n}},{key:"updateDisplay",value:function(){return w.isActive(this.__select)?this:(this.__select.value=this.getValue(),d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this))}}]),t}(y),T=function(e){function t(e,n){h(this,t);var r=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),i=r;function a(){i.setValue(i.__input.value)}return r.__input=document.createElement("input"),r.__input.setAttribute("type","text"),w.bind(r.__input,"keyup",a),w.bind(r.__input,"change",a),w.bind(r.__input,"blur",function(){i.__onFinishChange&&i.__onFinishChange.call(i,i.getValue())}),w.bind(r.__input,"keydown",function(e){13===e.keyCode&&this.blur()}),r.updateDisplay(),r.domElement.appendChild(r.__input),r}return p(t,e),f(t,[{key:"updateDisplay",value:function(){return w.isActive(this.__input)||(this.__input.value=this.getValue()),d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(y);function E(e){var t=e.toString();return t.indexOf(".")>-1?t.length-t.indexOf(".")-1:0}var L=function(e){function t(e,n,i){h(this,t);var a=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),o=i||{};return a.__min=o.min,a.__max=o.max,a.__step=o.step,r.isUndefined(a.__step)?0===a.initialValue?a.__impliedStep=1:a.__impliedStep=Math.pow(10,Math.floor(Math.log(Math.abs(a.initialValue))/Math.LN10))/10:a.__impliedStep=a.__step,a.__precision=E(a.__impliedStep),a}return p(t,e),f(t,[{key:"setValue",value:function(e){var n=e;return void 0!==this.__min&&n<this.__min?n=this.__min:void 0!==this.__max&&n>this.__max&&(n=this.__max),void 0!==this.__step&&n%this.__step!=0&&(n=Math.round(n/this.__step)*this.__step),d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"setValue",this).call(this,n)}},{key:"min",value:function(e){return this.__min=e,this}},{key:"max",value:function(e){return this.__max=e,this}},{key:"step",value:function(e){return this.__step=e,this.__impliedStep=e,this.__precision=E(e),this}}]),t}(y),P=function(e){function t(e,n,i){h(this,t);var a=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i));a.__truncationSuspended=!1;var o=a,s=void 0;function l(){o.__onFinishChange&&o.__onFinishChange.call(o,o.getValue())}function u(e){var t=s-e.clientY;o.setValue(o.getValue()+t*o.__impliedStep),s=e.clientY}function c(){w.unbind(window,"mousemove",u),w.unbind(window,"mouseup",c),l()}return a.__input=document.createElement("input"),a.__input.setAttribute("type","text"),w.bind(a.__input,"change",function(){var e=parseFloat(o.__input.value);r.isNaN(e)||o.setValue(e)}),w.bind(a.__input,"blur",function(){l()}),w.bind(a.__input,"mousedown",function(e){w.bind(window,"mousemove",u),w.bind(window,"mouseup",c),s=e.clientY}),w.bind(a.__input,"keydown",function(e){13===e.keyCode&&(o.__truncationSuspended=!0,this.blur(),o.__truncationSuspended=!1,l())}),a.updateDisplay(),a.domElement.appendChild(a.__input),a}return p(t,e),f(t,[{key:"updateDisplay",value:function(){return this.__input.value=this.__truncationSuspended?this.getValue():function(e,t){var n=Math.pow(10,t);return Math.round(e*n)/n}(this.getValue(),this.__precision),d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(L);function I(e,t,n,r,i){return r+(e-t)/(n-t)*(i-r)}var M=function(e){function t(e,n,r,i,a){h(this,t);var o=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,{min:r,max:i,step:a})),s=o;function l(e){e.preventDefault();var t=s.__background.getBoundingClientRect();return s.setValue(I(e.clientX,t.left,t.right,s.__min,s.__max)),!1}function u(){w.unbind(window,"mousemove",l),w.unbind(window,"mouseup",u),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}function c(e){var t=e.touches[0].clientX,n=s.__background.getBoundingClientRect();s.setValue(I(t,n.left,n.right,s.__min,s.__max))}function f(){w.unbind(window,"touchmove",c),w.unbind(window,"touchend",f),s.__onFinishChange&&s.__onFinishChange.call(s,s.getValue())}return o.__background=document.createElement("div"),o.__foreground=document.createElement("div"),w.bind(o.__background,"mousedown",function(e){document.activeElement.blur(),w.bind(window,"mousemove",l),w.bind(window,"mouseup",u),l(e)}),w.bind(o.__background,"touchstart",function(e){1===e.touches.length&&(w.bind(window,"touchmove",c),w.bind(window,"touchend",f),c(e))}),w.addClass(o.__background,"slider"),w.addClass(o.__foreground,"slider-fg"),o.updateDisplay(),o.__background.appendChild(o.__foreground),o.domElement.appendChild(o.__background),o}return p(t,e),f(t,[{key:"updateDisplay",value:function(){var e=(this.getValue()-this.__min)/(this.__max-this.__min);return this.__foreground.style.width=100*e+"%",d(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"updateDisplay",this).call(this)}}]),t}(L),C=function(e){function t(e,n,r){h(this,t);var i=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n)),a=i;return i.__button=document.createElement("div"),i.__button.innerHTML=void 0===r?"Fire":r,w.bind(i.__button,"click",function(e){return e.preventDefault(),a.fire(),!1}),w.addClass(i.__button,"button"),i.domElement.appendChild(i.__button),i}return p(t,e),f(t,[{key:"fire",value:function(){this.__onChange&&this.__onChange.call(this),this.getValue().call(this.object),this.__onFinishChange&&this.__onFinishChange.call(this,this.getValue())}}]),t}(y),N=function(e){function t(e,n){h(this,t);var i=m(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));i.__color=new v(i.getValue()),i.__temp=new v(0);var a=i;i.domElement=document.createElement("div"),w.makeSelectable(i.domElement,!1),i.__selector=document.createElement("div"),i.__selector.className="selector",i.__saturation_field=document.createElement("div"),i.__saturation_field.className="saturation-field",i.__field_knob=document.createElement("div"),i.__field_knob.className="field-knob",i.__field_knob_border="2px solid ",i.__hue_knob=document.createElement("div"),i.__hue_knob.className="hue-knob",i.__hue_field=document.createElement("div"),i.__hue_field.className="hue-field",i.__input=document.createElement("input"),i.__input.type="text",i.__input_textShadow="0 1px 1px ",w.bind(i.__input,"keydown",function(e){13===e.keyCode&&d.call(this)}),w.bind(i.__input,"blur",d),w.bind(i.__selector,"mousedown",function(){w.addClass(this,"drag").bind(window,"mouseup",function(){w.removeClass(a.__selector,"drag")})}),w.bind(i.__selector,"touchstart",function(){w.addClass(this,"drag").bind(window,"touchend",function(){w.removeClass(a.__selector,"drag")})});var o=document.createElement("div");function l(e){g(e),w.bind(window,"mousemove",g),w.bind(window,"touchmove",g),w.bind(window,"mouseup",c),w.bind(window,"touchend",c)}function u(e){_(e),w.bind(window,"mousemove",_),w.bind(window,"touchmove",_),w.bind(window,"mouseup",f),w.bind(window,"touchend",f)}function c(){w.unbind(window,"mousemove",g),w.unbind(window,"touchmove",g),w.unbind(window,"mouseup",c),w.unbind(window,"touchend",c),p()}function f(){w.unbind(window,"mousemove",_),w.unbind(window,"touchmove",_),w.unbind(window,"mouseup",f),w.unbind(window,"touchend",f),p()}function d(){var e=s(this.value);!1!==e?(a.__color.__state=e,a.setValue(a.__color.toOriginal())):this.value=a.__color.toString()}function p(){a.__onFinishChange&&a.__onFinishChange.call(a,a.__color.toOriginal())}function g(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=a.__saturation_field.getBoundingClientRect(),n=e.touches&&e.touches[0]||e,r=n.clientX,i=n.clientY,o=(r-t.left)/(t.right-t.left),s=1-(i-t.top)/(t.bottom-t.top);return s>1?s=1:s<0&&(s=0),o>1?o=1:o<0&&(o=0),a.__color.v=s,a.__color.s=o,a.setValue(a.__color.toOriginal()),!1}function _(e){-1===e.type.indexOf("touch")&&e.preventDefault();var t=a.__hue_field.getBoundingClientRect(),n=e.touches&&e.touches[0]||e,r=n.clientY,i=1-(r-t.top)/(t.bottom-t.top);return i>1?i=1:i<0&&(i=0),a.__color.h=360*i,a.setValue(a.__color.toOriginal()),!1}return r.extend(i.__selector.style,{width:"122px",height:"102px",padding:"3px",backgroundColor:"#222",boxShadow:"0px 1px 3px rgba(0,0,0,0.3)"}),r.extend(i.__field_knob.style,{position:"absolute",width:"12px",height:"12px",border:i.__field_knob_border+(i.__color.v<.5?"#fff":"#000"),boxShadow:"0px 1px 3px rgba(0,0,0,0.5)",borderRadius:"12px",zIndex:1}),r.extend(i.__hue_knob.style,{position:"absolute",width:"15px",height:"2px",borderRight:"4px solid #fff",zIndex:1}),r.extend(i.__saturation_field.style,{width:"100px",height:"100px",border:"1px solid #555",marginRight:"3px",display:"inline-block",cursor:"pointer"}),r.extend(o.style,{width:"100%",height:"100%",background:"none"}),O(o,"top","rgba(0,0,0,0)","#000"),r.extend(i.__hue_field.style,{width:"15px",height:"100px",border:"1px solid #555",cursor:"ns-resize",position:"absolute",top:"3px",right:"3px"}),function(e){e.style.background="",e.style.cssText+="background: -moz-linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);",e.style.cssText+="background: -webkit-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -o-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: -ms-linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);",e.style.cssText+="background: linear-gradient(top,  #ff0000 0%,#ff00ff 17%,#0000ff 34%,#00ffff 50%,#00ff00 67%,#ffff00 84%,#ff0000 100%);"}(i.__hue_field),r.extend(i.__input.style,{outline:"none",textAlign:"center",color:"#fff",border:0,fontWeight:"bold",textShadow:i.__input_textShadow+"rgba(0,0,0,0.7)"}),w.bind(i.__saturation_field,"mousedown",l),w.bind(i.__saturation_field,"touchstart",l),w.bind(i.__field_knob,"mousedown",l),w.bind(i.__field_knob,"touchstart",l),w.bind(i.__hue_field,"mousedown",u),w.bind(i.__hue_field,"touchstart",u),i.__saturation_field.appendChild(o),i.__selector.appendChild(i.__field_knob),i.__selector.appendChild(i.__saturation_field),i.__selector.appendChild(i.__hue_field),i.__hue_field.appendChild(i.__hue_knob),i.domElement.appendChild(i.__input),i.domElement.appendChild(i.__selector),i.updateDisplay(),i}return p(t,e),f(t,[{key:"updateDisplay",value:function(){var e=s(this.getValue());if(!1!==e){var t=!1;r.each(v.COMPONENTS,function(n){if(!r.isUndefined(e[n])&&!r.isUndefined(this.__color.__state[n])&&e[n]!==this.__color.__state[n])return t=!0,{}},this),t&&r.extend(this.__color.__state,e)}r.extend(this.__temp.__state,this.__color.__state),this.__temp.a=1;var n=this.__color.v<.5||this.__color.s>.5?255:0,i=255-n;r.extend(this.__field_knob.style,{marginLeft:100*this.__color.s-7+"px",marginTop:100*(1-this.__color.v)-7+"px",backgroundColor:this.__temp.toHexString(),border:this.__field_knob_border+"rgb("+n+","+n+","+n+")"}),this.__hue_knob.style.marginTop=100*(1-this.__color.h/360)+"px",this.__temp.s=1,this.__temp.v=1,O(this.__saturation_field,"left","#fff",this.__temp.toHexString()),this.__input.value=this.__color.toString(),r.extend(this.__input.style,{backgroundColor:this.__color.toHexString(),color:"rgb("+n+","+n+","+n+")",textShadow:this.__input_textShadow+"rgba("+i+","+i+","+i+",.7)"})}}]),t}(y),R=["-moz-","-o-","-webkit-","-ms-",""];function O(e,t,n,i){e.style.background="",r.each(R,function(r){e.style.cssText+="background: "+r+"linear-gradient("+t+", "+n+" 0%, "+i+" 100%); "})}var U=function(e,t){var n=e[t];return r.isArray(arguments[2])||r.isObject(arguments[2])?new F(e,t,arguments[2]):r.isNumber(n)?r.isNumber(arguments[2])&&r.isNumber(arguments[3])?r.isNumber(arguments[4])?new M(e,t,arguments[2],arguments[3],arguments[4]):new M(e,t,arguments[2],arguments[3]):r.isNumber(arguments[4])?new P(e,t,{min:arguments[2],max:arguments[3],step:arguments[4]}):new P(e,t,{min:arguments[2],max:arguments[3]}):r.isString(n)?new T(e,t):r.isFunction(n)?new C(e,t,""):r.isBoolean(n)?new S(e,t):null},k=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){setTimeout(e,1e3/60)},D=function(){function e(){h(this,e),this.backgroundElement=document.createElement("div"),r.extend(this.backgroundElement.style,{backgroundColor:"rgba(0,0,0,0.8)",top:0,left:0,display:"none",zIndex:"1000",opacity:0,WebkitTransition:"opacity 0.2s linear",transition:"opacity 0.2s linear"}),w.makeFullscreen(this.backgroundElement),this.backgroundElement.style.position="fixed",this.domElement=document.createElement("div"),r.extend(this.domElement.style,{position:"fixed",display:"none",zIndex:"1001",opacity:0,WebkitTransition:"-webkit-transform 0.2s ease-out, opacity 0.2s linear",transition:"transform 0.2s ease-out, opacity 0.2s linear"}),document.body.appendChild(this.backgroundElement),document.body.appendChild(this.domElement);var t=this;w.bind(this.backgroundElement,"click",function(){t.hide()})}return f(e,[{key:"show",value:function(){var e=this;this.backgroundElement.style.display="block",this.domElement.style.display="block",this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)",this.layout(),r.defer(function(){e.backgroundElement.style.opacity=1,e.domElement.style.opacity=1,e.domElement.style.webkitTransform="scale(1)"})}},{key:"hide",value:function(){var e=this,t=function t(){e.domElement.style.display="none",e.backgroundElement.style.display="none",w.unbind(e.domElement,"webkitTransitionEnd",t),w.unbind(e.domElement,"transitionend",t),w.unbind(e.domElement,"oTransitionEnd",t)};w.bind(this.domElement,"webkitTransitionEnd",t),w.bind(this.domElement,"transitionend",t),w.bind(this.domElement,"oTransitionEnd",t),this.backgroundElement.style.opacity=0,this.domElement.style.opacity=0,this.domElement.style.webkitTransform="scale(1.1)"}},{key:"layout",value:function(){this.domElement.style.left=window.innerWidth/2-w.getWidth(this.domElement)/2+"px",this.domElement.style.top=window.innerHeight/2-w.getHeight(this.domElement)/2+"px"}}]),e}(),B="Default",X=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}(),V=void 0,j=!0,G=void 0,H=!1,z=[],Y=function e(t){var n=this,i=t||{};this.domElement=document.createElement("div"),this.__ul=document.createElement("ul"),this.domElement.appendChild(this.__ul),w.addClass(this.domElement,"dg"),this.__folders={},this.__controllers=[],this.__rememberedObjects=[],this.__rememberedObjectIndecesToControllers=[],this.__listening=[],i=r.defaults(i,{closeOnTop:!1,autoPlace:!0,width:e.DEFAULT_WIDTH}),i=r.defaults(i,{resizable:i.autoPlace,hideable:i.autoPlace}),r.isUndefined(i.load)?i.load={preset:B}:i.preset&&(i.load.preset=i.preset),r.isUndefined(i.parent)&&i.hideable&&z.push(this),i.resizable=r.isUndefined(i.parent)&&i.resizable,i.autoPlace&&r.isUndefined(i.scrollable)&&(i.scrollable=!0);var a=X&&"true"===localStorage.getItem(J(0,"isLocal")),o=void 0;if(Object.defineProperties(this,{parent:{get:function(){return i.parent}},scrollable:{get:function(){return i.scrollable}},autoPlace:{get:function(){return i.autoPlace}},closeOnTop:{get:function(){return i.closeOnTop}},preset:{get:function(){return n.parent?n.getRoot().preset:i.load.preset},set:function(e){n.parent?n.getRoot().preset=e:i.load.preset=e,function(e){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].value===e.preset&&(e.__preset_select.selectedIndex=t)}(this),n.revert()}},width:{get:function(){return i.width},set:function(e){i.width=e,ne(n,e)}},name:{get:function(){return i.name},set:function(e){i.name=e,titleRowName&&(titleRowName.innerHTML=i.name)}},closed:{get:function(){return i.closed},set:function(t){i.closed=t,i.closed?w.addClass(n.__ul,e.CLASS_CLOSED):w.removeClass(n.__ul,e.CLASS_CLOSED),this.onResize(),n.__closeButton&&(n.__closeButton.innerHTML=t?e.TEXT_OPEN:e.TEXT_CLOSED)}},load:{get:function(){return i.load}},useLocalStorage:{get:function(){return a},set:function(e){X&&(a=e,e?w.bind(window,"unload",o):w.unbind(window,"unload",o),localStorage.setItem(J(0,"isLocal"),e))}}}),r.isUndefined(i.parent)){if(i.closed=!1,w.addClass(this.domElement,e.CLASS_MAIN),w.makeSelectable(this.domElement,!1),X&&a){n.useLocalStorage=!0;var s=localStorage.getItem(J(0,"gui"));s&&(i.load=JSON.parse(s))}this.__closeButton=document.createElement("div"),this.__closeButton.innerHTML=e.TEXT_CLOSED,w.addClass(this.__closeButton,e.CLASS_CLOSE_BUTTON),i.closeOnTop?(w.addClass(this.__closeButton,e.CLASS_CLOSE_TOP),this.domElement.insertBefore(this.__closeButton,this.domElement.childNodes[0])):(w.addClass(this.__closeButton,e.CLASS_CLOSE_BOTTOM),this.domElement.appendChild(this.__closeButton)),w.bind(this.__closeButton,"click",function(){n.closed=!n.closed})}else{void 0===i.closed&&(i.closed=!0);var l=document.createTextNode(i.name);w.addClass(l,"controller-name");var u=Q(n,l);w.addClass(this.__ul,e.CLASS_CLOSED),w.addClass(u,"title"),w.bind(u,"click",function(e){return e.preventDefault(),n.closed=!n.closed,!1}),i.closed||(this.closed=!1)}i.autoPlace&&(r.isUndefined(i.parent)&&(j&&(G=document.createElement("div"),w.addClass(G,"dg"),w.addClass(G,e.CLASS_AUTO_PLACE_CONTAINER),document.body.appendChild(G),j=!1),G.appendChild(this.domElement),w.addClass(this.domElement,e.CLASS_AUTO_PLACE)),this.parent||ne(n,i.width)),this.__resizeHandler=function(){n.onResizeDebounced()},w.bind(window,"resize",this.__resizeHandler),w.bind(this.__ul,"webkitTransitionEnd",this.__resizeHandler),w.bind(this.__ul,"transitionend",this.__resizeHandler),w.bind(this.__ul,"oTransitionEnd",this.__resizeHandler),this.onResize(),i.resizable&&te(this),o=function(){X&&"true"===localStorage.getItem(J(0,"isLocal"))&&localStorage.setItem(J(0,"gui"),JSON.stringify(n.getSaveObject()))},this.saveToLocalStorageIfPossible=o,i.parent||function(){var e=n.getRoot();e.width+=1,r.defer(function(){e.width-=1})}()};function Q(e,t,n){var r=document.createElement("li");return t&&r.appendChild(t),n?e.__ul.insertBefore(r,n):e.__ul.appendChild(r),e.onResize(),r}function W(e){w.unbind(window,"resize",e.__resizeHandler),e.saveToLocalStorageIfPossible&&w.unbind(window,"unload",e.saveToLocalStorageIfPossible)}function K(e,t){var n=e.__preset_select[e.__preset_select.selectedIndex];n.innerHTML=t?n.value+"*":n.value}function q(e,t){var n=e.getRoot(),r=n.__rememberedObjects.indexOf(t.object);if(-1!==r){var i=n.__rememberedObjectIndecesToControllers[r];if(void 0===i&&(i={},n.__rememberedObjectIndecesToControllers[r]=i),i[t.property]=t,n.load&&n.load.remembered){var a=n.load.remembered,o=void 0;if(a[e.preset])o=a[e.preset];else{if(!a[B])return;o=a[B]}if(o[r]&&void 0!==o[r][t.property]){var s=o[r][t.property];t.initialValue=s,t.setValue(s)}}}}function Z(e,t,n,i){if(void 0===t[n])throw new Error('Object "'+t+'" has no property "'+n+'"');var a=void 0;if(i.color)a=new N(t,n);else{var o=[t,n].concat(i.factoryArgs);a=U.apply(e,o)}i.before instanceof y&&(i.before=i.before.__li),q(e,a),w.addClass(a.domElement,"c");var s=document.createElement("span");w.addClass(s,"property-name"),s.innerHTML=a.property;var l=document.createElement("div");l.appendChild(s),l.appendChild(a.domElement);var u=Q(e,l,i.before);return w.addClass(u,Y.CLASS_CONTROLLER_ROW),a instanceof N?w.addClass(u,"color"):w.addClass(u,c(a.getValue())),function(e,t,n){if(n.__li=t,n.__gui=e,r.extend(n,{options:function(t){if(arguments.length>1){var i=n.__li.nextElementSibling;return n.remove(),Z(e,n.object,n.property,{before:i,factoryArgs:[r.toArray(arguments)]})}if(r.isArray(t)||r.isObject(t)){var a=n.__li.nextElementSibling;return n.remove(),Z(e,n.object,n.property,{before:a,factoryArgs:[t]})}},name:function(e){return n.__li.firstElementChild.firstElementChild.innerHTML=e,n},listen:function(){return n.__gui.listen(n),n},remove:function(){return n.__gui.remove(n),n}}),n instanceof M){var i=new P(n.object,n.property,{min:n.__min,max:n.__max,step:n.__step});r.each(["updateDisplay","onChange","onFinishChange","step"],function(e){var t=n[e],r=i[e];n[e]=i[e]=function(){var e=Array.prototype.slice.call(arguments);return r.apply(i,e),t.apply(n,e)}}),w.addClass(t,"has-slider"),n.domElement.insertBefore(i.domElement,n.domElement.firstElementChild)}else if(n instanceof P){var a=function(t){if(r.isNumber(n.__min)&&r.isNumber(n.__max)){var i=n.__li.firstElementChild.firstElementChild.innerHTML,a=n.__gui.__listening.indexOf(n)>-1;n.remove();var o=Z(e,n.object,n.property,{before:n.__li.nextElementSibling,factoryArgs:[n.__min,n.__max,n.__step]});return o.name(i),a&&o.listen(),o}return t};n.min=r.compose(a,n.min),n.max=r.compose(a,n.max)}else n instanceof S?(w.bind(t,"click",function(){w.fakeEvent(n.__checkbox,"click")}),w.bind(n.__checkbox,"click",function(e){e.stopPropagation()})):n instanceof C?(w.bind(t,"click",function(){w.fakeEvent(n.__button,"click")}),w.bind(t,"mouseover",function(){w.addClass(n.__button,"hover")}),w.bind(t,"mouseout",function(){w.removeClass(n.__button,"hover")})):n instanceof N&&(w.addClass(t,"color"),n.updateDisplay=r.compose(function(e){return t.style.borderLeftColor=n.__color.toString(),e},n.updateDisplay),n.updateDisplay());n.setValue=r.compose(function(t){return e.getRoot().__preset_select&&n.isModified()&&K(e.getRoot(),!0),t},n.setValue)}(e,u,a),e.__controllers.push(a),a}function J(e,t){return document.location.href+"."+t}function $(e,t,n){var r=document.createElement("option");r.innerHTML=t,r.value=t,e.__preset_select.appendChild(r),n&&(e.__preset_select.selectedIndex=e.__preset_select.length-1)}function ee(e,t){t.style.display=e.useLocalStorage?"block":"none"}function te(e){var t=void 0;function n(n){return n.preventDefault(),e.width+=t-n.clientX,e.onResize(),t=n.clientX,!1}function i(){w.removeClass(e.__closeButton,Y.CLASS_DRAG),w.unbind(window,"mousemove",n),w.unbind(window,"mouseup",i)}function a(r){return r.preventDefault(),t=r.clientX,w.addClass(e.__closeButton,Y.CLASS_DRAG),w.bind(window,"mousemove",n),w.bind(window,"mouseup",i),!1}e.__resize_handle=document.createElement("div"),r.extend(e.__resize_handle.style,{width:"6px",marginLeft:"-3px",height:"200px",cursor:"ew-resize",position:"absolute"}),w.bind(e.__resize_handle,"mousedown",a),w.bind(e.__closeButton,"mousedown",a),e.domElement.insertBefore(e.__resize_handle,e.domElement.firstElementChild)}function ne(e,t){e.domElement.style.width=t+"px",e.__save_row&&e.autoPlace&&(e.__save_row.style.width=t+"px"),e.__closeButton&&(e.__closeButton.style.width=t+"px")}function re(e,t){var n={};return r.each(e.__rememberedObjects,function(i,a){var o={},s=e.__rememberedObjectIndecesToControllers[a];r.each(s,function(e,n){o[n]=t?e.initialValue:e.getValue()}),n[a]=o}),n}return Y.toggleHide=function(){H=!H,r.each(z,function(e){e.domElement.style.display=H?"none":""})},Y.CLASS_AUTO_PLACE="a",Y.CLASS_AUTO_PLACE_CONTAINER="ac",Y.CLASS_MAIN="main",Y.CLASS_CONTROLLER_ROW="cr",Y.CLASS_TOO_TALL="taller-than-window",Y.CLASS_CLOSED="closed",Y.CLASS_CLOSE_BUTTON="close-button",Y.CLASS_CLOSE_TOP="close-top",Y.CLASS_CLOSE_BOTTOM="close-bottom",Y.CLASS_DRAG="drag",Y.DEFAULT_WIDTH=245,Y.TEXT_CLOSED="Close Controls",Y.TEXT_OPEN="Open Controls",Y._keydownHandler=function(e){"text"===document.activeElement.type||72!==e.which&&72!==e.keyCode||Y.toggleHide()},w.bind(window,"keydown",Y._keydownHandler,!1),r.extend(Y.prototype,{add:function(e,t){return Z(this,e,t,{factoryArgs:Array.prototype.slice.call(arguments,2)})},addColor:function(e,t){return Z(this,e,t,{color:!0})},remove:function(e){this.__ul.removeChild(e.__li),this.__controllers.splice(this.__controllers.indexOf(e),1);var t=this;r.defer(function(){t.onResize()})},destroy:function(){if(this.parent)throw new Error("Only the root GUI should be removed with .destroy(). For subfolders, use gui.removeFolder(folder) instead.");this.autoPlace&&G.removeChild(this.domElement);var e=this;r.each(this.__folders,function(t){e.removeFolder(t)}),w.unbind(window,"keydown",Y._keydownHandler,!1),W(this)},addFolder:function(e){if(void 0!==this.__folders[e])throw new Error('You already have a folder in this GUI by the name "'+e+'"');var t={name:e,parent:this};t.autoPlace=this.autoPlace,this.load&&this.load.folders&&this.load.folders[e]&&(t.closed=this.load.folders[e].closed,t.load=this.load.folders[e]);var n=new Y(t);this.__folders[e]=n;var r=Q(this,n.domElement);return w.addClass(r,"folder"),n},removeFolder:function(e){this.__ul.removeChild(e.domElement.parentElement),delete this.__folders[e.name],this.load&&this.load.folders&&this.load.folders[e.name]&&delete this.load.folders[e.name],W(e);var t=this;r.each(e.__folders,function(t){e.removeFolder(t)}),r.defer(function(){t.onResize()})},open:function(){this.closed=!1},close:function(){this.closed=!0},onResize:function(){var e=this.getRoot();if(e.scrollable){var t=w.getOffset(e.__ul).top,n=0;r.each(e.__ul.childNodes,function(t){e.autoPlace&&t===e.__save_row||(n+=w.getHeight(t))}),window.innerHeight-t-20<n?(w.addClass(e.domElement,Y.CLASS_TOO_TALL),e.__ul.style.height=window.innerHeight-t-20+"px"):(w.removeClass(e.domElement,Y.CLASS_TOO_TALL),e.__ul.style.height="auto")}e.__resize_handle&&r.defer(function(){e.__resize_handle.style.height=e.__ul.offsetHeight+"px"}),e.__closeButton&&(e.__closeButton.style.width=e.width+"px")},onResizeDebounced:r.debounce(function(){this.onResize()},50),remember:function(){if(r.isUndefined(V)&&((V=new D).domElement.innerHTML='<div id="dg-save" class="dg dialogue">\n\n  Here\'s the new load parameter for your <code>GUI</code>\'s constructor:\n\n  <textarea id="dg-new-constructor"></textarea>\n\n  <div id="dg-save-locally">\n\n    <input id="dg-local-storage" type="checkbox"/> Automatically save\n    values to <code>localStorage</code> on exit.\n\n    <div id="dg-local-explain">The values saved to <code>localStorage</code> will\n      override those passed to <code>dat.GUI</code>\'s constructor. This makes it\n      easier to work incrementally, but <code>localStorage</code> is fragile,\n      and your friends may not see the same values you do.\n\n    </div>\n\n  </div>\n\n</div>'),this.parent)throw new Error("You can only call remember on a top level GUI.");var e=this;r.each(Array.prototype.slice.call(arguments),function(t){0===e.__rememberedObjects.length&&function(e){var t=e.__save_row=document.createElement("li");w.addClass(e.domElement,"has-save"),e.__ul.insertBefore(t,e.__ul.firstChild),w.addClass(t,"save-row");var n=document.createElement("span");n.innerHTML="&nbsp;",w.addClass(n,"button gears");var i=document.createElement("span");i.innerHTML="Save",w.addClass(i,"button"),w.addClass(i,"save");var a=document.createElement("span");a.innerHTML="New",w.addClass(a,"button"),w.addClass(a,"save-as");var o=document.createElement("span");o.innerHTML="Revert",w.addClass(o,"button"),w.addClass(o,"revert");var s=e.__preset_select=document.createElement("select");if(e.load&&e.load.remembered?r.each(e.load.remembered,function(t,n){$(e,n,n===e.preset)}):$(e,B,!1),w.bind(s,"change",function(){for(var t=0;t<e.__preset_select.length;t++)e.__preset_select[t].innerHTML=e.__preset_select[t].value;e.preset=this.value}),t.appendChild(s),t.appendChild(n),t.appendChild(i),t.appendChild(a),t.appendChild(o),X){var l=document.getElementById("dg-local-explain"),u=document.getElementById("dg-local-storage"),c=document.getElementById("dg-save-locally");c.style.display="block","true"===localStorage.getItem(J(0,"isLocal"))&&u.setAttribute("checked","checked"),ee(e,l),w.bind(u,"change",function(){e.useLocalStorage=!e.useLocalStorage,ee(e,l)})}var h=document.getElementById("dg-new-constructor");w.bind(h,"keydown",function(e){!e.metaKey||67!==e.which&&67!==e.keyCode||V.hide()}),w.bind(n,"click",function(){h.innerHTML=JSON.stringify(e.getSaveObject(),void 0,2),V.show(),h.focus(),h.select()}),w.bind(i,"click",function(){e.save()}),w.bind(a,"click",function(){var t=prompt("Enter a new preset name.");t&&e.saveAs(t)}),w.bind(o,"click",function(){e.revert()})}(e),-1===e.__rememberedObjects.indexOf(t)&&e.__rememberedObjects.push(t)}),this.autoPlace&&ne(this,this.width)},getRoot:function(){for(var e=this;e.parent;)e=e.parent;return e},getSaveObject:function(){var e=this.load;return e.closed=this.closed,this.__rememberedObjects.length>0&&(e.preset=this.preset,e.remembered||(e.remembered={}),e.remembered[this.preset]=re(this)),e.folders={},r.each(this.__folders,function(t,n){e.folders[n]=t.getSaveObject()}),e},save:function(){this.load.remembered||(this.load.remembered={}),this.load.remembered[this.preset]=re(this),K(this,!1),this.saveToLocalStorageIfPossible()},saveAs:function(e){this.load.remembered||(this.load.remembered={},this.load.remembered[B]=re(this,!0)),this.load.remembered[e]=re(this),this.preset=e,$(this,e,!0),this.saveToLocalStorageIfPossible()},revert:function(e){r.each(this.__controllers,function(t){this.getRoot().load.remembered?q(e||this.getRoot(),t):t.setValue(t.initialValue),t.__onFinishChange&&t.__onFinishChange.call(t,t.getValue())},this),r.each(this.__folders,function(e){e.revert(e)}),e||K(this.getRoot(),!1)},listen:function(e){var t=0===this.__listening.length;this.__listening.push(e),t&&function e(t){0!==t.length&&k.call(window,function(){e(t)}),r.each(t,function(e){e.updateDisplay()})}(this.__listening)},updateDisplay:function(){r.each(this.__controllers,function(e){e.updateDisplay()}),r.each(this.__folders,function(e){e.updateDisplay()})}}),{color:{Color:v,math:u,interpret:s},controllers:{Controller:y,BooleanController:S,OptionController:F,StringController:T,NumberController:L,NumberControllerBox:P,NumberControllerSlider:M,FunctionController:C,ColorController:N},dom:{dom:w},gui:{GUI:Y},GUI:Y}}()},function(e,t){
/** @license zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */(function(){"use strict";var e=void 0,t=this;function n(n,r){var i,a=n.split("."),o=t;!(a[0]in o)&&o.execScript&&o.execScript("var "+a[0]);for(;a.length&&(i=a.shift());)a.length||r===e?o=o[i]?o[i]:o[i]={}:o[i]=r}var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array&&"undefined"!=typeof DataView;function i(e){var t,n,i,a,o,s,l,u,c,h,f=e.length,d=0,p=Number.POSITIVE_INFINITY;for(u=0;u<f;++u)e[u]>d&&(d=e[u]),e[u]<p&&(p=e[u]);for(t=1<<d,n=new(r?Uint32Array:Array)(t),i=1,a=0,o=2;i<=d;){for(u=0;u<f;++u)if(e[u]===i){for(s=0,l=a,c=0;c<i;++c)s=s<<1|1&l,l>>=1;for(h=i<<16|u,c=s;c<t;c+=o)n[c]=h;++a}++i,a<<=1,o<<=1}return[n,d,p]}function a(e,t){switch(this.g=[],this.h=32768,this.d=this.f=this.a=this.l=0,this.input=r?new Uint8Array(e):e,this.m=!1,this.i=s,this.r=!1,!t&&(t={})||(t.index&&(this.a=t.index),t.bufferSize&&(this.h=t.bufferSize),t.bufferType&&(this.i=t.bufferType),t.resize&&(this.r=t.resize)),this.i){case o:this.b=32768,this.c=new(r?Uint8Array:Array)(32768+this.h+258);break;case s:this.b=0,this.c=new(r?Uint8Array:Array)(this.h),this.e=this.z,this.n=this.v,this.j=this.w;break;default:throw Error("invalid inflate mode")}}var o=0,s=1,l={t:o,s:s};a.prototype.k=function(){for(;!this.m;){var t=E(this,3);switch(1&t&&(this.m=!0),t>>>=1){case 0:var n=this.input,a=this.a,l=this.c,u=this.b,c=n.length,h=e,d=l.length,p=e;if(this.d=this.f=0,a+1>=c)throw Error("invalid uncompressed block header: LEN");if(h=n[a++]|n[a++]<<8,a+1>=c)throw Error("invalid uncompressed block header: NLEN");if(h===~(n[a++]|n[a++]<<8))throw Error("invalid uncompressed block header: length verify");if(a+h>n.length)throw Error("input buffer is broken");switch(this.i){case o:for(;u+h>l.length;){if(h-=p=d-u,r)l.set(n.subarray(a,a+p),u),u+=p,a+=p;else for(;p--;)l[u++]=n[a++];this.b=u,l=this.e(),u=this.b}break;case s:for(;u+h>l.length;)l=this.e({p:2});break;default:throw Error("invalid inflate mode")}if(r)l.set(n.subarray(a,a+h),u),u+=h,a+=h;else for(;h--;)l[u++]=n[a++];this.a=a,this.b=u,this.c=l;break;case 1:this.j(S,T);break;case 2:var m,v,g,_,y=E(this,5)+257,A=E(this,5)+1,x=E(this,4)+4,b=new(r?Uint8Array:Array)(f.length),w=e,F=e,P=e,I=e,M=e;for(M=0;M<x;++M)b[f[M]]=E(this,3);if(!r)for(M=x,x=b.length;M<x;++M)b[f[M]]=0;for(m=i(b),w=new(r?Uint8Array:Array)(y+A),M=0,_=y+A;M<_;)switch(F=L(this,m),F){case 16:for(I=3+E(this,2);I--;)w[M++]=P;break;case 17:for(I=3+E(this,3);I--;)w[M++]=0;P=0;break;case 18:for(I=11+E(this,7);I--;)w[M++]=0;P=0;break;default:P=w[M++]=F}v=i(r?w.subarray(0,y):w.slice(0,y)),g=i(r?w.subarray(y):w.slice(y)),this.j(v,g);break;default:throw Error("unknown BTYPE: "+t)}}return this.n()};var u,c,h=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],f=r?new Uint16Array(h):h,d=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],p=r?new Uint16Array(d):d,m=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],v=r?new Uint8Array(m):m,g=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],_=r?new Uint16Array(g):g,y=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],A=r?new Uint8Array(y):y,x=new(r?Uint8Array:Array)(288);for(u=0,c=x.length;u<c;++u)x[u]=143>=u?8:255>=u?9:279>=u?7:8;var b,w,S=i(x),F=new(r?Uint8Array:Array)(30);for(b=0,w=F.length;b<w;++b)F[b]=5;var T=i(F);function E(e,t){for(var n,r=e.f,i=e.d,a=e.input,o=e.a,s=a.length;i<t;){if(o>=s)throw Error("input buffer is broken");r|=a[o++]<<i,i+=8}return n=r&(1<<t)-1,e.f=r>>>t,e.d=i-t,e.a=o,n}function L(e,t){for(var n,r,i=e.f,a=e.d,o=e.input,s=e.a,l=o.length,u=t[0],c=t[1];a<c&&!(s>=l);)i|=o[s++]<<a,a+=8;if((r=(n=u[i&(1<<c)-1])>>>16)>a)throw Error("invalid code length: "+r);return e.f=i>>r,e.d=a-r,e.a=s,65535&n}function P(e,t){var n,r;switch(this.input=e,this.a=0,!t&&(t={})||(t.index&&(this.a=t.index),t.verify&&(this.A=t.verify)),n=e[this.a++],r=e[this.a++],15&n){case I:this.method=I;break;default:throw Error("unsupported compression method")}if(0!=((n<<8)+r)%31)throw Error("invalid fcheck flag:"+((n<<8)+r)%31);if(32&r)throw Error("fdict flag is not supported");this.q=new a(e,{index:this.a,bufferSize:t.bufferSize,bufferType:t.bufferType,resize:t.resize})}a.prototype.j=function(e,t){var n=this.c,r=this.b;this.o=e;for(var i,a,o,s,l=n.length-258;256!==(i=L(this,e));)if(256>i)r>=l&&(this.b=r,n=this.e(),r=this.b),n[r++]=i;else for(s=p[a=i-257],0<v[a]&&(s+=E(this,v[a])),i=L(this,t),o=_[i],0<A[i]&&(o+=E(this,A[i])),r>=l&&(this.b=r,n=this.e(),r=this.b);s--;)n[r]=n[r++-o];for(;8<=this.d;)this.d-=8,this.a--;this.b=r},a.prototype.w=function(e,t){var n=this.c,r=this.b;this.o=e;for(var i,a,o,s,l=n.length;256!==(i=L(this,e));)if(256>i)r>=l&&(l=(n=this.e()).length),n[r++]=i;else for(s=p[a=i-257],0<v[a]&&(s+=E(this,v[a])),i=L(this,t),o=_[i],0<A[i]&&(o+=E(this,A[i])),r+s>l&&(l=(n=this.e()).length);s--;)n[r]=n[r++-o];for(;8<=this.d;)this.d-=8,this.a--;this.b=r},a.prototype.e=function(){var e,t,n=new(r?Uint8Array:Array)(this.b-32768),i=this.b-32768,a=this.c;if(r)n.set(a.subarray(32768,n.length));else for(e=0,t=n.length;e<t;++e)n[e]=a[e+32768];if(this.g.push(n),this.l+=n.length,r)a.set(a.subarray(i,i+32768));else for(e=0;32768>e;++e)a[e]=a[i+e];return this.b=32768,a},a.prototype.z=function(e){var t,n,i,a=this.input.length/this.a+1|0,o=this.input,s=this.c;return e&&("number"==typeof e.p&&(a=e.p),"number"==typeof e.u&&(a+=e.u)),2>a?n=(i=(o.length-this.a)/this.o[2]/2*258|0)<s.length?s.length+i:s.length<<1:n=s.length*a,r?(t=new Uint8Array(n)).set(s):t=s,this.c=t},a.prototype.n=function(){var e,t,n,i,a,o=0,s=this.c,l=this.g,u=new(r?Uint8Array:Array)(this.l+(this.b-32768));if(0===l.length)return r?this.c.subarray(32768,this.b):this.c.slice(32768,this.b);for(t=0,n=l.length;t<n;++t)for(i=0,a=(e=l[t]).length;i<a;++i)u[o++]=e[i];for(t=32768,n=this.b;t<n;++t)u[o++]=s[t];return this.g=[],this.buffer=u},a.prototype.v=function(){var e,t=this.b;return r?this.r?(e=new Uint8Array(t)).set(this.c.subarray(0,t)):e=this.c.subarray(0,t):(this.c.length>t&&(this.c.length=t),e=this.c),this.buffer=e},P.prototype.k=function(){var e,t,n=this.input;if(e=this.q.k(),this.a=this.q.a,this.A){t=(n[this.a++]<<24|n[this.a++]<<16|n[this.a++]<<8|n[this.a++])>>>0;var r=e;if("string"==typeof r){var i,a,o=r.split("");for(i=0,a=o.length;i<a;i++)o[i]=(255&o[i].charCodeAt(0))>>>0;r=o}for(var s,l=1,u=0,c=r.length,h=0;0<c;){c-=s=1024<c?1024:c;do{u+=l+=r[h++]}while(--s);l%=65521,u%=65521}if(t!==(u<<16|l)>>>0)throw Error("invalid adler-32 checksum")}return e};var I=8;n("Zlib.Inflate",P),n("Zlib.Inflate.prototype.decompress",P.prototype.k);var M,C,N,R,O={ADAPTIVE:l.s,BLOCK:l.t};if(Object.keys)M=Object.keys(O);else for(C in M=[],N=0,O)M[N++]=C;for(N=0,R=M.length;N<R;++N)n("Zlib.Inflate.BufferType."+(C=M[N]),O[C])}).call(this)},function(e,t,n){var r=n(10);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(4)(!1)).push([e.i,".dg ul {\r\n    list-style: none;\r\n    margin: 0;\r\n    padding: 0;\r\n    width: 100%;\r\n    clear: both\r\n}\r\n\r\n.dg.ac {\r\n    position: fixed;\r\n    top: 0;\r\n    left: 0;\r\n    right: 0;\r\n    height: 0;\r\n    z-index: 0\r\n}\r\n\r\n.dg:not(.ac) .main {\r\n    overflow: hidden\r\n}\r\n\r\n.dg.main {\r\n    -webkit-transition: opacity .1s linear;\r\n    -o-transition: opacity .1s linear;\r\n    -moz-transition: opacity .1s linear;\r\n    transition: opacity .1s linear\r\n}\r\n\r\n.dg.main.taller-than-window {\r\n    overflow-y: auto\r\n}\r\n\r\n.dg.main.taller-than-window .close-button {\r\n    opacity: 1;\r\n    margin-top: -1px;\r\n    border-top: 1px solid #2c2c2c\r\n}\r\n\r\n.dg.main ul.closed .close-button {\r\n    opacity: 1 !important\r\n}\r\n\r\n.dg.main:hover .close-button,\r\n.dg.main .close-button.drag {\r\n    opacity: 1\r\n}\r\n\r\n.dg.main .close-button {\r\n    -webkit-transition: opacity .1s linear;\r\n    -o-transition: opacity .1s linear;\r\n    -moz-transition: opacity .1s linear;\r\n    transition: opacity .1s linear;\r\n    border: 0;\r\n    line-height: 19px;\r\n    height: 20px;\r\n    cursor: pointer;\r\n    text-align: center;\r\n    background-color: #000\r\n}\r\n\r\n.dg.main .close-button.close-top {\r\n    position: relative\r\n}\r\n\r\n.dg.main .close-button.close-bottom {\r\n    position: absolute\r\n}\r\n\r\n.dg.main .close-button:hover {\r\n    background-color: #111\r\n}\r\n\r\n.dg.a {\r\n    float: right;\r\n    margin-top: 15px;\r\n    margin-right: 15px;\r\n    overflow-y: visible\r\n}\r\n\r\n.dg.a.has-save>ul.close-top {\r\n    margin-top: 0\r\n}\r\n\r\n.dg.a.has-save>ul.close-bottom {\r\n    margin-top: 27px\r\n}\r\n\r\n.dg.a.has-save>ul.closed {\r\n    margin-top: 0\r\n}\r\n\r\n.dg.a .save-row {\r\n    top: 0;\r\n    z-index: 1002\r\n}\r\n\r\n.dg.a .save-row.close-top {\r\n    position: relative\r\n}\r\n\r\n.dg.a .save-row.close-bottom {\r\n    position: fixed\r\n}\r\n\r\n.dg li {\r\n    -webkit-transition: height .1s ease-out;\r\n    -o-transition: height .1s ease-out;\r\n    -moz-transition: height .1s ease-out;\r\n    transition: height .1s ease-out;\r\n    -webkit-transition: overflow .1s linear;\r\n    -o-transition: overflow .1s linear;\r\n    -moz-transition: overflow .1s linear;\r\n    transition: overflow .1s linear\r\n}\r\n\r\n.dg li:not(.folder) {\r\n    cursor: auto;\r\n    height: 27px;\r\n    line-height: 27px;\r\n    padding: 0 4px 0 5px\r\n}\r\n\r\n.dg li.folder {\r\n    padding: 0;\r\n    border-left: 4px solid transparent\r\n}\r\n\r\n.dg li.title {\r\n    cursor: pointer;\r\n    margin-left: -4px\r\n}\r\n\r\n.dg .closed li:not(.title),\r\n.dg .closed ul li,\r\n.dg .closed ul li>* {\r\n    height: 0;\r\n    overflow: hidden;\r\n    border: 0\r\n}\r\n\r\n.dg .cr {\r\n    clear: both;\r\n    padding-left: 3px;\r\n    height: 27px;\r\n    overflow: hidden\r\n}\r\n\r\n.dg .property-name {\r\n    cursor: default;\r\n    float: left;\r\n    clear: left;\r\n    width: 40%;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis\r\n}\r\n\r\n.dg .c {\r\n    float: left;\r\n    width: 60%;\r\n    position: relative\r\n}\r\n\r\n.dg .c input[type=text] {\r\n    border: 0;\r\n    margin-top: 4px;\r\n    padding: 3px;\r\n    width: 100%;\r\n    float: right\r\n}\r\n\r\n.dg .has-slider input[type=text] {\r\n    width: 30%;\r\n    margin-left: 0\r\n}\r\n\r\n.dg .slider {\r\n    float: left;\r\n    width: 66%;\r\n    margin-left: -5px;\r\n    margin-right: 0;\r\n    height: 19px;\r\n    margin-top: 4px\r\n}\r\n\r\n.dg .slider-fg {\r\n    height: 100%\r\n}\r\n\r\n.dg .c input[type=checkbox] {\r\n    margin-top: 7px\r\n}\r\n\r\n.dg .c select {\r\n    margin-top: 5px\r\n}\r\n\r\n.dg .cr.function,\r\n.dg .cr.function .property-name,\r\n.dg .cr.function *,\r\n.dg .cr.boolean,\r\n.dg .cr.boolean * {\r\n    cursor: pointer\r\n}\r\n\r\n.dg .cr.color {\r\n    overflow: visible\r\n}\r\n\r\n.dg .selector {\r\n    display: none;\r\n    position: absolute;\r\n    margin-left: -9px;\r\n    margin-top: 23px;\r\n    z-index: 10\r\n}\r\n\r\n.dg .c:hover .selector,\r\n.dg .selector.drag {\r\n    display: block\r\n}\r\n\r\n.dg li.save-row {\r\n    padding: 0\r\n}\r\n\r\n.dg li.save-row .button {\r\n    display: inline-block;\r\n    padding: 0px 6px\r\n}\r\n\r\n.dg.dialogue {\r\n    background-color: #222;\r\n    width: 460px;\r\n    padding: 15px;\r\n    font-size: 13px;\r\n    line-height: 15px\r\n}\r\n\r\n#dg-new-constructor {\r\n    padding: 10px;\r\n    color: #222;\r\n    font-family: Monaco, monospace;\r\n    font-size: 10px;\r\n    border: 0;\r\n    resize: none;\r\n    box-shadow: inset 1px 1px 1px #888;\r\n    word-wrap: break-word;\r\n    margin: 12px 0;\r\n    display: block;\r\n    width: 440px;\r\n    overflow-y: scroll;\r\n    height: 100px;\r\n    position: relative\r\n}\r\n\r\n#dg-local-explain {\r\n    display: none;\r\n    font-size: 11px;\r\n    line-height: 17px;\r\n    border-radius: 3px;\r\n    background-color: #333;\r\n    padding: 8px;\r\n    margin-top: 10px\r\n}\r\n\r\n#dg-local-explain code {\r\n    font-size: 10px\r\n}\r\n\r\n#dat-gui-save-locally {\r\n    display: none\r\n}\r\n\r\n.dg {\r\n    color: #eee;\r\n    font: 11px 'Lucida Grande', sans-serif;\r\n    text-shadow: 0 -1px 0 #111\r\n}\r\n\r\n.dg.main::-webkit-scrollbar {\r\n    width: 5px;\r\n    background: #1a1a1a\r\n}\r\n\r\n.dg.main::-webkit-scrollbar-corner {\r\n    height: 0;\r\n    display: none\r\n}\r\n\r\n.dg.main::-webkit-scrollbar-thumb {\r\n    border-radius: 5px;\r\n    background: #676767\r\n}\r\n\r\n.dg li:not(.folder) {\r\n    background: #1a1a1a;\r\n    border-bottom: 1px solid #2c2c2c\r\n}\r\n\r\n.dg li.save-row {\r\n    line-height: 25px;\r\n    background: #dad5cb;\r\n    border: 0\r\n}\r\n\r\n.dg li.save-row select {\r\n    margin-left: 5px;\r\n    width: 108px\r\n}\r\n\r\n.dg li.save-row .button {\r\n    margin-left: 5px;\r\n    margin-top: 1px;\r\n    border-radius: 2px;\r\n    font-size: 9px;\r\n    line-height: 7px;\r\n    padding: 4px 4px 5px 4px;\r\n    background: #c5bdad;\r\n    color: #fff;\r\n    text-shadow: 0 1px 0 #b0a58f;\r\n    box-shadow: 0 -1px 0 #b0a58f;\r\n    cursor: pointer\r\n}\r\n\r\n.dg li.save-row .button.gears {\r\n    background: #c5bdad url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAANCAYAAAB/9ZQ7AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAQJJREFUeNpiYKAU/P//PwGIC/ApCABiBSAW+I8AClAcgKxQ4T9hoMAEUrxx2QSGN6+egDX+/vWT4e7N82AMYoPAx/evwWoYoSYbACX2s7KxCxzcsezDh3evFoDEBYTEEqycggWAzA9AuUSQQgeYPa9fPv6/YWm/Acx5IPb7ty/fw+QZblw67vDs8R0YHyQhgObx+yAJkBqmG5dPPDh1aPOGR/eugW0G4vlIoTIfyFcA+QekhhHJhPdQxbiAIguMBTQZrPD7108M6roWYDFQiIAAv6Aow/1bFwXgis+f2LUAynwoIaNcz8XNx3Dl7MEJUDGQpx9gtQ8YCueB+D26OECAAQDadt7e46D42QAAAABJRU5ErkJggg==) 2px 1px no-repeat;\r\n    height: 7px;\r\n    width: 8px\r\n}\r\n\r\n.dg li.save-row .button:hover {\r\n    background-color: #bab19e;\r\n    box-shadow: 0 -1px 0 #b0a58f\r\n}\r\n\r\n.dg li.folder {\r\n    border-bottom: 0\r\n}\r\n\r\n.dg li.title {\r\n    padding-left: 16px;\r\n    background: #000 url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlI+hKgFxoCgAOw==) 6px 10px no-repeat;\r\n    cursor: pointer;\r\n    border-bottom: 1px solid rgba(255, 255, 255, 0.2)\r\n}\r\n\r\n.dg .closed li.title {\r\n    background-image: url(data:image/gif;base64,R0lGODlhBQAFAJEAAP////Pz8////////yH5BAEAAAIALAAAAAAFAAUAAAIIlGIWqMCbWAEAOw==)\r\n}\r\n\r\n.dg .cr.boolean {\r\n    border-left: 3px solid #806787\r\n}\r\n\r\n.dg .cr.color {\r\n    border-left: 3px solid\r\n}\r\n\r\n.dg .cr.function {\r\n    border-left: 3px solid #e61d5f\r\n}\r\n\r\n.dg .cr.number {\r\n    border-left: 3px solid #2FA1D6\r\n}\r\n\r\n.dg .cr.number input[type=text] {\r\n    color: #2FA1D6\r\n}\r\n\r\n.dg .cr.string {\r\n    border-left: 3px solid #1ed36f\r\n}\r\n\r\n.dg .cr.string input[type=text] {\r\n    color: #1ed36f\r\n}\r\n\r\n.dg .cr.function:hover,\r\n.dg .cr.boolean:hover {\r\n    background: #111\r\n}\r\n\r\n.dg .c input[type=text] {\r\n    background: #303030;\r\n    outline: none\r\n}\r\n\r\n.dg .c input[type=text]:hover {\r\n    background: #3c3c3c\r\n}\r\n\r\n.dg .c input[type=text]:focus {\r\n    background: #494949;\r\n    color: #fff\r\n}\r\n\r\n.dg .c .slider {\r\n    background: #303030;\r\n    cursor: ew-resize\r\n}\r\n\r\n.dg .c .slider-fg {\r\n    background: #2FA1D6;\r\n    max-width: 100%\r\n}\r\n\r\n.dg .c .slider:hover {\r\n    background: #3c3c3c\r\n}\r\n\r\n.dg .c .slider:hover .slider-fg {\r\n    background: #44abda\r\n}",""])},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,r=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var i,a=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(a)?e:(i=0===a.indexOf("//")?a:0===a.indexOf("/")?n+a:r+a.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")})}},function(e,t,n){var r=n(13);"string"==typeof r&&(r=[[e.i,r,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(5)(r,i);r.locals&&(e.exports=r.locals)},function(e,t,n){(e.exports=n(4)(!1)).push([e.i,"body {\r\n    margin: 0;\r\n    overflow: hidden;\r\n}\r\n\r\n#canvas {\r\n    width: 100%;\r\n    height: 100%;\r\n\r\n    transition: filter 3s ease;\r\n}\r\n\r\n.statsBox {\r\n    position: fixed;\r\n    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3);\r\n    top: 0;\r\n    left: 0;\r\n    margin: 10px;\r\n    cursor: pointer;\r\n    opacity: 0.9;\r\n    z-index: 10000\r\n}\r\n\r\nhtml, body {\r\n    width: 100%;\r\n    height: 100%;\r\n}\r\n\r\nbody {\r\n    background-color: #ffffff;\r\n    margin: 0;\r\n    overflow: hidden;\r\n    font-family: arial;\r\n}\r\n\r\n.controls-card {\r\n    z-index: 3;\r\n    display: none;\r\n    color: #fff;\r\n    position: absolute;\r\n    border-radius: 3px;\r\n    text-shadow: 1px 1px 0px #000, 0px 1px 2px #000c;\r\n    overflow: hidden;\r\n    bottom: 0;\r\n    top: 80px;\r\n    margin: 10px;\r\n    font-family: 'Roboto Condensed', sans-serif;\r\n    user-select: none;\r\n    pointer-events: none;\r\n}\r\n\r\n.controls-title {\r\n    font-family: Roboto;\r\n    font-size: 18px;\r\n    margin-bottom: 20px;\r\n    padding-left: 33px;\r\n}\r\n\r\n.controls-ctrl {\r\n    margin-bottom: 10px;\r\n    display: flex;\r\n    align-items: center;\r\n}\r\n\r\n.controls-card .keyboard {\r\n    position: absolute;\r\n    left: 12px;\r\n    top: 8px;\r\n    height: 30px;\r\n}\r\n\r\n.controls-card .mouse {\r\n    max-height: 34px;\r\n    margin: -2px 0px;\r\n}\r\n\r\n.controls-card .key {\r\n    text-shadow: none;\r\n    display: inline-block;\r\n    font-family: monospace;\r\n    padding: 2px 5px;\r\n    margin-right: 2px;\r\n    min-width: 10px;\r\n    text-align: center;\r\n    margin-left: 2px;\r\n    background: #eff0f2;\r\n    box-shadow: inset 0 0 25px #e8e8e8, 0 1px 0 #c3c3c3, 0 2px 0 #c9c9c9, 0 2px 3px #000;\r\n    color: #111;\r\n    border-radius: 2px;\r\n    font-size: 14px;\r\n}\r\n\r\n.ctrl-desc {\r\n    margin-left: 5px;\r\n}\r\n\r\n.controls-card .menu-arrow {\r\n    position: absolute;\r\n    right: 8px;\r\n    height: 24px;\r\n    top: 14px;\r\n    transition: all 0.2s ease;\r\n    transform: rotate(180deg);\r\n}\r\n\r\n#loader {\r\n    z-index: 6;\r\n    position: absolute;\r\n    left: 0;\r\n    top: 0;\r\n    width: 100%;\r\n    height: 100%;\r\n    background: rgba(0,0,0,0.5);\r\n    display: flex;\r\n    justify-content: center;\r\n    align-items: center;\r\n    font-size: 50px;\r\n    font-family: 'Roboto Condensed', sans-serif;\r\n    color: white;\r\n    text-shadow: 0px 1px 1px black, 0px 0px 7px black;\r\n}",""])},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";n.r(t);n(9),n(12);var r=n(0);class i{constructor(e,t=1,n=t){this.camera=e,this.target=new r.Vector3,this.sensitivity=new r.Vector2(t,n),this.radius=3,this.theta=0,this.phi=0,this.onMouseDownPosition=new r.Vector2,this.onMouseDownTheta=this.theta,this.onMouseDownPhi=this.phi}setSensitivity(e,t=e){this.sensitivity=new r.Vector2(e,t)}setRadius(e){this.radius=Math.max(.001,e)}move(e,t){this.theta-=e*this.sensitivity.x,this.theta%=720,this.phi+=t*this.sensitivity.y,this.phi=Math.min(170,Math.max(-170,this.phi))}update(){this.camera.position.x=this.target.x+this.radius*Math.sin(this.theta*Math.PI/360)*Math.cos(this.phi*Math.PI/360),this.camera.position.y=this.target.y+this.radius*Math.sin(this.phi*Math.PI/360),this.camera.position.z=this.target.z+this.radius*Math.cos(this.theta*Math.PI/360)*Math.cos(this.phi*Math.PI/360),this.camera.updateMatrix(),this.camera.lookAt(this.target)}}var a=n(1),o=n(2),s=n.n(o);class l{static createCapsuleGeometry(e=1,t=2,n=32){const i=new r.Geometry,a=2*Math.PI,o=1.5707963267948966,s=[];for(let l=0;l<=n/4;l++)for(let u=0;u<=n;u++){let c=u*a/n,h=-o+Math.PI*l/(n/2),f=new r.Vector3,d=new r.Vector3;f.x=e*Math.cos(h)*Math.cos(c),f.y=e*Math.cos(h)*Math.sin(c),f.z=e*Math.sin(h),f.z-=t/2,d.x=f.x,d.y=f.y,d.z=f.z,i.vertices.push(f),s.push(d)}for(let l=n/4;l<=n/2;l++)for(let u=0;u<=n;u++){let c=u*a/n,h=-o+Math.PI*l/(n/2),f=new r.Vector3,d=new r.Vector3;f.x=e*Math.cos(h)*Math.cos(c),f.y=e*Math.cos(h)*Math.sin(c),f.z=e*Math.sin(h),f.z+=t/2,d.x=f.x,d.y=f.y,d.z=f.z,i.vertices.push(f),s.push(d)}for(let e=0;e<=n/2;e++)for(let t=0;t<n;t++){let a=new r.Vector4(e*(n+1)+t,e*(n+1)+(t+1),(e+1)*(n+1)+(t+1),(e+1)*(n+1)+t);if(e==n/4){let e=new r.Face3(a.x,a.y,a.z,[s[a.x],s[a.y],s[a.z]]),t=new r.Face3(a.x,a.z,a.w,[s[a.x],s[a.z],s[a.w]]);i.faces.push(t),i.faces.push(e)}else{let e=new r.Face3(a.x,a.y,a.z,[s[a.x],s[a.y],s[a.z]]),t=new r.Face3(a.x,a.z,a.w,[s[a.x],s[a.z],s[a.w]]);i.faces.push(e),i.faces.push(t)}}return i.rotateX(Math.PI/2),i.computeVertexNormals(),i.computeFaceNormals(),i}static appplyVectorMatrixXZ(e,t){return new r.Vector3((e.x*t.z+e.z*t.x)/2,t.y,(e.z*t.z+-e.x*t.x)/2)}static round(e,t=0){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}static roundVector(e,t=0){return new r.Vector3(this.round(e.x,t),this.round(e.y,t),this.round(e.z,t))}static getAngleBetweenVectors(e,t,n=5e-4){let r,i=e.dot(t);return r=i>1-n?0:i<-1+n?Math.PI/2:Math.acos(i)}static getSignedAngleBetweenVectors(e,t,n=new r.Vector3(0,1,0),i=5e-4){let a=this.getAngleBetweenVectors(e,t,i),o=(new r.Vector3).crossVectors(e,t);return n.dot(o)<0&&(a=-a),a}static haveSameSigns(e,t){return e<0==t<0}static haveDifferentSigns(e,t){return e<0!=t<0}static createArray(e){let t=new Array(e||0),n=e;if(arguments.length>1){let r=Array.prototype.slice.call(arguments,1);for(;n--;)t[e-1-n]=this.createArray.apply(this,r)}return t}static setDefaults(e,t){return s.a.defaults({},s.a.clone(e),t)}static getGlobalProperties(e=""){let t=[],n=window;for(let r in n)0==r.indexOf(e)&&t.push(r);return t}}class u{constructor(e){this.frameTime=1/e,this.offset=0,this.cache=[]}setFPS(e){this.frameTime=1/e}lastFrame(){return this.cache[this.cache.length-1]}generateFrames(e){let t=this.offset+e,n=Math.floor(t/this.frameTime);if(this.offset=t%this.frameTime,n>0){for(let e=0;e<n;e++)this.cache.push(this.getFrame(e+1==n));this.cache=this.cache.slice(-2)}}}function c(e,t,n,r,i){let a=t-e;return n+=a/=r,{position:e+=n*=i,velocity:n}}let h={SpringSimulator:class extends u{constructor(e,t,n,r=0,i=0){super(e),this.position=0,this.velocity=0,this.target=0,this.mass=t,this.damping=n;for(let e=0;e<2;e++)this.cache.push({position:r,velocity:i})}simulate(e){this.generateFrames(e),this.position=r.Math.lerp(this.cache[0].position,this.cache[1].position,this.offset/this.frameTime),this.velocity=r.Math.lerp(this.cache[0].velocity,this.cache[1].velocity,this.offset/this.frameTime)}getFrame(e){return c(this.lastFrame().position,this.target,this.lastFrame().velocity,this.mass,this.damping)}},VectorSpringSimulator:class extends u{constructor(e,t,n,i=new r.Vector3,a=new r.Vector3){super(e),this.position=new r.Vector3,this.velocity=new r.Vector3,this.target=new r.Vector3,this.mass=t,this.damping=n;for(let e=0;e<2;e++)this.cache.push({position:i,velocity:a})}simulate(e){this.generateFrames(e),this.position.lerpVectors(this.cache[0].position,this.cache[1].position,this.offset/this.frameTime),this.velocity.lerpVectors(this.cache[0].velocity,this.cache[1].velocity,this.offset/this.frameTime)}getFrame(e){let t={position:this.lastFrame().position.clone(),velocity:this.lastFrame().velocity.clone()};return function(e,t,n,i,a){let o=(new r.Vector3).subVectors(t,e);o.divideScalar(i),n.add(o),n.multiplyScalar(a),e.add(n)}(t.position,this.target,t.velocity,this.mass,this.damping),t}},RelativeSpringSimulator:class extends u{constructor(e,t,n,r=0,i=0){super(e),this.position=0,this.velocity=0,this.target=0,this.mass=t,this.damping=n,this.lastLerp=0;for(let e=0;e<2;e++)this.cache.push({position:r,velocity:i})}simulate(e){this.generateFrames(e);let t=r.Math.lerp(0,this.cache[1].position,this.offset/this.frameTime);this.position=t-this.lastLerp,this.lastLerp=t,this.velocity=r.Math.lerp(this.cache[0].velocity,this.cache[1].velocity,this.offset/this.frameTime)}getFrame(e){let t=Object.assign({},this.lastFrame());return e&&(t.position=0,this.lastLerp=this.lastLerp-this.lastFrame().position),c(t.position,this.target,t.velocity,this.mass,this.damping)}}};let f={EventControl:class{constructor(){this.value=!1,this.justPressed=!1,this.justReleased=!1}},LerpControl:class{constructor(){this.value=!1,this.floatValue=0}}};class d{update(){if(void 0===this.character)return console.error("Character is undefined."),!1}updateCharacter(e){this.character.charState.update(e)}}let p={Default:class extends d{update(e){super.update(),this.updateCharacter(e)}},FollowCharacter:class extends d{constructor(e,t=1.3){super(),this.targetCharacter=e,this.stopDistance=t}update(e){super.update();let t=(new r.Vector3).subVectors(this.targetCharacter.position,this.character.position);this.character.setViewVector(t),t.length()>this.stopDistance?this.character.setControl("up",!0):(this.character.setControl("up",!1),this.character.setOrientationTarget(t)),this.updateCharacter(e)}},Random:class extends d{constructor(e=100){super(),this.randomFrequency=e}update(e){super.update();let t=Math.floor(Math.random()*this.randomFrequency),n=Math.random()>.5;0==t?(this.character.setViewVector(new r.Vector3(Math.random()-.5,Math.random()-.5,Math.random()-.5)),this.character.setControl("up",!0),this.character.charState.update(e),this.character.setControl("up",!1)):1==t?this.character.setControl("up",n):2==t?this.character.setControl("run",n):3==t&&this.character.setControl("jump",n),this.updateCharacter(e)}}};class m{constructor(e){this.character=e,this.character.velocitySimulator.damping=this.character.defaultVelocitySimulatorDamping,this.character.velocitySimulator.mass=this.character.defaultVelocitySimulatorMass,this.character.rotationSimulator.damping=this.character.defaultRotationSimulatorDamping,this.character.rotationSimulator.mass=this.character.defaultRotationSimulatorMass,this.character.arcadeVelocityIsAdditive=!1,this.character.setArcadeVelocityInfluence(1,0,1),this.timer=0}update(e){this.timer+=e}changeState(){}noDirection(){return!(this.character.controls.up.value||this.character.controls.down.value||this.character.controls.left.value||this.character.controls.right.value)}anyDirection(){return this.character.controls.up.value||this.character.controls.down.value||this.character.controls.left.value||this.character.controls.right.value}justPressed(e){return this.character.controls.lastControl==e&&e.justPressed}isPressed(e){return e.value}justReleased(e){return this.character.controls.lastControl==e&&e.justReleased}fallInAir(){this.character.rayHasHit||this.character.setState(I)}animationEnded(e){return void 0==this.character.mixer||(void 0==this.animationLength?(console.error(this.constructor.name+"Error: Set this.animationLength in state constructor!"),!1):this.timer>this.animationLength-e)}setAppropriateDropState(){this.character.groundImpactData.velocity.y<-6?this.character.setState(N):this.anyDirection()?this.character.groundImpactData.velocity.y<-2?this.character.setState(C):this.isPressed(this.character.controls.run)?this.character.setState(A):this.character.setState(y):this.character.setState(M)}setAppropriateStartWalkState(){let e=Math.PI,t=l.getSignedAngleBetweenVectors(this.character.orientation,this.character.getCameraRelativeMovementVector());t>.8*e?this.character.setState(F):t<.8*-e?this.character.setState(T):t>.3*e?this.character.setState(w):t<.3*-e?this.character.setState(S):this.character.setState(b)}}class v extends m{constructor(e){super(e),this.character.velocitySimulator.damping=.6,this.character.velocitySimulator.mass=10,this.character.setArcadeVelocityTarget(0),this.character.setAnimation("idle",.3)}update(e){super.update(e),this.character.update(e),this.fallInAir()}changeState(){this.justPressed(this.character.controls.jump)&&this.character.setState(L),this.anyDirection()&&(this.character.velocity.length()>.5?this.character.setState(y):this.setAppropriateStartWalkState())}}class g extends m{constructor(e){super(e),this.character.rotationSimulator.mass=30,this.character.rotationSimulator.damping=.6,this.character.velocitySimulator.damping=.6,this.character.velocitySimulator.mass=10,this.character.setArcadeVelocityTarget(0),this.animationLength=this.character.setAnimation("rotate_right",.1)}update(e){super.update(e),this.animationEnded(e)&&this.character.setState(v),this.character.update(e),this.fallInAir()}changeState(){this.justPressed(this.character.controls.jump)&&this.character.setState(L),this.anyDirection()&&(this.character.velocity.length()>.5?this.character.setState(y):this.setAppropriateStartWalkState())}}class _ extends m{constructor(e){super(e),this.character.rotationSimulator.mass=30,this.character.rotationSimulator.damping=.6,this.character.velocitySimulator.damping=.6,this.character.velocitySimulator.mass=10,this.character.setArcadeVelocityTarget(0),this.animationLength=this.character.setAnimation("rotate_left",.1)}update(e){super.update(e),this.character.update(e),this.animationEnded(e)&&this.character.setState(v),this.fallInAir()}changeState(){this.justPressed(this.character.controls.jump)&&this.character.setState(L),this.anyDirection()&&(this.character.velocity.length()>.5?this.character.setState(y):this.setAppropriateStartWalkState())}}class y extends m{constructor(e){super(e),this.character.setArcadeVelocityTarget(.8),this.character.setAnimation("run",.1),this.noDirection()&&this.character.setState(E)}update(e){super.update(e),this.character.setCameraRelativeOrientationTarget(),this.character.update(e),this.fallInAir(),this.isPressed(this.character.controls.run)&&this.character.setState(A)}changeState(){this.justPressed(this.character.controls.jump)&&this.character.setState(P),this.noDirection()&&(this.character.velocity.length()>1?this.character.setState(E):this.character.setState(v))}}class A extends m{constructor(e){super(e),this.character.velocitySimulator.mass=10,this.character.rotationSimulator.damping=.8,this.character.rotationSimulator.mass=50,this.character.setArcadeVelocityTarget(1.4),this.character.setAnimation("sprint",.3)}update(e){super.update(e),this.character.setCameraRelativeOrientationTarget(),this.character.update(e),this.fallInAir()}changeState(){this.justReleased(this.character.controls.run)&&this.character.setState(y),this.justPressed(this.character.controls.jump)&&this.character.setState(P),this.noDirection()&&this.character.setState(E)}}class x extends m{constructor(e){super(e),this.character.rotationSimulator.mass=20,this.character.rotationSimulator.damping=.7,this.character.setArcadeVelocityTarget(.8)}update(e){super.update(e),this.animationEnded(e)&&this.character.setState(y),this.character.setCameraRelativeOrientationTarget(),this.character.update(e),this.fallInAir()}changeState(){if(this.justPressed(this.character.controls.jump)&&this.character.setState(P),this.noDirection())if(this.timer<.1){let e=l.getSignedAngleBetweenVectors(this.character.orientation,this.character.orientationTarget);e>.4*Math.PI?this.character.setState(_):e<.4*-Math.PI?this.character.setState(g):this.character.setState(v)}else this.character.setState(v);this.justPressed(this.character.controls.run)&&this.character.setState(A)}}class b extends x{constructor(e){super(e),this.animationLength=e.setAnimation("start_forward",.1)}}class w extends x{constructor(e){super(e),this.animationLength=e.setAnimation("start_left",.1)}}class S extends x{constructor(e){super(e),this.animationLength=e.setAnimation("start_right",.1)}}class F extends x{constructor(e){super(e),this.animationLength=e.setAnimation("start_back_left",.1)}}class T extends x{constructor(e){super(e),this.animationLength=e.setAnimation("start_back_right",.1)}}class E extends m{constructor(e){super(e),this.character.setArcadeVelocityTarget(0),this.animationLength=e.setAnimation("stop",.1)}update(e){super.update(e),this.animationEnded(e)&&this.character.setState(v),this.character.update(e),this.fallInAir()}changeState(){this.justPressed(this.character.controls.jump)&&this.character.setState(L),this.anyDirection()&&(this.isPressed(this.character.controls.run)?this.character.setState(A):this.character.velocity.length()>.5?this.character.setState(y):this.setAppropriateStartWalkState())}}class L extends m{constructor(e){super(e),this.character.velocitySimulator.mass=50,this.character.setArcadeVelocityTarget(0),this.animationLength=this.character.setAnimation("jump_idle",.1),this.alreadyJumped=!1}update(e){super.update(e),this.alreadyJumped&&(this.character.setCameraRelativeOrientationTarget(),this.character.setArcadeVelocityTarget(this.anyDirection()?.8:0)),this.character.update(e),this.timer>.2&&!this.alreadyJumped?(this.character.jump(),this.alreadyJumped=!0,this.character.velocitySimulator.mass=100,this.character.rotationSimulator.damping=.3,this.character.setArcadeVelocityInfluence(.3,0,.3)):this.timer>.3&&this.character.rayHasHit?this.setAppropriateDropState():this.timer>this.animationLength-e&&this.character.setState(I)}}class P extends m{constructor(e){super(e),this.character.velocitySimulator.mass=100,this.animationLength=this.character.setAnimation("jump_running",.1),this.alreadyJumped=!1}update(e){super.update(e),this.character.setCameraRelativeOrientationTarget(),this.alreadyJumped&&this.character.setArcadeVelocityTarget(this.anyDirection()?.8:0),this.character.update(e),this.timer>.14&&!this.alreadyJumped?(this.character.jump(4),this.alreadyJumped=!0,this.character.rotationSimulator.damping=.3,this.character.arcadeVelocityIsAdditive=!0,this.character.setArcadeVelocityInfluence(.05,0,.05)):this.timer>.24&&this.character.rayHasHit?this.setAppropriateDropState():this.timer>this.animationLength-e&&this.character.setState(I)}}class I extends m{constructor(e){super(e),this.character.velocitySimulator.mass=100,this.character.rotationSimulator.damping=.3,this.character.arcadeVelocityIsAdditive=!0,this.character.setArcadeVelocityInfluence(.05,0,.05),this.character.setAnimation("falling",.3)}update(e){super.update(e),this.character.setCameraRelativeOrientationTarget(),this.character.setArcadeVelocityTarget(this.anyDirection()?.8:0),this.character.update(e),this.character.rayHasHit&&this.setAppropriateDropState()}}class M extends m{constructor(e){super(e),this.character.velocitySimulator.damping=.5,this.character.velocitySimulator.mass=7,this.character.setArcadeVelocityTarget(0),this.animationLength=this.character.setAnimation("drop_idle",.1),this.anyDirection()&&this.character.setState(b)}update(e){super.update(e),this.character.setCameraRelativeOrientationTarget(),this.character.update(e),this.animationEnded(e)&&this.character.setState(v),this.fallInAir()}changeState(){this.justPressed(this.character.controls.jump)&&this.character.setState(L),this.anyDirection()&&this.character.setState(b)}}class C extends m{constructor(e){super(e),this.character.setArcadeVelocityTarget(.8),this.animationLength=this.character.setAnimation("drop_running",.1)}update(e){super.update(e),this.character.setCameraRelativeOrientationTarget(),this.character.update(e),this.animationEnded(e)&&this.character.setState(y)}changeState(){this.noDirection(this.character.controls.jump)&&this.character.setState(E),this.anyDirection()&&this.justPressed(this.character.controls.run)&&this.character.setState(A),this.justPressed(this.character.controls.jump)&&this.character.setState(P)}}class N extends m{constructor(e){super(e),this.character.velocitySimulator.mass=1,this.character.velocitySimulator.damping=.6,this.character.setArcadeVelocityTarget(.8),this.animationLength=this.character.setAnimation("drop_running_roll",.03)}update(e){super.update(e),this.character.setCameraRelativeOrientationTarget(),this.character.update(e),this.animationEnded(e)&&(this.anyDirection()?this.character.setState(y):this.character.setState(E))}}let R={DefaultState:m,Idle:v,Walk:y,Sprint:A,StartWalkForward:b,StartWalkLeft:w,StartWalkBackLeft:F,StartWalkRight:S,StartWalkBackRight:T,EndWalk:E,JumpIdle:L,JumpRunning:P,Falling:I,DropIdle:M,DropRunning:C,DropRolling:N};class O extends r.Object3D{constructor(e,t){super(),this.isObject=!0,this.model=e,this.physics=t}update(e){void 0!=this.physics.visual&&(this.physics.visual.position.copy(this.position),this.physics.visual.quaternion.copy(this.quaternion)),void 0!=this.model&&(this.model.position.copy(this.position),this.model.quaternion.copy(this.quaternion))}setModel(e){this.model=e}setModelFromPhysicsShape(){this.model=this.physics.getVisualModel({visible:!0,wireframe:!1})}setPhysics(e){this.physics=e}}var U=n(3);let k={Sphere:class{constructor(e){let t={mass:0,position:new a.Vec3,radius:.3,friction:.3};e=l.setDefaults(e,t),this.options=e;let n=new a.Material;n.friction=e.friction;let r=new a.Sphere(e.radius);r.material=n;let i=new a.Body({mass:e.mass,position:e.position,shape:r});i.material=n,this.physical=i,this.visual=this.getVisualModel({visible:!1,wireframe:!0})}getVisualModel(e){e=l.setDefaults(e,{visible:!0,wireframe:!0});let t=new r.SphereGeometry(this.options.radius),n=new r.MeshLambertMaterial({color:13421772,wireframe:e.wireframe}),i=new r.Mesh(t,n);return i.visible=e.visible,e.wireframe||(i.castShadow=!0,i.receiveShadow=!0),i}},Box:class{constructor(e){let t={mass:0,position:new a.Vec3,size:new a.Vec3(.3,.3,.3),friction:.3};e=l.setDefaults(e,t),this.options=e;let n=new a.Material;n.friction=e.friction;let r=new a.Box(e.size);r.material=n;let i=new a.Body({mass:e.mass,position:e.position,shape:r});i.material=n,this.physical=i,this.visual=this.getVisualModel({visible:!1,wireframe:!0})}getVisualModel(e){e=l.setDefaults(e,{visible:!0,wireframe:!0});let t=new r.BoxGeometry(2*this.options.size.x,2*this.options.size.y,2*this.options.size.z),n=new r.MeshLambertMaterial({color:13421772,wireframe:e.wireframe}),i=new r.Mesh(t,n);return i.visible=e.visible,e.wireframe||(i.castShadow=!0,i.receiveShadow=!0),i}},Capsule:class{constructor(e){let t={mass:0,position:new a.Vec3,height:.5,radius:.3,segments:8,friction:.3};e=l.setDefaults(e,t),this.options=e;let n=new a.Material;n.friction=e.friction;let r=new a.Body({mass:e.mass,position:e.position}),i=new a.Sphere(e.radius);r.material=n,i.material=n,r.addShape(i,new a.Vec3(0,0,0)),r.addShape(i,new a.Vec3(0,e.height/2,0)),r.addShape(i,new a.Vec3(0,-e.height/2,0)),this.physical=r,this.visual=this.getVisualModel({visible:!1,wireframe:!0})}getVisualModel(e){e=l.setDefaults(e,{visible:!0,wireframe:!0});let t=new r.MeshLambertMaterial({color:13421772,wireframe:e.wireframe}),n=l.createCapsuleGeometry(this.options.radius,this.options.height,this.options.segments),i=new r.Mesh(n,t);return i.visible=e.visible,e.wireframe||(i.castShadow=!0,i.receiveShadow=!0),i}},Convex:class{constructor(e,t){this.mesh=e.clone();let n={mass:0,position:e.position,friction:.3};t=l.setDefaults(t,n),this.options=t;let i=new a.Material;i.friction=t.friction,this.mesh.geometry.isBufferGeometry&&(this.mesh.geometry=(new r.Geometry).fromBufferGeometry(this.mesh.geometry));let o=this.mesh.geometry.vertices.map(function(e){return new a.Vec3(e.x,e.y,e.z)}),s=this.mesh.geometry.faces.map(function(e){return[e.a,e.b,e.c]}),u=new a.ConvexPolyhedron(o,s);u.material=i;let c=new a.Body({mass:t.mass,position:t.position,shape:u});c.material=i,this.physical=c,this.visual=this.getVisualModel({visible:!1,wireframe:!0})}getVisualModel(e){e=l.setDefaults(e,{visible:!0,wireframe:!0});let t=new r.MeshLambertMaterial({color:13421772,wireframe:e.wireframe}),n=this.mesh.clone();return n.material=t,n.visible=e.visible,e.wireframe||(n.castShadow=!0,n.receiveShadow=!0),n}},TriMesh:class{constructor(e,t){this.mesh=e.clone();let n={mass:0,position:e.position,friction:.3};t=l.setDefaults(t,n),this.options=t;let i=new a.Material;i.friction=t.friction,this.mesh.geometry.isBufferGeometry&&(this.mesh.geometry=(new r.Geometry).fromBufferGeometry(this.mesh.geometry));let o=Object(U.threeToCannon)(this.mesh,{type:U.threeToCannon.Type.MESH});o.material=i;let s=new a.Body({mass:t.mass,position:t.position,shape:o});s.material=i,this.physical=s,this.visual=this.getVisualModel({visible:!1,wireframe:!0})}getVisualModel(e){e=l.setDefaults(e,{visible:!0,wireframe:!0});let t=new r.MeshLambertMaterial({color:13421772,wireframe:e.wireframe}),n=this.mesh.clone();return n.material=t,n.visible=e.visible,e.wireframe||(n.castShadow=!0,n.receiveShadow=!0),n}}};class D{init(){}update(){}handleAction(e,t,n){"t"==(t=t.toLowerCase())&&1==n&&(this.world.timeScaleTarget<.5?this.world.timeScaleTarget=1:this.world.timeScaleTarget=.3)}handleScroll(e,t){}handleMouseMove(e,t,n){}checkIfWorldIsSet(){void 0===this.world&&console.error("Calling gameMode init() without having specified gameMode's world first: "+this)}scrollTheTimeScale(e){e>0?(this.world.timeScaleTarget/=1.3,this.world.timeScaleTarget<.003&&(this.world.timeScaleTarget=0)):(this.world.timeScaleTarget*=1.3,this.world.timeScaleTarget<.003&&(this.world.timeScaleTarget=.003),this.world.timeScaleTarget=Math.min(this.world.timeScaleTarget,1),this.world.params.Time_Scale>.9&&(this.world.params.Time_Scale*=1.3))}}class B extends D{constructor(e){super(),this.previousGameMode=e,this.movementSpeed=.06,this.keymap={w:{action:"forward"},s:{action:"back"},a:{action:"left"},d:{action:"right"},e:{action:"up"},q:{action:"down"},shift:{action:"fast"}},this.controls={forward:new f.LerpControl,left:new f.LerpControl,right:new f.LerpControl,up:new f.LerpControl,back:new f.LerpControl,down:new f.LerpControl,fast:new f.LerpControl}}init(){this.checkIfWorldIsSet(),this.world.cameraController.target.copy(this.world.camera.position),this.world.cameraController.setRadius(0),this.world.cameraDistanceTarget=.001,this.world.dirLight.target=this.world.camera}handleAction(e,t,n){if(super.handleAction(e,t,n),"f"==(t=t.toLowerCase())&&1==n){let e=new r.Vector3(0,0,-1).applyQuaternion(this.world.camera.quaternion),t=new O;t.setPhysics(new k.Sphere({mass:1,radius:.3,position:(new a.Vec3).copy(this.world.camera.position).vadd(e)})),t.setModelFromPhysicsShape(),this.world.add(t),this.world.balls.push(t),this.world.balls.length>10&&(this.world.remove(this.world.balls[0]),s.a.pull(this.world.balls,this.world.balls[0]))}if(void 0!==this.previousGameMode&&"c"==t&&1==n&&1==e.shiftKey)this.world.gameMode=this.previousGameMode,this.world.gameMode.init();else if(t in this.keymap){this.controls[this.keymap[t].action].value=n}}handleScroll(e,t){this.scrollTheTimeScale(t)}handleMouseMove(e,t,n){this.world.cameraController.move(t,n)}update(){this.world.dirLight.position.set(this.world.camera.position.x+15*this.world.sun.x,this.world.camera.position.y+15*this.world.sun.y,this.world.camera.position.z+15*this.world.sun.z);for(let e in this.controls){let t=this.controls[e];t.floatValue=r.Math.lerp(t.floatValue,+t.value,.3)}let e=this.movementSpeed*(this.controls.fast.value?5:1),t=new r.Vector3(0,1,0),n=new r.Vector3(0,0,-1).applyQuaternion(this.world.camera.quaternion),i=new r.Vector3(1,0,0).applyQuaternion(this.world.camera.quaternion);this.world.cameraController.target.add(n.multiplyScalar(e*(this.controls.forward.floatValue-this.controls.back.floatValue))),this.world.cameraController.target.add(i.multiplyScalar(e*(this.controls.right.floatValue-this.controls.left.floatValue))),this.world.cameraController.target.add(t.multiplyScalar(e*(this.controls.up.floatValue-this.controls.down.floatValue)))}}let X={FreeCameraControls:B,CharacterControls:class extends D{constructor(e){super(),this.character=e,this.keymap={w:{action:"up"},s:{action:"down"},a:{action:"left"},d:{action:"right"},shift:{action:"run"}," ":{action:"jump"},e:{action:"use"},mouse0:{action:"primary"},mouse2:{action:"secondary"},mouse1:{action:"tertiary"}}}init(){this.checkIfWorldIsSet(),this.world.cameraController.setRadius(1.8),this.world.cameraDistanceTarget=1.8,this.world.dirLight.target=this.character}handleAction(e,t,n){if(super.handleAction(e,t,n),"v"==t&&1==n)this.world.cameraDistanceTarget>1.8?this.world.cameraDistanceTarget=1.1:this.world.cameraDistanceTarget>1.3?this.world.cameraDistanceTarget=2.1:this.world.cameraDistanceTarget>0&&(this.world.cameraDistanceTarget=1.6);else if("f"==t&&1==n){let e=(new r.Vector3).copy(this.character.orientation),t=new O;t.setPhysics(new k.Sphere({mass:1,radius:.3,position:(new a.Vec3).copy(this.character.position).vadd(e)})),t.setModelFromPhysicsShape(),this.world.add(t),this.world.balls.push(t),this.world.balls.length>10&&(this.world.remove(this.world.balls[0]),s.a.pull(this.world.balls,this.world.balls[0]))}"c"==(t=t.toLowerCase())&&1==n&&1==e.shiftKey&&(this.character.resetControls(),this.world.setGameMode(new B(this))),t in this.keymap&&this.character.setControl(this.keymap[t].action,n)}handleScroll(e,t){this.scrollTheTimeScale(t)}handleMouseMove(e,t,n){this.world.cameraController.move(t,n)}update(){s.a.includes(this.world.characters,this.character)?(this.character.viewVector=(new r.Vector3).subVectors(this.character.position,this.world.camera.position),this.world.dirLight.position.set(this.character.position.x+15*this.world.sun.x,this.character.position.y+15*this.world.sun.y,this.character.position.z+15*this.world.sun.z),this.world.cameraController.target.set(this.character.position.x,this.character.position.y+this.character.height/1.7,this.character.position.z)):this.world.setGameMode(new B)}}};class V extends r.Object3D{constructor(e){let t={position:new r.Vector3,height:1};e=l.setDefaults(e,t),super(),this.isCharacter=!0,this.height=e.height,this.modelOffset=new r.Vector3,this.visuals=new r.Group,this.add(this.visuals),this.modelContainer=new r.Group,this.modelContainer.position.y=-this.height/2,this.visuals.add(this.modelContainer);let n=l.createCapsuleGeometry(this.height/4,this.height/2,8),i=new r.Mesh(n,new r.MeshLambertMaterial({color:16777215}));i.position.set(0,this.height/2,0),i.castShadow=!0,this.characterModel=i,this.modelContainer.add(i),this.mixer,this.animations=[],this.acceleration=new r.Vector3,this.velocity=new r.Vector3,this.arcadeVelocityInfluence=new r.Vector3,this.arcadeVelocityIsAdditive=!1,this.velocityTarget=new r.Vector3,this.defaultVelocitySimulatorDamping=.8,this.defaultVelocitySimulatorMass=50,this.velocitySimulator=new h.VectorSpringSimulator(60,this.defaultVelocitySimulatorMass,this.defaultVelocitySimulatorDamping),this.moveSpeed=8,this.angularVelocity=0,this.orientation=new r.Vector3(0,0,1),this.orientationTarget=new r.Vector3(0,0,1),this.defaultRotationSimulatorDamping=.5,this.defaultRotationSimulatorMass=10,this.rotationSimulator=new h.RelativeSpringSimulator(60,this.defaultRotationSimulatorMass,this.defaultRotationSimulatorDamping),this.setState(R.Idle),this.viewVector=new r.Vector3,this.setBehaviour(new p.Default),this.controls={up:new f.EventControl,down:new f.EventControl,left:new f.EventControl,right:new f.EventControl,run:new f.EventControl,jump:new f.EventControl,use:new f.EventControl,primary:new f.EventControl,secondary:new f.EventControl,tertiary:new f.EventControl,lastControl:new f.EventControl};let o=new k.Capsule({mass:1,position:(new a.Vec3).copy(e.position),height:.5,radius:.25,segments:8,friction:0});this.characterCapsule=new O,this.characterCapsule.setPhysics(o),this.characterCapsule.physics.physical.character=this,this.characterCapsule.physics.physical.collisionFilterGroup=2,this.characterCapsule.physics.physical.fixedRotation=!0,this.characterCapsule.physics.physical.updateMassProperties(),this.rayResult=new a.RaycastResult,this.rayHasHit=!1,this.rayCastLength=.6,this.raySafeOffset=.01,this.wantsToJump=!1,this.initJumpSpeed=-1,this.groundImpactData={velocity:new a.Vec3};const s=new r.BoxGeometry(.1,.1,.1),u=new r.MeshLambertMaterial({color:16711680});this.raycastBox=new r.Mesh(s,u),this.raycastBox.visible=!1,this.characterCapsule.physics.physical.preStep=this.physicsPreStep,this.characterCapsule.physics.physical.postStep=this.physicsPostStep}setAnimations(e){this.animations=e}setModel(e){this.modelContainer.remove(this.characterModel),this.characterModel=e,this.modelContainer.add(this.characterModel),this.mixer=new r.AnimationMixer(this.characterModel),this.setState(R.Idle),this.charState.changeState()}setArcadeVelocityInfluence(e,t=e,n=e){this.arcadeVelocityInfluence.set(e,t,n)}setModelOffset(e){this.modelOffset.copy(e)}setViewVector(e){this.viewVector.copy(e).normalize()}setState(e){this.charState=new e(this)}setPosition(e,t,n){this.characterCapsule.physics.physical.position=new a.Vec3(e,t,n)}setArcadeVelocity(e,t=0,n=0){this.velocity.z=e,this.velocity.x=t,this.velocity.y=n}setArcadeVelocityTarget(e,t=0,n=0){this.velocityTarget.z=e,this.velocityTarget.x=t,this.velocityTarget.y=n}setOrientationTarget(e){this.orientationTarget.copy(e).setY(0).normalize()}setBehaviour(e){e.character=this,this.behaviour=e}setControl(e,t){let n=this.controls[e];n.value!==t&&(n.value=t,t?n.justPressed=!0:n.justReleased=!0,this.controls.lastControl=n,this.charState.changeState(),n.justPressed=!1,n.justReleased=!1)}takeControl(){void 0!==this.world?this.world.setGameMode(new X.CharacterControls(this)):console.warn("Attempting to take control of a character that doesn't belong to a world.")}resetControls(){this.setControl("up",!1),this.setControl("down",!1),this.setControl("left",!1),this.setControl("right",!1),this.setControl("run",!1),this.setControl("jump",!1),this.setControl("use",!1),this.setControl("primary",!1),this.setControl("secondary",!1),this.setControl("tertiary",!1)}update(e,t){t=l.setDefaults(t,{springRotation:!0,rotationMultiplier:1,springVelocity:!0,rotateModel:!0,updateAnimation:!0}),this.visuals.position.copy(this.modelOffset),t.springVelocity&&this.springMovement(e),t.springRotation&&this.springRotation(e,t.rotationMultiplier),t.rotateModel&&this.rotateModel(),t.updateAnimation&&void 0!=this.mixer&&this.mixer.update(e),this.position.set(this.characterCapsule.physics.physical.interpolatedPosition.x,this.characterCapsule.physics.physical.interpolatedPosition.y-this.height/2,this.characterCapsule.physics.physical.interpolatedPosition.z)}setAnimation(e,t){if(void 0!=this.mixer){let n=this.characterModel.animations,i=r.AnimationClip.findByName(n,e),a=this.mixer.clipAction(i);return this.mixer.stopAllAction(),a.fadeIn(t),a.play(),a._clip.duration}}springMovement(e){this.velocitySimulator.target.copy(this.velocityTarget),this.velocitySimulator.simulate(e),this.velocity.copy(this.velocitySimulator.position),this.acceleration.copy(this.velocitySimulator.velocity)}springRotation(e,t){let n=l.getSignedAngleBetweenVectors(this.orientation,this.orientationTarget);this.rotationSimulator.target=n*t,this.rotationSimulator.simulate(e);let i=this.rotationSimulator.position;this.orientation.applyAxisAngle(new r.Vector3(0,1,0),i),this.angularVelocity=this.rotationSimulator.velocity}getLocalMovementDirection(){const e=this.controls.right.value?-1:0,t=this.controls.left.value?1:0,n=this.controls.up.value?1:0,i=this.controls.down.value?-1:0;return new r.Vector3(e+t,0,n+i)}getCameraRelativeMovementVector(){const e=this.getLocalMovementDirection(),t=new r.Vector3(this.viewVector.x,0,this.viewVector.z);return l.appplyVectorMatrixXZ(t,e)}setCameraRelativeOrientationTarget(){let e=this.getCameraRelativeMovementVector();0==e.x&&0==e.y&&0==e.z?this.setOrientationTarget(this.orientation):this.setOrientationTarget(e)}rotateModel(){this.visuals.lookAt(this.orientation.x,this.visuals.position.y,this.orientation.z),this.visuals.rotateZ(2.3*-this.angularVelocity*this.velocity.length()),this.visuals.position.setY(this.visuals.position.y+Math.cos(Math.abs(2.3*this.angularVelocity*this.velocity.length()))/2)}jump(e=-1){this.wantsToJump=!0,this.initJumpSpeed=e}physicsPreStep(){const e=new a.Vec3(this.position.x,this.position.y,this.position.z),t=new a.Vec3(this.position.x,this.position.y-this.character.rayCastLength-this.character.raySafeOffset,this.position.z);this.character.rayHasHit=this.character.world.physicsWorld.raycastClosest(e,t,{collisionFilterMask:-3,skipBackfaces:!0},this.character.rayResult),this.character.rayHasHit?(this.character.raycastBox.visible&&this.character.raycastBox.position.copy(this.character.rayResult.hitPointWorld),this.position.y=this.character.rayResult.hitPointWorld.y+this.character.rayCastLength):this.character.raycastBox.visible&&this.character.raycastBox.position.set(this.position.x,this.position.y-this.character.rayCastLength-this.character.raySafeOffset,this.position.z)}physicsPostStep(){let e=(new r.Vector3).copy(this.velocity),t=(new r.Vector3).copy(this.character.velocity).multiplyScalar(this.character.moveSpeed);t=l.appplyVectorMatrixXZ(this.character.orientation,t);let n=new r.Vector3;if(this.character.arcadeVelocityIsAdditive){n.copy(e);let i=l.appplyVectorMatrixXZ(this.character.orientation,this.character.velocityTarget),a=(new r.Vector3).copy(t).multiply(this.character.arcadeVelocityInfluence);(Math.abs(e.x)<Math.abs(i.x*this.character.moveSpeed)||l.haveDifferentSigns(e.x,t.x))&&(n.x+=a.x),(Math.abs(e.y)<Math.abs(i.y*this.character.moveSpeed)||l.haveDifferentSigns(e.y,t.y))&&(n.y+=a.y),(Math.abs(e.z)<Math.abs(i.z*this.character.moveSpeed)||l.haveDifferentSigns(e.z,t.z))&&(n.z+=a.z)}else n=new r.Vector3(r.Math.lerp(e.x,t.x,this.character.arcadeVelocityInfluence.x),r.Math.lerp(e.y,t.y,this.character.arcadeVelocityInfluence.y),r.Math.lerp(e.z,t.z,this.character.arcadeVelocityInfluence.z));if(this.character.rayHasHit){n.y=0;let e=new r.Vector3(0,1,0),t=(new r.Vector3).copy(this.character.rayResult.hitNormalWorld),i=(new r.Quaternion).setFromUnitVectors(e,t),a=(new r.Matrix4).makeRotationFromQuaternion(i);n.applyMatrix4(a),this.velocity.copy(n)}else this.velocity.copy(n),this.character.groundImpactData.velocity.copy(this.velocity);this.character.wantsToJump&&(this.character.initJumpSpeed>-1&&(this.velocity.y=0,this.velocity.lengthSquared()<this.character.initJumpSpeed**2&&(this.velocity.normalize(),this.velocity.mult(this.character.initJumpSpeed,this.velocity))),this.velocity.y+=4,this.position.y+=2*this.character.raySafeOffset,this.character.wantsToJump=!1)}}class j{constructor(e,t){this.world=e,this.domElement=t||document.body,this.pointerLock=this.world.params.Pointer_Lock,this.isLocked=!1,this.boundOnMouseDown=(e=>this.onMouseDown(e)),this.boundOnMouseMove=(e=>this.onMouseMove(e)),this.boundOnMouseUp=(e=>this.onMouseUp(e)),this.boundOnMouseWheelMove=(e=>this.onMouseWheelMove(e)),this.boundOnPointerlockChange=(e=>this.onPointerlockChange(e)),this.boundOnPointerlockError=(e=>this.onPointerlockError(e)),this.boundOnKeyDown=(e=>this.onKeyDown(e)),this.boundOnKeyUp=(e=>this.onKeyUp(e)),this.domElement.addEventListener("mousedown",this.boundOnMouseDown,!1),document.addEventListener("wheel",this.boundOnMouseWheelMove,!1),document.addEventListener("pointerlockchange",this.boundOnPointerlockChange,!1),document.addEventListener("pointerlockerror",this.boundOnPointerlockError,!1),document.addEventListener("keydown",this.boundOnKeyDown,!1),document.addEventListener("keyup",this.boundOnKeyUp,!1)}setPointerLock(e){this.pointerLock=e}onPointerlockChange(e){document.pointerLockElement===this.domElement?(this.domElement.addEventListener("mousemove",this.boundOnMouseMove,!1),this.domElement.addEventListener("mouseup",this.boundOnMouseUp,!1),this.isLocked=!0):(this.domElement.removeEventListener("mousemove",this.boundOnMouseMove,!1),this.domElement.removeEventListener("mouseup",this.boundOnMouseUp,!1),this.isLocked=!1)}onPointerlockError(e){console.error("PointerLockControls: Unable to use Pointer Lock API")}onMouseDown(e){this.pointerLock?this.domElement.requestPointerLock():(this.domElement.addEventListener("mousemove",this.boundOnMouseMove,!1),this.domElement.addEventListener("mouseup",this.boundOnMouseUp,!1)),void 0!==this.world.gameMode&&this.world.gameMode.handleAction(e,"mouse"+e.button,!0)}onMouseMove(e){void 0!==this.world.gameMode&&this.world.gameMode.handleMouseMove(e,e.movementX,e.movementY)}onMouseUp(e){this.pointerLock||(this.domElement.removeEventListener("mousemove",this.boundOnMouseMove,!1),this.domElement.removeEventListener("mouseup",this.boundOnMouseUp,!1)),void 0!==this.world.gameMode&&this.world.gameMode.handleAction(e,"mouse"+e.button,!1)}onKeyDown(e){void 0!==this.world.gameMode&&this.world.gameMode.handleAction(e,e.key,!0)}onKeyUp(e){void 0!==this.world.gameMode&&this.world.gameMode.handleAction(e,e.key,!1)}onMouseWheelMove(e){void 0!==this.world.gameMode&&this.world.gameMode.handleScroll(e,e.deltaY)}}class G extends Object{constructor(){super(),this.isItem=!0}}var H={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")},z=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1};Object.assign(z.prototype,{setSize:function(e,t){},render:function(e,t,n,r,i){console.error("THREE.Pass: .render() must be implemented in derived pass.")}});var Y=function(e,t){z.call(this),this.textureID=void 0!==t?t:"tDiffuse",e instanceof r.ShaderMaterial?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=r.UniformsUtils.clone(e.uniforms),this.material=new r.ShaderMaterial({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.camera=new r.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new r.Scene,this.quad=new r.Mesh(new r.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};Y.prototype=Object.assign(Object.create(z.prototype),{constructor:Y,render:function(e,t,n,r,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.quad.material=this.material,this.renderToScreen?e.render(this.scene,this.camera):e.render(this.scene,this.camera,t,this.clear)}});var Q=function(e,t){z.call(this),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1};Q.prototype=Object.assign(Object.create(z.prototype),{constructor:Q,render:function(e,t,n,r,i){var a,o,s=e.context,l=e.state;l.buffers.color.setMask(!1),l.buffers.depth.setMask(!1),l.buffers.color.setLocked(!0),l.buffers.depth.setLocked(!0),this.inverse?(a=0,o=1):(a=1,o=0),l.buffers.stencil.setTest(!0),l.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),l.buffers.stencil.setFunc(s.ALWAYS,a,4294967295),l.buffers.stencil.setClear(o),e.render(this.scene,this.camera,n,this.clear),e.render(this.scene,this.camera,t,this.clear),l.buffers.color.setLocked(!1),l.buffers.depth.setLocked(!1),l.buffers.stencil.setFunc(s.EQUAL,1,4294967295),l.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP)}});var W=function(){z.call(this),this.needsSwap=!1};W.prototype=Object.create(z.prototype),Object.assign(W.prototype,{render:function(e,t,n,r,i){e.state.buffers.stencil.setTest(!1)}});var K=function(e,t){if(this.renderer=e,void 0===t){var n={minFilter:r.LinearFilter,magFilter:r.LinearFilter,format:r.RGBAFormat,stencilBuffer:!1},i=e.getDrawingBufferSize();(t=new r.WebGLRenderTarget(i.width,i.height,n)).texture.name="EffectComposer.rt1"}this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],void 0===H&&console.error("THREE.EffectComposer relies on THREE.CopyShader"),void 0===Y&&console.error("THREE.EffectComposer relies on THREE.ShaderPass"),this.copyPass=new Y(H)};Object.assign(K.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e);var t=this.renderer.getDrawingBufferSize();e.setSize(t.width,t.height)},insertPass:function(e,t){this.passes.splice(t,0,e)},render:function(e){var t,n,r=!1,i=this.passes.length;for(n=0;n<i;n++)if(!1!==(t=this.passes[n]).enabled){if(t.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),t.needsSwap){if(r){var a=this.renderer.context;a.stencilFunc(a.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),a.stencilFunc(a.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==Q&&(t instanceof Q?r=!0:t instanceof W&&(r=!1))}},reset:function(e){if(void 0===e){var t=this.renderer.getDrawingBufferSize();(e=this.renderTarget1.clone()).setSize(t.width,t.height)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this.renderTarget1.setSize(e,t),this.renderTarget2.setSize(e,t);for(var n=0;n<this.passes.length;n++)this.passes[n].setSize(e,t)}});var q={uniforms:{tDiffuse:{value:null},resolution:{value:new r.Vector2(1/1024,1/512)}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["precision highp float;","","uniform sampler2D tDiffuse;","","uniform vec2 resolution;","","varying vec2 vUv;","","// FXAA 3.11 implementation by NVIDIA, ported to WebGL by Agost Biro (biro@archilogic.com)","","//----------------------------------------------------------------------------------","// File:        es3-keplerFXAAassetsshaders/FXAA_DefaultES.frag","// SDK Version: v3.00","// Email:       gameworks@nvidia.com","// Site:        http://developer.nvidia.com/","//","// Copyright (c) 2014-2015, NVIDIA CORPORATION. All rights reserved.","//","// Redistribution and use in source and binary forms, with or without","// modification, are permitted provided that the following conditions","// are met:","//  * Redistributions of source code must retain the above copyright","//    notice, this list of conditions and the following disclaimer.","//  * Redistributions in binary form must reproduce the above copyright","//    notice, this list of conditions and the following disclaimer in the","//    documentation and/or other materials provided with the distribution.","//  * Neither the name of NVIDIA CORPORATION nor the names of its","//    contributors may be used to endorse or promote products derived","//    from this software without specific prior written permission.","//","// THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS ``AS IS'' AND ANY","// EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE","// IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR","// PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT OWNER OR","// CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,","// EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,","// PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR","// PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY","// OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT","// (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE","// OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.","//","//----------------------------------------------------------------------------------","","#define FXAA_PC 1","#define FXAA_GLSL_100 1","#define FXAA_QUALITY_PRESET 12","","#define FXAA_GREEN_AS_LUMA 1","","/*--------------------------------------------------------------------------*/","#ifndef FXAA_PC_CONSOLE","    //","    // The console algorithm for PC is included","    // for developers targeting really low spec machines.","    // Likely better to just run FXAA_PC, and use a really low preset.","    //","    #define FXAA_PC_CONSOLE 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_120","    #define FXAA_GLSL_120 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GLSL_130","    #define FXAA_GLSL_130 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_3","    #define FXAA_HLSL_3 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_4","    #define FXAA_HLSL_4 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_HLSL_5","    #define FXAA_HLSL_5 0","#endif","/*==========================================================================*/","#ifndef FXAA_GREEN_AS_LUMA","    //","    // For those using non-linear color,","    // and either not able to get luma in alpha, or not wanting to,","    // this enables FXAA to run using green as a proxy for luma.","    // So with this enabled, no need to pack luma in alpha.","    //","    // This will turn off AA on anything which lacks some amount of green.","    // Pure red and blue or combination of only R and B, will get no AA.","    //","    // Might want to lower the settings for both,","    //    fxaaConsoleEdgeThresholdMin","    //    fxaaQualityEdgeThresholdMin","    // In order to insure AA does not get turned off on colors","    // which contain a minor amount of green.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_GREEN_AS_LUMA 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_EARLY_EXIT","    //","    // Controls algorithm's early exit path.","    // On PS3 turning this ON adds 2 cycles to the shader.","    // On 360 turning this OFF adds 10ths of a millisecond to the shader.","    // Turning this off on console will result in a more blurry image.","    // So this defaults to on.","    //","    // 1 = On.","    // 0 = Off.","    //","    #define FXAA_EARLY_EXIT 1","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_DISCARD","    //","    // Only valid for PC OpenGL currently.","    // Probably will not work when FXAA_GREEN_AS_LUMA = 1.","    //","    // 1 = Use discard on pixels which don't need AA.","    //     For APIs which enable concurrent TEX+ROP from same surface.","    // 0 = Return unchanged color on pixels which don't need AA.","    //","    #define FXAA_DISCARD 0","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_FAST_PIXEL_OFFSET","    //","    // Used for GLSL 120 only.","    //","    // 1 = GL API supports fast pixel offsets","    // 0 = do not use fast pixel offsets","    //","    #ifdef GL_EXT_gpu_shader4","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_FAST_PIXEL_OFFSET 1","    #endif","    #ifndef FXAA_FAST_PIXEL_OFFSET","        #define FXAA_FAST_PIXEL_OFFSET 0","    #endif","#endif","/*--------------------------------------------------------------------------*/","#ifndef FXAA_GATHER4_ALPHA","    //","    // 1 = API supports gather4 on alpha channel.","    // 0 = API does not support gather4 on alpha channel.","    //","    #if (FXAA_HLSL_5 == 1)","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_ARB_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifdef GL_NV_gpu_shader5","        #define FXAA_GATHER4_ALPHA 1","    #endif","    #ifndef FXAA_GATHER4_ALPHA","        #define FXAA_GATHER4_ALPHA 0","    #endif","#endif","","","/*============================================================================","                        FXAA QUALITY - TUNING KNOBS","------------------------------------------------------------------------------","NOTE the other tuning knobs are now in the shader function inputs!","============================================================================*/","#ifndef FXAA_QUALITY_PRESET","    //","    // Choose the quality preset.","    // This needs to be compiled into the shader as it effects code.","    // Best option to include multiple presets is to","    // in each shader define the preset, then include this file.","    //","    // OPTIONS","    // -----------------------------------------------------------------------","    // 10 to 15 - default medium dither (10=fastest, 15=highest quality)","    // 20 to 29 - less dither, more expensive (20=fastest, 29=highest quality)","    // 39       - no dither, very expensive","    //","    // NOTES","    // -----------------------------------------------------------------------","    // 12 = slightly faster then FXAA 3.9 and higher edge quality (default)","    // 13 = about same speed as FXAA 3.9 and better than 12","    // 23 = closest to FXAA 3.9 visually and performance wise","    //  _ = the lowest digit is directly related to performance","    // _  = the highest digit is directly related to style","    //","    #define FXAA_QUALITY_PRESET 12","#endif","","","/*============================================================================","","                           FXAA QUALITY - PRESETS","","============================================================================*/","","/*============================================================================","                     FXAA QUALITY - MEDIUM DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 10)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 3.0","    #define FXAA_QUALITY_P2 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 11)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 3.0","    #define FXAA_QUALITY_P3 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 12)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 4.0","    #define FXAA_QUALITY_P4 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 13)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 4.0","    #define FXAA_QUALITY_P5 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 14)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 4.0","    #define FXAA_QUALITY_P6 12.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 15)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 12.0","#endif","","/*============================================================================","                     FXAA QUALITY - LOW DITHER PRESETS","============================================================================*/","#if (FXAA_QUALITY_PRESET == 20)","    #define FXAA_QUALITY_PS 3","    #define FXAA_QUALITY_P0 1.5","    #define FXAA_QUALITY_P1 2.0","    #define FXAA_QUALITY_P2 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 21)","    #define FXAA_QUALITY_PS 4","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 22)","    #define FXAA_QUALITY_PS 5","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 23)","    #define FXAA_QUALITY_PS 6","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 24)","    #define FXAA_QUALITY_PS 7","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 3.0","    #define FXAA_QUALITY_P6 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 25)","    #define FXAA_QUALITY_PS 8","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 4.0","    #define FXAA_QUALITY_P7 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 26)","    #define FXAA_QUALITY_PS 9","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 4.0","    #define FXAA_QUALITY_P8 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 27)","    #define FXAA_QUALITY_PS 10","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 4.0","    #define FXAA_QUALITY_P9 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 28)","    #define FXAA_QUALITY_PS 11","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 4.0","    #define FXAA_QUALITY_P10 8.0","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_QUALITY_PRESET == 29)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.5","    #define FXAA_QUALITY_P2 2.0","    #define FXAA_QUALITY_P3 2.0","    #define FXAA_QUALITY_P4 2.0","    #define FXAA_QUALITY_P5 2.0","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","/*============================================================================","                     FXAA QUALITY - EXTREME QUALITY","============================================================================*/","#if (FXAA_QUALITY_PRESET == 39)","    #define FXAA_QUALITY_PS 12","    #define FXAA_QUALITY_P0 1.0","    #define FXAA_QUALITY_P1 1.0","    #define FXAA_QUALITY_P2 1.0","    #define FXAA_QUALITY_P3 1.0","    #define FXAA_QUALITY_P4 1.0","    #define FXAA_QUALITY_P5 1.5","    #define FXAA_QUALITY_P6 2.0","    #define FXAA_QUALITY_P7 2.0","    #define FXAA_QUALITY_P8 2.0","    #define FXAA_QUALITY_P9 2.0","    #define FXAA_QUALITY_P10 4.0","    #define FXAA_QUALITY_P11 8.0","#endif","","","","/*============================================================================","","                                API PORTING","","============================================================================*/","#if (FXAA_GLSL_100 == 1) || (FXAA_GLSL_120 == 1) || (FXAA_GLSL_130 == 1)","    #define FxaaBool bool","    #define FxaaDiscard discard","    #define FxaaFloat float","    #define FxaaFloat2 vec2","    #define FxaaFloat3 vec3","    #define FxaaFloat4 vec4","    #define FxaaHalf float","    #define FxaaHalf2 vec2","    #define FxaaHalf3 vec3","    #define FxaaHalf4 vec4","    #define FxaaInt2 ivec2","    #define FxaaSat(x) clamp(x, 0.0, 1.0)","    #define FxaaTex sampler2D","#else","    #define FxaaBool bool","    #define FxaaDiscard clip(-1)","    #define FxaaFloat float","    #define FxaaFloat2 float2","    #define FxaaFloat3 float3","    #define FxaaFloat4 float4","    #define FxaaHalf half","    #define FxaaHalf2 half2","    #define FxaaHalf3 half3","    #define FxaaHalf4 half4","    #define FxaaSat(x) saturate(x)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_100 == 1)","  #define FxaaTexTop(t, p) texture2D(t, p, 0.0)","  #define FxaaTexOff(t, p, o, r) texture2D(t, p + (o * r), 0.0)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_120 == 1)","    // Requires,","    //  #version 120","    // And at least,","    //  #extension GL_EXT_gpu_shader4 : enable","    //  (or set FXAA_FAST_PIXEL_OFFSET 1 to work like DX9)","    #define FxaaTexTop(t, p) texture2DLod(t, p, 0.0)","    #if (FXAA_FAST_PIXEL_OFFSET == 1)","        #define FxaaTexOff(t, p, o, r) texture2DLodOffset(t, p, 0.0, o)","    #else","        #define FxaaTexOff(t, p, o, r) texture2DLod(t, p + (o * r), 0.0)","    #endif","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_GLSL_130 == 1)",'    // Requires "#version 130" or better',"    #define FxaaTexTop(t, p) textureLod(t, p, 0.0)","    #define FxaaTexOff(t, p, o, r) textureLodOffset(t, p, 0.0, o)","    #if (FXAA_GATHER4_ALPHA == 1)","        // use #extension GL_ARB_gpu_shader5 : enable","        #define FxaaTexAlpha4(t, p) textureGather(t, p, 3)","        #define FxaaTexOffAlpha4(t, p, o) textureGatherOffset(t, p, o, 3)","        #define FxaaTexGreen4(t, p) textureGather(t, p, 1)","        #define FxaaTexOffGreen4(t, p, o) textureGatherOffset(t, p, o, 1)","    #endif","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_3 == 1)","    #define FxaaInt2 float2","    #define FxaaTex sampler2D","    #define FxaaTexTop(t, p) tex2Dlod(t, float4(p, 0.0, 0.0))","    #define FxaaTexOff(t, p, o, r) tex2Dlod(t, float4(p + (o * r), 0, 0))","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_4 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","#endif","/*--------------------------------------------------------------------------*/","#if (FXAA_HLSL_5 == 1)","    #define FxaaInt2 int2","    struct FxaaTex { SamplerState smpl; Texture2D tex; };","    #define FxaaTexTop(t, p) t.tex.SampleLevel(t.smpl, p, 0.0)","    #define FxaaTexOff(t, p, o, r) t.tex.SampleLevel(t.smpl, p, 0.0, o)","    #define FxaaTexAlpha4(t, p) t.tex.GatherAlpha(t.smpl, p)","    #define FxaaTexOffAlpha4(t, p, o) t.tex.GatherAlpha(t.smpl, p, o)","    #define FxaaTexGreen4(t, p) t.tex.GatherGreen(t.smpl, p)","    #define FxaaTexOffGreen4(t, p, o) t.tex.GatherGreen(t.smpl, p, o)","#endif","","","/*============================================================================","                   GREEN AS LUMA OPTION SUPPORT FUNCTION","============================================================================*/","#if (FXAA_GREEN_AS_LUMA == 0)","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.w; }","#else","    FxaaFloat FxaaLuma(FxaaFloat4 rgba) { return rgba.y; }","#endif","","","","","/*============================================================================","","                             FXAA3 QUALITY - PC","","============================================================================*/","#if (FXAA_PC == 1)","/*--------------------------------------------------------------------------*/","FxaaFloat4 FxaaPixelShader(","    //","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy} = center of pixel","    FxaaFloat2 pos,","    //","    // Used only for FXAA Console, and not used on the 360 version.","    // Use noperspective interpolation here (turn off perspective interpolation).","    // {xy_} = upper left of pixel","    // {_zw} = lower right of pixel","    FxaaFloat4 fxaaConsolePosPos,","    //","    // Input color texture.","    // {rgb_} = color in linear or perceptual color space","    // if (FXAA_GREEN_AS_LUMA == 0)","    //     {__a} = luma in perceptual color space (not linear)","    FxaaTex tex,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 2nd sampler.","    // This sampler needs to have an exponent bias of -1.","    FxaaTex fxaaConsole360TexExpBiasNegOne,","    //","    // Only used on the optimized 360 version of FXAA Console.",'    // For everything but 360, just use the same input here as for "tex".',"    // For 360, same texture, just alias with a 3nd sampler.","    // This sampler needs to have an exponent bias of -2.","    FxaaTex fxaaConsole360TexExpBiasNegTwo,","    //","    // Only used on FXAA Quality.","    // This must be from a constant/uniform.","    // {x_} = 1.0/screenWidthInPixels","    // {_y} = 1.0/screenHeightInPixels","    FxaaFloat2 fxaaQualityRcpFrame,","    //","    // Only used on FXAA Console.","    // This must be from a constant/uniform.","    // This effects sub-pixel AA quality and inversely sharpness.","    //   Where N ranges between,","    //     N = 0.50 (default)","    //     N = 0.33 (sharper)","    // {x__} = -N/screenWidthInPixels","    // {_y_} = -N/screenHeightInPixels","    // {_z_} =  N/screenWidthInPixels","    // {__w} =  N/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt,","    //","    // Only used on FXAA Console.","    // Not used on 360, but used on PS3 and PC.","    // This must be from a constant/uniform.","    // {x__} = -2.0/screenWidthInPixels","    // {_y_} = -2.0/screenHeightInPixels","    // {_z_} =  2.0/screenWidthInPixels","    // {__w} =  2.0/screenHeightInPixels","    FxaaFloat4 fxaaConsoleRcpFrameOpt2,","    //","    // Only used on FXAA Console.","    // Only used on 360 in place of fxaaConsoleRcpFrameOpt2.","    // This must be from a constant/uniform.","    // {x__} =  8.0/screenWidthInPixels","    // {_y_} =  8.0/screenHeightInPixels","    // {_z_} = -4.0/screenWidthInPixels","    // {__w} = -4.0/screenHeightInPixels","    FxaaFloat4 fxaaConsole360RcpFrameOpt2,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_SUBPIX define.","    // It is here now to allow easier tuning.","    // Choose the amount of sub-pixel aliasing removal.","    // This can effect sharpness.","    //   1.00 - upper limit (softer)","    //   0.75 - default amount of filtering","    //   0.50 - lower limit (sharper, less sub-pixel aliasing removal)","    //   0.25 - almost off","    //   0.00 - completely off","    FxaaFloat fxaaQualitySubpix,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // The minimum amount of local contrast required to apply algorithm.","    //   0.333 - too little (faster)","    //   0.250 - low quality","    //   0.166 - default","    //   0.125 - high quality","    //   0.063 - overkill (slower)","    FxaaFloat fxaaQualityEdgeThreshold,","    //","    // Only used on FXAA Quality.","    // This used to be the FXAA_QUALITY_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    //   0.0833 - upper limit (default, the start of visible unfiltered edges)","    //   0.0625 - high quality (faster)","    //   0.0312 - visible limit (slower)","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaQualityEdgeThresholdMin,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_SHARPNESS define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_SHARPNESS for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only three safe values here: 2 and 4 and 8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // For all other platforms can be a non-power of two.","    //   8.0 is sharper (default!!!)","    //   4.0 is softer","    //   2.0 is really soft (good only for vector graphics inputs)","    FxaaFloat fxaaConsoleEdgeSharpness,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD define.","    // It is here now to allow easier tuning.","    // This does not effect PS3, as this needs to be compiled in.","    //   Use FXAA_CONSOLE_PS3_EDGE_THRESHOLD for PS3.","    //   Due to the PS3 being ALU bound,","    //   there are only two safe values here: 1/4 and 1/8.","    //   These options use the shaders ability to a free *|/ by 2|4|8.","    // The console setting has a different mapping than the quality setting.","    // Other platforms can use other values.","    //   0.125 leaves less aliasing, but is softer (default!!!)","    //   0.25 leaves more aliasing, and is sharper","    FxaaFloat fxaaConsoleEdgeThreshold,","    //","    // Only used on FXAA Console.","    // This used to be the FXAA_CONSOLE_EDGE_THRESHOLD_MIN define.","    // It is here now to allow easier tuning.","    // Trims the algorithm from processing darks.","    // The console setting has a different mapping than the quality setting.","    // This only applies when FXAA_EARLY_EXIT is 1.","    // This does not apply to PS3,","    // PS3 was simplified to avoid more shader instructions.","    //   0.06 - faster but more aliasing in darks","    //   0.05 - default","    //   0.04 - slower and less aliasing in darks","    // Special notes when using FXAA_GREEN_AS_LUMA,","    //   Likely want to set this to zero.","    //   As colors that are mostly not-green","    //   will appear very dark in the green channel!","    //   Tune by looking at mostly non-green content,","    //   then start at zero and increase until aliasing is a problem.","    FxaaFloat fxaaConsoleEdgeThresholdMin,","    //","    // Extra constants for 360 FXAA Console only.","    // Use zeros or anything else for other platforms.","    // These must be in physical constant registers and NOT immedates.","    // Immedates will result in compiler un-optimizing.","    // {xyzw} = float4(1.0, -1.0, 0.25, -0.25)","    FxaaFloat4 fxaaConsole360ConstDir",") {","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posM;","    posM.x = pos.x;","    posM.y = pos.y;","    #if (FXAA_GATHER4_ALPHA == 1)","        #if (FXAA_DISCARD == 0)","            FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","            #if (FXAA_GREEN_AS_LUMA == 0)","                #define lumaM rgbyM.w","            #else","                #define lumaM rgbyM.y","            #endif","        #endif","        #if (FXAA_GREEN_AS_LUMA == 0)","            FxaaFloat4 luma4A = FxaaTexAlpha4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffAlpha4(tex, posM, FxaaInt2(-1, -1));","        #else","            FxaaFloat4 luma4A = FxaaTexGreen4(tex, posM);","            FxaaFloat4 luma4B = FxaaTexOffGreen4(tex, posM, FxaaInt2(-1, -1));","        #endif","        #if (FXAA_DISCARD == 1)","            #define lumaM luma4A.w","        #endif","        #define lumaE luma4A.z","        #define lumaS luma4A.x","        #define lumaSE luma4A.y","        #define lumaNW luma4B.w","        #define lumaN luma4B.z","        #define lumaW luma4B.x","    #else","        FxaaFloat4 rgbyM = FxaaTexTop(tex, posM);","        #if (FXAA_GREEN_AS_LUMA == 0)","            #define lumaM rgbyM.w","        #else","            #define lumaM rgbyM.y","        #endif","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 0.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 0.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 0.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaS = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaN = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 0,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 0), fxaaQualityRcpFrame.xy));","        #endif","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat maxSM = max(lumaS, lumaM);","    FxaaFloat minSM = min(lumaS, lumaM);","    FxaaFloat maxESM = max(lumaE, maxSM);","    FxaaFloat minESM = min(lumaE, minSM);","    FxaaFloat maxWN = max(lumaN, lumaW);","    FxaaFloat minWN = min(lumaN, lumaW);","    FxaaFloat rangeMax = max(maxWN, maxESM);","    FxaaFloat rangeMin = min(minWN, minESM);","    FxaaFloat rangeMaxScaled = rangeMax * fxaaQualityEdgeThreshold;","    FxaaFloat range = rangeMax - rangeMin;","    FxaaFloat rangeMaxClamped = max(fxaaQualityEdgeThresholdMin, rangeMaxScaled);","    FxaaBool earlyExit = range < rangeMaxClamped;","/*--------------------------------------------------------------------------*/","    if(earlyExit)","        #if (FXAA_DISCARD == 1)","            FxaaDiscard;","        #else","            return rgbyM;","        #endif","/*--------------------------------------------------------------------------*/","    #if (FXAA_GATHER4_ALPHA == 0)","        #if (FXAA_GLSL_100 == 1)","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0, 1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2( 1.0,-1.0), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaFloat2(-1.0, 1.0), fxaaQualityRcpFrame.xy));","        #else","          FxaaFloat lumaNW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1, 1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2( 1,-1), fxaaQualityRcpFrame.xy));","          FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","        #endif","    #else","        FxaaFloat lumaNE = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(1, -1), fxaaQualityRcpFrame.xy));","        FxaaFloat lumaSW = FxaaLuma(FxaaTexOff(tex, posM, FxaaInt2(-1, 1), fxaaQualityRcpFrame.xy));","    #endif","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNS = lumaN + lumaS;","    FxaaFloat lumaWE = lumaW + lumaE;","    FxaaFloat subpixRcpRange = 1.0/range;","    FxaaFloat subpixNSWE = lumaNS + lumaWE;","    FxaaFloat edgeHorz1 = (-2.0 * lumaM) + lumaNS;","    FxaaFloat edgeVert1 = (-2.0 * lumaM) + lumaWE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNESE = lumaNE + lumaSE;","    FxaaFloat lumaNWNE = lumaNW + lumaNE;","    FxaaFloat edgeHorz2 = (-2.0 * lumaE) + lumaNESE;","    FxaaFloat edgeVert2 = (-2.0 * lumaN) + lumaNWNE;","/*--------------------------------------------------------------------------*/","    FxaaFloat lumaNWSW = lumaNW + lumaSW;","    FxaaFloat lumaSWSE = lumaSW + lumaSE;","    FxaaFloat edgeHorz4 = (abs(edgeHorz1) * 2.0) + abs(edgeHorz2);","    FxaaFloat edgeVert4 = (abs(edgeVert1) * 2.0) + abs(edgeVert2);","    FxaaFloat edgeHorz3 = (-2.0 * lumaW) + lumaNWSW;","    FxaaFloat edgeVert3 = (-2.0 * lumaS) + lumaSWSE;","    FxaaFloat edgeHorz = abs(edgeHorz3) + edgeHorz4;","    FxaaFloat edgeVert = abs(edgeVert3) + edgeVert4;","/*--------------------------------------------------------------------------*/","    FxaaFloat subpixNWSWNESE = lumaNWSW + lumaNESE;","    FxaaFloat lengthSign = fxaaQualityRcpFrame.x;","    FxaaBool horzSpan = edgeHorz >= edgeVert;","    FxaaFloat subpixA = subpixNSWE * 2.0 + subpixNWSWNESE;","/*--------------------------------------------------------------------------*/","    if(!horzSpan) lumaN = lumaW;","    if(!horzSpan) lumaS = lumaE;","    if(horzSpan) lengthSign = fxaaQualityRcpFrame.y;","    FxaaFloat subpixB = (subpixA * (1.0/12.0)) - lumaM;","/*--------------------------------------------------------------------------*/","    FxaaFloat gradientN = lumaN - lumaM;","    FxaaFloat gradientS = lumaS - lumaM;","    FxaaFloat lumaNN = lumaN + lumaM;","    FxaaFloat lumaSS = lumaS + lumaM;","    FxaaBool pairN = abs(gradientN) >= abs(gradientS);","    FxaaFloat gradient = max(abs(gradientN), abs(gradientS));","    if(pairN) lengthSign = -lengthSign;","    FxaaFloat subpixC = FxaaSat(abs(subpixB) * subpixRcpRange);","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posB;","    posB.x = posM.x;","    posB.y = posM.y;","    FxaaFloat2 offNP;","    offNP.x = (!horzSpan) ? 0.0 : fxaaQualityRcpFrame.x;","    offNP.y = ( horzSpan) ? 0.0 : fxaaQualityRcpFrame.y;","    if(!horzSpan) posB.x += lengthSign * 0.5;","    if( horzSpan) posB.y += lengthSign * 0.5;","/*--------------------------------------------------------------------------*/","    FxaaFloat2 posN;","    posN.x = posB.x - offNP.x * FXAA_QUALITY_P0;","    posN.y = posB.y - offNP.y * FXAA_QUALITY_P0;","    FxaaFloat2 posP;","    posP.x = posB.x + offNP.x * FXAA_QUALITY_P0;","    posP.y = posB.y + offNP.y * FXAA_QUALITY_P0;","    FxaaFloat subpixD = ((-2.0)*subpixC) + 3.0;","    FxaaFloat lumaEndN = FxaaLuma(FxaaTexTop(tex, posN));","    FxaaFloat subpixE = subpixC * subpixC;","    FxaaFloat lumaEndP = FxaaLuma(FxaaTexTop(tex, posP));","/*--------------------------------------------------------------------------*/","    if(!pairN) lumaNN = lumaSS;","    FxaaFloat gradientScaled = gradient * 1.0/4.0;","    FxaaFloat lumaMM = lumaM - lumaNN * 0.5;","    FxaaFloat subpixF = subpixD * subpixE;","    FxaaBool lumaMLTZero = lumaMM < 0.0;","/*--------------------------------------------------------------------------*/","    lumaEndN -= lumaNN * 0.5;","    lumaEndP -= lumaNN * 0.5;","    FxaaBool doneN = abs(lumaEndN) >= gradientScaled;","    FxaaBool doneP = abs(lumaEndP) >= gradientScaled;","    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P1;","    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P1;","    FxaaBool doneNP = (!doneN) || (!doneP);","    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P1;","    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P1;","/*--------------------------------------------------------------------------*/","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P2;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P2;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P2;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P2;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 3)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P3;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P3;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P3;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P3;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 4)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P4;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P4;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P4;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P4;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 5)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P5;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P5;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P5;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P5;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 6)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P6;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P6;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P6;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P6;","/*--------------------------------------------------------------------------*/","                        #if (FXAA_QUALITY_PS > 7)","                        if(doneNP) {","                            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                            doneN = abs(lumaEndN) >= gradientScaled;","                            doneP = abs(lumaEndP) >= gradientScaled;","                            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P7;","                            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P7;","                            doneNP = (!doneN) || (!doneP);","                            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P7;","                            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P7;","/*--------------------------------------------------------------------------*/","    #if (FXAA_QUALITY_PS > 8)","    if(doneNP) {","        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","        doneN = abs(lumaEndN) >= gradientScaled;","        doneP = abs(lumaEndP) >= gradientScaled;","        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P8;","        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P8;","        doneNP = (!doneN) || (!doneP);","        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P8;","        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P8;","/*--------------------------------------------------------------------------*/","        #if (FXAA_QUALITY_PS > 9)","        if(doneNP) {","            if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","            if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","            if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","            if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","            doneN = abs(lumaEndN) >= gradientScaled;","            doneP = abs(lumaEndP) >= gradientScaled;","            if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P9;","            if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P9;","            doneNP = (!doneN) || (!doneP);","            if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P9;","            if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P9;","/*--------------------------------------------------------------------------*/","            #if (FXAA_QUALITY_PS > 10)","            if(doneNP) {","                if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                doneN = abs(lumaEndN) >= gradientScaled;","                doneP = abs(lumaEndP) >= gradientScaled;","                if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P10;","                if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P10;","                doneNP = (!doneN) || (!doneP);","                if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P10;","                if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P10;","/*--------------------------------------------------------------------------*/","                #if (FXAA_QUALITY_PS > 11)","                if(doneNP) {","                    if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                    if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                    if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                    if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                    doneN = abs(lumaEndN) >= gradientScaled;","                    doneP = abs(lumaEndP) >= gradientScaled;","                    if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P11;","                    if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P11;","                    doneNP = (!doneN) || (!doneP);","                    if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P11;","                    if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P11;","/*--------------------------------------------------------------------------*/","                    #if (FXAA_QUALITY_PS > 12)","                    if(doneNP) {","                        if(!doneN) lumaEndN = FxaaLuma(FxaaTexTop(tex, posN.xy));","                        if(!doneP) lumaEndP = FxaaLuma(FxaaTexTop(tex, posP.xy));","                        if(!doneN) lumaEndN = lumaEndN - lumaNN * 0.5;","                        if(!doneP) lumaEndP = lumaEndP - lumaNN * 0.5;","                        doneN = abs(lumaEndN) >= gradientScaled;","                        doneP = abs(lumaEndP) >= gradientScaled;","                        if(!doneN) posN.x -= offNP.x * FXAA_QUALITY_P12;","                        if(!doneN) posN.y -= offNP.y * FXAA_QUALITY_P12;","                        doneNP = (!doneN) || (!doneP);","                        if(!doneP) posP.x += offNP.x * FXAA_QUALITY_P12;","                        if(!doneP) posP.y += offNP.y * FXAA_QUALITY_P12;","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","    #endif","/*--------------------------------------------------------------------------*/","                        }","                        #endif","/*--------------------------------------------------------------------------*/","                    }","                    #endif","/*--------------------------------------------------------------------------*/","                }","                #endif","/*--------------------------------------------------------------------------*/","            }","            #endif","/*--------------------------------------------------------------------------*/","        }","        #endif","/*--------------------------------------------------------------------------*/","    }","/*--------------------------------------------------------------------------*/","    FxaaFloat dstN = posM.x - posN.x;","    FxaaFloat dstP = posP.x - posM.x;","    if(!horzSpan) dstN = posM.y - posN.y;","    if(!horzSpan) dstP = posP.y - posM.y;","/*--------------------------------------------------------------------------*/","    FxaaBool goodSpanN = (lumaEndN < 0.0) != lumaMLTZero;","    FxaaFloat spanLength = (dstP + dstN);","    FxaaBool goodSpanP = (lumaEndP < 0.0) != lumaMLTZero;","    FxaaFloat spanLengthRcp = 1.0/spanLength;","/*--------------------------------------------------------------------------*/","    FxaaBool directionN = dstN < dstP;","    FxaaFloat dst = min(dstN, dstP);","    FxaaBool goodSpan = directionN ? goodSpanN : goodSpanP;","    FxaaFloat subpixG = subpixF * subpixF;","    FxaaFloat pixelOffset = (dst * (-spanLengthRcp)) + 0.5;","    FxaaFloat subpixH = subpixG * fxaaQualitySubpix;","/*--------------------------------------------------------------------------*/","    FxaaFloat pixelOffsetGood = goodSpan ? pixelOffset : 0.0;","    FxaaFloat pixelOffsetSubpix = max(pixelOffsetGood, subpixH);","    if(!horzSpan) posM.x += pixelOffsetSubpix * lengthSign;","    if( horzSpan) posM.y += pixelOffsetSubpix * lengthSign;","    #if (FXAA_DISCARD == 1)","        return FxaaTexTop(tex, posM);","    #else","        return FxaaFloat4(FxaaTexTop(tex, posM).xyz, lumaM);","    #endif","}","/*==========================================================================*/","#endif","","void main() {","  gl_FragColor = FxaaPixelShader(","    vUv,","    vec4(0.0),","    tDiffuse,","    tDiffuse,","    tDiffuse,","    resolution,","    vec4(0.0),","    vec4(0.0),","    vec4(0.0),","    0.75,","    0.166,","    0.0833,","    0.0,","    0.0,","    0.0,","    vec4(0.0)","  );","","  // TODO avoid querying texture twice for same texel","  gl_FragColor.a = texture2D(tDiffuse, vUv).a;","}"].join("\n")},Z=function(e,t,n,r,i){z.call(this),this.scene=e,this.camera=t,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=void 0!==i?i:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1};Z.prototype=Object.assign(Object.create(z.prototype),{constructor:Z,render:function(e,t,n,r,i){var a,o,s=e.autoClear;e.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor&&(a=e.getClearColor().getHex(),o=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.render(this.scene,this.camera,this.renderToScreen?null:n,this.clear),this.clearColor&&e.setClearColor(a,o),this.scene.overrideMaterial=null,e.autoClear=s}});var J=function(){var e=J.SkyShader,t=new r.ShaderMaterial({fragmentShader:e.fragmentShader,vertexShader:e.vertexShader,uniforms:r.UniformsUtils.clone(e.uniforms),side:r.BackSide});r.Mesh.call(this,new r.SphereBufferGeometry(1,12,8),t)};J.prototype=Object.create(r.Mesh.prototype),J.SkyShader={uniforms:{luminance:{value:1},turbidity:{value:2},rayleigh:{value:1},mieCoefficient:{value:.003},mieDirectionalG:{value:.95},sunPosition:{value:new r.Vector3}},vertexShader:["uniform vec3 sunPosition;","uniform float rayleigh;","uniform float turbidity;","uniform float mieCoefficient;","varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","const vec3 up = vec3( 0.0, 1.0, 0.0 );","const float e = 2.71828182845904523536028747135266249775724709369995957;","const float pi = 3.141592653589793238462643383279502884197169;","const vec3 lambda = vec3( 680E-9, 550E-9, 450E-9 );","const vec3 totalRayleigh = vec3( 5.804542996261093E-6, 1.3562911419845635E-5, 3.0265902468824876E-5 );","const float v = 4.0;","const vec3 K = vec3( 0.686, 0.678, 0.666 );","const vec3 MieConst = vec3( 1.8399918514433978E14, 2.7798023919660528E14, 4.0790479543861094E14 );","const float cutoffAngle = 1.6110731556870734;","const float steepness = 1.5;","const float EE = 1000.0;","float sunIntensity( float zenithAngleCos ) {","\tzenithAngleCos = clamp( zenithAngleCos, -1.0, 1.0 );","\treturn EE * max( 0.0, 1.0 - pow( e, -( ( cutoffAngle - acos( zenithAngleCos ) ) / steepness ) ) );","}","vec3 totalMie( float T ) {","\tfloat c = ( 0.2 * T ) * 10E-18;","\treturn 0.434 * c * MieConst;","}","void main() {","\tvec4 worldPosition = modelMatrix * vec4( position, 1.0 );","\tvWorldPosition = worldPosition.xyz;","\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","\tvSunDirection = normalize( sunPosition );","\tvSunE = sunIntensity( dot( vSunDirection, up ) );","\tvSunfade = 1.0 - clamp( 1.0 - exp( ( sunPosition.y / 450000.0 ) ), 0.0, 1.0 );","\tfloat rayleighCoefficient = rayleigh - ( 1.0 * ( 1.0 - vSunfade ) );","\tvBetaR = totalRayleigh * rayleighCoefficient;","\tvBetaM = totalMie( turbidity ) * mieCoefficient;","}"].join("\n"),fragmentShader:["varying vec3 vWorldPosition;","varying vec3 vSunDirection;","varying float vSunfade;","varying vec3 vBetaR;","varying vec3 vBetaM;","varying float vSunE;","uniform float luminance;","uniform float mieDirectionalG;","const vec3 cameraPos = vec3( 0.0, 0.0, 0.0 );","const float pi = 3.141592653589793238462643383279502884197169;","const float n = 1.0003;","const float N = 2.545E25;","const float rayleighZenithLength = 8.4E3;","const float mieZenithLength = 1.25E3;","const vec3 up = vec3( 0.0, 1.0, 0.0 );","const float sunAngularDiameterCos = 0.999956676946448443553574619906976478926848692873900859324;","const float THREE_OVER_SIXTEENPI = 0.05968310365946075;","const float ONE_OVER_FOURPI = 0.07957747154594767;","float rayleighPhase( float cosTheta ) {","\treturn THREE_OVER_SIXTEENPI * ( 1.0 + pow( cosTheta, 2.0 ) );","}","float hgPhase( float cosTheta, float g ) {","\tfloat g2 = pow( g, 2.0 );","\tfloat inverse = 1.0 / pow( 1.0 - 2.0 * g * cosTheta + g2, 1.5 );","\treturn ONE_OVER_FOURPI * ( ( 1.0 - g2 ) * inverse );","}","const float A = 0.15;","const float B = 0.50;","const float C = 0.10;","const float D = 0.20;","const float E = 0.02;","const float F = 0.30;","const float whiteScale = 1.0748724675633854;","vec3 Uncharted2Tonemap( vec3 x ) {","\treturn ( ( x * ( A * x + C * B ) + D * E ) / ( x * ( A * x + B ) + D * F ) ) - E / F;","}","void main() {","\tfloat zenithAngle = acos( max( 0.0, dot( up, normalize( vWorldPosition - cameraPos ) ) ) );","\tfloat inverse = 1.0 / ( cos( zenithAngle ) + 0.15 * pow( 93.885 - ( ( zenithAngle * 180.0 ) / pi ), -1.253 ) );","\tfloat sR = rayleighZenithLength * inverse;","\tfloat sM = mieZenithLength * inverse;","\tvec3 Fex = exp( -( vBetaR * sR + vBetaM * sM ) );","\tfloat cosTheta = dot( normalize( vWorldPosition - cameraPos ), vSunDirection );","\tfloat rPhase = rayleighPhase( cosTheta * 0.5 + 0.5 );","\tvec3 betaRTheta = vBetaR * rPhase;","\tfloat mPhase = hgPhase( cosTheta, mieDirectionalG );","\tvec3 betaMTheta = vBetaM * mPhase;","\tvec3 Lin = pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * ( 1.0 - Fex ), vec3( 1.5 ) );","\tLin *= mix( vec3( 1.0 ), pow( vSunE * ( ( betaRTheta + betaMTheta ) / ( vBetaR + vBetaM ) ) * Fex, vec3( 1.0 / 2.0 ) ), clamp( pow( 1.0 - dot( up, vSunDirection ), 5.0 ), 0.0, 1.0 ) );","\tvec3 direction = normalize( vWorldPosition - cameraPos );","\tfloat theta = acos( direction.y ); // elevation --\x3e y-axis, [-pi/2, pi/2]","\tfloat phi = atan( direction.z, direction.x ); // azimuth --\x3e x-axis [-pi/2, pi/2]","\tvec2 uv = vec2( phi, theta ) / vec2( 2.0 * pi, pi ) + vec2( 0.5, 0.0 );","\tvec3 L0 = vec3( 0.1 ) * Fex;","\tfloat sundisk = smoothstep( sunAngularDiameterCos, sunAngularDiameterCos + 0.00002, cosTheta );","\tL0 += ( vSunE * 19000.0 * Fex ) * sundisk;","\tvec3 texColor = ( Lin + L0 ) * 0.04 + vec3( 0.0, 0.0003, 0.00075 );","\tvec3 curr = Uncharted2Tonemap( ( log2( 2.0 / pow( luminance, 4.0 ) ) ) * texColor );","\tvec3 color = curr * whiteScale;","\tvec3 retColor = pow( color, vec3( 1.0 / ( 1.2 + ( 1.2 * vSunfade ) ) ) );","\tgl_FragColor = vec4( retColor, 1.0 );","}"].join("\n")};let $={CopyShader:H,EffectComposer:K,Pass:z,FXAAShader:q,ClearMaskPass:W,MaskPass:Q,RenderPass:Z,ShaderPass:Y,Sky:J};var ee={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var e=document.createElement("div");return e.id="webgl-error-message",e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.fontWeight="normal",e.style.textAlign="center",e.style.background="#fff",e.style.color="#000",e.style.padding="1.5em",e.style.width="400px",e.style.margin="5em auto 0",this.webgl||(e.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")),e},addGetWebGLMessage:function(e){var t,n,r;t=void 0!==(e=e||{}).parent?e.parent:document.body,n=void 0!==e.id?e.id:"oldie",(r=ee.getWebGLErrorMessage()).id=n,t.appendChild(r)}},te=function(){var e=0,t=document.createElement("div");function n(e){return t.appendChild(e.dom),e}function r(n){for(var r=0;r<t.children.length;r++)t.children[r].style.display=r===n?"block":"none";e=n}t.classList.add("statsBox"),t.addEventListener("click",function(n){n.preventDefault(),r(++e%t.children.length)},!1);var i=(performance||Date).now(),a=i,o=0,s=n(new te.Panel("FPS","#0ff","#002")),l=n(new te.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var u=n(new te.Panel("MB","#f08","#201"));return r(0),{REVISION:16,dom:t,addPanel:n,showPanel:r,begin:function(){i=(performance||Date).now()},end:function(){o++;var e=(performance||Date).now();if(l.update(e-i,200),e>a+1e3&&(s.update(1e3*o/(e-a),100),a=e,o=0,u)){var t=performance.memory;u.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){i=this.end()},domElement:t,setMode:r}};te.Panel=function(e,t,n){var r=1/0,i=0,a=Math.round,o=a(window.devicePixelRatio||1),s=80*o,l=48*o,u=3*o,c=2*o,h=3*o,f=15*o,d=74*o,p=30*o,m=document.createElement("canvas");m.width=s,m.height=l,m.style.cssText="width:80px;height:48px";var v=m.getContext("2d");return v.font="bold "+9*o+"px Helvetica,Arial,sans-serif",v.textBaseline="top",v.fillStyle=n,v.fillRect(0,0,s,l),v.fillStyle=t,v.fillText(e,u,c),v.fillRect(h,f,d,p),v.fillStyle=n,v.globalAlpha=.9,v.fillRect(h,f,d,p),{dom:m,update:function(l,g){r=Math.min(r,l),i=Math.max(i,l),v.fillStyle=n,v.globalAlpha=1,v.fillRect(0,0,s,f),v.fillStyle=t,v.fillText(a(l)+" "+e+" ("+a(r)+"-"+a(i)+")",u,c),v.drawImage(m,h+o,f,d-o,p,h,f,d-o,p),v.fillRect(h+d-o,f,o,p),v.fillStyle=n,v.globalAlpha=.9,v.fillRect(h+d-o,f,o,a((1-l/g)*p))}}};var ne=n(7);class re{constructor(){const e=this;ee.webgl||ee.addGetWebGLMessage(),this.renderer=new r.WebGLRenderer,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=r.PCFSoftShadowMap,document.body.appendChild(this.renderer.domElement),this.renderer.domElement.id="canvas",window.addEventListener("resize",function(){e.camera.aspect=window.innerWidth/window.innerHeight,e.camera.updateProjectionMatrix(),e.renderer.setSize(window.innerWidth,window.innerHeight),o.uniforms.resolution.value.set(1/(window.innerWidth*n),1/(window.innerHeight*n)),e.composer.setSize(window.innerWidth*n,window.innerHeight*n)},!1),this.stats=new te,document.body.appendChild(this.stats.dom),this.graphicsWorld=new r.Scene,this.camera=new r.PerspectiveCamera(80,window.innerWidth/window.innerHeight,.1,120);let t=new $.RenderPass(this.graphicsWorld,this.camera),n=1;void 0!==window.devicePixelRatio&&(n=window.devicePixelRatio);let o=new $.ShaderPass($.FXAAShader);o.uniforms.resolution.value.set(1/(window.innerWidth*n),1/(window.innerHeight*n)),o.renderToScreen=!0,this.composer=new $.EffectComposer(this.renderer),this.composer.setSize(window.innerWidth*n,window.innerHeight*n),this.composer.addPass(t),this.composer.addPass(o);let s=new $.Sky;s.scale.setScalar(100),this.graphicsWorld.add(s),this.sun=new r.Vector3,this.sun.x=-1,this.sun.y=1,this.sun.z=-1,s.material.uniforms.sunPosition.value.copy(this.sun);let l=new r.AmbientLight(11184810);this.graphicsWorld.add(l);let u=new r.DirectionalLight(16777215,.4);this.dirLight=u,u.castShadow=!0,u.shadow.mapSize.width=2048,u.shadow.mapSize.height=2048,u.shadow.camera.near=1,u.shadow.camera.far=50,u.shadow.camera.top=15,u.shadow.camera.right=15,u.shadow.camera.bottom=-15,u.shadow.camera.left=-15,u.shadow.camera,this.graphicsWorld.add(u),this.physicsWorld=new a.World,this.physicsWorld.gravity.set(0,-9.81,0),this.physicsWorld.broadphase=new a.NaiveBroadphase,this.physicsWorld.solver.iterations=10,this.parallelPairs=[],this.physicsFrameRate=60,this.physicsFrameTime=1/this.physicsFrameRate,this.physicsMaxPrediction=this.physicsFrameRate,this.clock=new r.Clock,this.renderDelta=0,this.logicDelta=0,this.sinceLastFrame=0,this.justRendered=!1;let c={Pointer_Lock:!0,Mouse_Sensitivity:.3,FPS_Limit:60,Time_Scale:1,Shadows:!0,FXAA:!1,Draw_Physics:!1,RayCast_Debug:!1};this.params=c;let h=new ne.GUI,f=h.addFolder("Input");f.add(c,"Pointer_Lock").onChange(function(t){e.inputManager.setPointerLock(t)}),f.add(c,"Mouse_Sensitivity",0,1).onChange(function(t){e.cameraController.setSensitivity(t,.8*t)});let d=h.addFolder("Rendering");d.add(c,"FPS_Limit",0,60),d.add(c,"Time_Scale",0,1).listen().onChange(function(t){e.timeScaleTarget=t}),d.add(c,"Shadows").onChange(function(e){u.castShadow=!!e}),d.add(c,"FXAA");let p=h.addFolder("Debug");p.add(c,"Draw_Physics").onChange(function(t){e.objects.forEach(e=>{void 0!=e.physics.visual&&(e.physics.visual.visible=!!t)})}),p.add(c,"RayCast_Debug").onChange(function(t){e.characters.forEach(e=>{e.raycastBox.visible=!!t})}),h.open(),this.timeScaleTarget=1,this.cameraDistanceTarget=1.6,this.balls=[],this.objects=[],this.characters=[],this.vehicles=[],this.cameraController=new i(this.camera,this.params.Mouse_Sensitivity,.7*this.params.Mouse_Sensitivity),this.inputManager=new j(this,this.renderer.domElement),this.setGameMode(new X.FreeCameraControls),this.render(this)}setGameMode(e){e.world=this,this.gameMode=e,e.init()}update(e){this.updatePhysics(e),this.objects.forEach(t=>{t.update(e)}),this.characters.forEach(t=>{t.behaviour.update(e),t.updateMatrixWorld()}),this.gameMode.update(e),this.params.Time_Scale=r.Math.lerp(this.params.Time_Scale,this.timeScaleTarget,.2),this.cameraController.radius=r.Math.lerp(this.cameraController.radius,this.cameraDistanceTarget,.1),this.cameraController.update()}updatePhysics(e){this.physicsWorld.step(this.physicsFrameTime,e,this.physicsMaxPrediction),this.objects.forEach(e=>{void 0!=e.physics.physical&&(e.physics.physical.position.y<-5&&(e.physics.physical.position.x=1.13,e.physics.physical.position.y=5,e.physics.physical.position.z=-2.2,e.physics.physical.interpolatedPosition.x=1.13,e.physics.physical.interpolatedPosition.y=5,e.physics.physical.interpolatedPosition.z=-2.2),e.position.copy(e.physics.physical.interpolatedPosition),e.quaternion.copy(e.physics.physical.interpolatedQuaternion))})}render(e){this.justRendered&&(this.justRendered=!1,this.stats.begin()),requestAnimationFrame(function(){e.render(e)}),this.renderDelta=this.clock.getDelta();let t=(this.renderDelta+this.logicDelta)*this.params.Time_Scale;e.update(t),this.logicDelta=this.clock.getDelta();let n=1/this.params.FPS_Limit;this.sinceLastFrame+=this.renderDelta+this.logicDelta,this.sinceLastFrame>n&&(this.sinceLastFrame%=n,this.params.FXAA?this.composer.render():this.renderer.render(this.graphicsWorld,this.camera),this.stats.end(),this.justRendered=!0)}add(e){if(e.isObject)s.a.includes(this.objects,e)?console.warn("Adding object to a world in which it already exists."):(this.objects.push(e),void 0!==e.physics.physical&&this.physicsWorld.addBody(e.physics.physical),void 0!==e.physics.visual&&this.graphicsWorld.add(e.physics.visual),void 0!==e.model&&this.graphicsWorld.add(e.model));else if(e.isCharacter){const t=e;if(!s.a.includes(this.characters,t))return t.world=this,this.characters.push(t),this.physicsWorld.addBody(t.characterCapsule.physics.physical),this.graphicsWorld.add(t),this.graphicsWorld.add(t.characterCapsule.physics.visual),this.graphicsWorld.add(t.raycastBox),this.objects.push(t.characterCapsule),t;console.warn("Adding character to a world in which it already exists.")}else console.error("Object type not supported: "+e)}remove(e){if(e.isObject)s.a.includes(this.objects,e)?(s.a.pull(this.objects,e),void 0!==e.physics.physical&&this.physicsWorld.removeBody(e.physics.physical),void 0!==e.physics.visual&&this.graphicsWorld.remove(e.physics.visual),void 0!==e.model&&this.graphicsWorld.remove(e.model)):console.warn("Removing object from a world in which it isn't present.");else if(e.isCharacter){const t=e;if(s.a.includes(this.characters,t))return t.world=void 0,s.a.pull(this.characters,t),this.physicsWorld.removeBody(t.characterCapsule.physics.physical),this.graphicsWorld.remove(t),this.graphicsWorld.remove(t.characterCapsule.physics.visual),this.graphicsWorld.remove(t.raycastBox),s.a.pull(this.objects,t.characterCapsule),t;console.warn("Removing character from a world in which it isn't present.")}else console.error("Object type not supported: "+e)}}var ie=n(8),ae=function(e){this.manager=void 0!==e?e:r.DefaultLoadingManager};function oe(e){var t,n=e.Content,i=e.RelativeFilename||e.Filename,a=i.slice(i.lastIndexOf(".")+1).toLowerCase();switch(a){case"bmp":t="image/bmp";break;case"jpg":case"jpeg":t="image/jpeg";break;case"png":t="image/png";break;case"tif":t="image/tiff";break;case"tga":if("function"!=typeof r.TGALoader)return void console.warn("FBXLoader: THREE.TGALoader is required to load TGA textures");null===r.Loader.Handlers.get(".tga")&&r.Loader.Handlers.add(/\.tga$/i,new r.TGALoader),t="image/tga";break;default:return void console.warn('FBXLoader: Image type "'+a+'" is not supported.')}if("string"==typeof n)return"data:"+t+";base64,"+n;var o=new Uint8Array(n);return window.URL.createObjectURL(new Blob([o],{type:t}))}function se(e,t,n,i){var a=function(e,t,n,i){var a,o,s=t.path,l=i.get(e.id).children;void 0!==l&&l.length>0&&void 0!==n[l[0].ID]&&(0!==(a=n[l[0].ID]).indexOf("blob:")&&0!==a.indexOf("data:")||t.setPath(void 0));o="tga"===e.FileName.slice(-3).toLowerCase()?r.Loader.Handlers.get(".tga").load(a):t.load(a);return t.setPath(s),o}(e,t,n,i);a.ID=e.id,a.name=e.attrName;var o=e.WrapModeU,s=e.WrapModeV,l=void 0!==o?o.value:0,u=void 0!==s?s.value:0;if(a.wrapS=0===l?r.RepeatWrapping:r.ClampToEdgeWrapping,a.wrapT=0===u?r.RepeatWrapping:r.ClampToEdgeWrapping,"Scaling"in e){var c=e.Scaling.value;a.repeat.x=c[0],a.repeat.y=c[1]}return a}function le(e,t,n,i){var a=t.id,o=t.attrName,s=t.ShadingModel;if("object"==typeof s&&(s=s.value),!i.has(a))return null;var l,u=function(e,t,n,i,a){var o={};t.BumpFactor&&(o.bumpScale=t.BumpFactor.value);t.Diffuse?o.color=(new r.Color).fromArray(t.Diffuse.value):t.DiffuseColor&&"Color"===t.DiffuseColor.type&&(o.color=(new r.Color).fromArray(t.DiffuseColor.value));t.DisplacementFactor&&(o.displacementScale=t.DisplacementFactor.value);t.Emissive?o.emissive=(new r.Color).fromArray(t.Emissive.value):t.EmissiveColor&&"Color"===t.EmissiveColor.type&&(o.emissive=(new r.Color).fromArray(t.EmissiveColor.value));t.EmissiveFactor&&(o.emissiveIntensity=parseFloat(t.EmissiveFactor.value));t.Opacity&&(o.opacity=parseFloat(t.Opacity.value));o.opacity<1&&(o.transparent=!0);t.ReflectionFactor&&(o.reflectivity=t.ReflectionFactor.value);t.Shininess&&(o.shininess=t.Shininess.value);t.Specular?o.specular=(new r.Color).fromArray(t.Specular.value):t.SpecularColor&&"Color"===t.SpecularColor.type&&(o.specular=(new r.Color).fromArray(t.SpecularColor.value));return a.get(i).children.forEach(function(t){var i=t.relationship;switch(i){case"Bump":o.bumpMap=n.get(t.ID);break;case"DiffuseColor":o.map=ue(e,n,t.ID,a);break;case"DisplacementColor":o.displacementMap=ue(e,n,t.ID,a);break;case"EmissiveColor":o.emissiveMap=ue(e,n,t.ID,a);break;case"NormalMap":o.normalMap=ue(e,n,t.ID,a);break;case"ReflectionColor":o.envMap=ue(e,n,t.ID,a),o.envMap.mapping=r.EquirectangularReflectionMapping;break;case"SpecularColor":o.specularMap=ue(e,n,t.ID,a);break;case"TransparentColor":o.alphaMap=ue(e,n,t.ID,a),o.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("FBXLoader: %s map is not supported in three.js, skipping texture.",i)}}),o}(e,t,n,a,i);switch(s.toLowerCase()){case"phong":l=new r.MeshPhongMaterial;break;case"lambert":l=new r.MeshLambertMaterial;break;default:console.warn('FBXLoader: unknown material type "%s". Defaulting to MeshPhongMaterial.',s),l=new r.MeshPhongMaterial({color:3342591})}return l.setValues(u),l.name=o,l}function ue(e,t,n,r){return"LayeredTexture"in e.Objects&&n in e.Objects.LayeredTexture&&(console.warn("FBXLoader: layered textures are not supported in three.js. Discarding all but first layer."),n=r.get(n).children[0].ID),t.get(n)}function ce(e,t){var n=[];return e.children.forEach(function(e){var i=t[e.ID];if("Cluster"===i.attrType){var a={ID:e.ID,indices:[],weights:[],transform:(new r.Matrix4).fromArray(i.Transform.a),transformLink:(new r.Matrix4).fromArray(i.TransformLink.a),linkMode:i.Mode};"Indexes"in i&&(a.indices=i.Indexes.a,a.weights=i.Weights.a),n.push(a)}}),{rawBones:n,bones:[]}}function he(e,t,n,r){for(var i=[],a=0;a<e.children.length;a++){if(8===a){console.warn("FBXLoader: maximum of 8 morph targets supported. Ignoring additional targets.");break}var o=e.children[a],s=n[o.ID],l={name:s.attrName,initialWeight:s.DeformPercent,id:s.id,fullWeights:s.FullWeights.a};if("BlendShapeChannel"!==s.attrType)return;r.get(parseInt(o.ID)).children.forEach(function(e){"DeformPercent"===e.relationship?l.weightCurveID=e.ID:l.geoID=e.ID}),i.push(l)}return i}function fe(e,t,n,i){switch(n.attrType){case"Mesh":return function(e,t,n,i){var a=i.skeletons,o=i.morphTargets,s=t.parents.map(function(t){return e.Objects.Model[t.ID]});if(0===s.length)return;var l=t.children.reduce(function(e,t){return void 0!==a[t.ID]&&(e=a[t.ID]),e},null),u=t.children.reduce(function(e,t){return void 0!==o[t.ID]&&(e=o[t.ID]),e},null),c=new r.Matrix4,h=s[0];if("GeometricRotation"in h){var f=h.GeometricRotation.value.map(r.Math.degToRad);f[3]="ZYX",c.makeRotationFromEuler((new r.Euler).fromArray(f))}"GeometricTranslation"in h&&c.setPosition((new r.Vector3).fromArray(h.GeometricTranslation.value));"GeometricScaling"in h&&c.scale((new r.Vector3).fromArray(h.GeometricScaling.value));return function(e,t,n,i,a){var o=new r.BufferGeometry;t.attrName&&(o.name=t.attrName);var s=function(e,t){var n={};n.vertexPositions=void 0!==e.Vertices?e.Vertices.a:[],n.vertexIndices=void 0!==e.PolygonVertexIndex?e.PolygonVertexIndex.a:[],e.LayerElementColor&&(n.color=function(e){var t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Colors.a,i=[];"IndexToDirect"===n&&(i=e.ColorIndex.a);return{dataSize:4,buffer:r,indices:i,mappingType:t,referenceType:n}}(e.LayerElementColor[0]));e.LayerElementMaterial&&(n.material=function(e){var t=e.MappingInformationType,n=e.ReferenceInformationType;if("NoMappingInformation"===t)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:n};for(var r=e.Materials.a,i=[],a=0;a<r.length;++a)i.push(a);return{dataSize:1,buffer:r,indices:i,mappingType:t,referenceType:n}}(e.LayerElementMaterial[0]));e.LayerElementNormal&&(n.normal=function(e){var t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.Normals.a,i=[];"IndexToDirect"===n&&("NormalIndex"in e?i=e.NormalIndex.a:"NormalsIndex"in e&&(i=e.NormalsIndex.a));return{dataSize:3,buffer:r,indices:i,mappingType:t,referenceType:n}}(e.LayerElementNormal[0]));if(e.LayerElementUV){n.uv=[];for(var r=0;e.LayerElementUV[r];)n.uv.push(pe(e.LayerElementUV[r])),r++}n.weightTable={},null!==t&&(n.skeleton=t,t.rawBones.forEach(function(e,t){e.indices.forEach(function(r,i){void 0===n.weightTable[r]&&(n.weightTable[r]=[]),n.weightTable[r].push({id:t,weight:e.weights[i]})})}));return n}(t,n),l=de(s),u=new r.Float32BufferAttribute(l.vertex,3);a.applyToBufferAttribute(u),o.addAttribute("position",u),l.colors.length>0&&o.addAttribute("color",new r.Float32BufferAttribute(l.colors,3));n&&(o.addAttribute("skinIndex",new r.Uint16BufferAttribute(l.weightsIndices,4)),o.addAttribute("skinWeight",new r.Float32BufferAttribute(l.vertexWeights,4)),o.FBX_Deformer=n);if(l.normal.length>0){var c=new r.Float32BufferAttribute(l.normal,3),h=(new r.Matrix3).getNormalMatrix(a);h.applyToBufferAttribute(c),o.addAttribute("normal",c)}if(l.uvs.forEach(function(e,t){var n="uv"+(t+1).toString();0===t&&(n="uv"),o.addAttribute(n,new r.Float32BufferAttribute(l.uvs[t],2))}),s.material&&"AllSame"!==s.material.mappingType){var f=l.materialIndex[0],d=0;if(l.materialIndex.forEach(function(e,t){e!==f&&(o.addGroup(d,t-d,f),f=e,d=t)}),o.groups.length>0){var p=o.groups[o.groups.length-1],m=p.start+p.count;m!==l.materialIndex.length&&o.addGroup(m,l.materialIndex.length-m,f)}0===o.groups.length&&o.addGroup(0,l.materialIndex.length,l.materialIndex[0])}return function(e,t,n,i,a){null!==i&&(t.morphAttributes.position=[],t.morphAttributes.normal=[],i.rawTargets.forEach(function(i){var o=e.Objects.Geometry[i.geoID];void 0!==o&&function(e,t,n,i){var a=new r.BufferGeometry;n.attrName&&(a.name=n.attrName);for(var o=void 0!==t.PolygonVertexIndex?t.PolygonVertexIndex.a:[],s=void 0!==t.Vertices?t.Vertices.a.slice():[],l=void 0!==n.Vertices?n.Vertices.a:[],u=void 0!==n.Indexes?n.Indexes.a:[],c=0;c<u.length;c++){var h=3*u[c];s[h]+=l[3*c],s[h+1]+=l[3*c+1],s[h+2]+=l[3*c+2]}var f=de({vertexIndices:o,vertexPositions:s}),d=new r.Float32BufferAttribute(f.vertex,3);d.name=n.attrName,i.applyToBufferAttribute(d),e.morphAttributes.position.push(d)}(t,n,o,a)}))}(e,o,t,i,a),o}(e,n,l,u,c)}(e,t,n,i);case"NurbsCurve":return function(e){if(void 0===r.NURBSCurve)return console.error("FBXLoader: The loader relies on THREE.NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new r.BufferGeometry;var t=parseInt(e.Order);if(isNaN(t))return console.error("FBXLoader: Invalid Order %s given for geometry ID: %s",e.Order,e.id),new r.BufferGeometry;for(var n,i,a=t-1,o=e.KnotVector.a,s=[],l=e.Points.a,u=0,c=l.length;u<c;u+=4)s.push((new r.Vector4).fromArray(l,u));if("Closed"===e.Form)s.push(s[0]);else if("Periodic"===e.Form){n=a,i=o.length-1-n;for(var u=0;u<a;++u)s.push(s[u])}var h=new r.NURBSCurve(a,o,s,n,i).getPoints(7*s.length),f=new Float32Array(3*h.length);h.forEach(function(e,t){e.toArray(f,3*t)});var d=new r.BufferGeometry;return d.addAttribute("position",new r.BufferAttribute(f,3)),d}(n)}}function de(e){var t={vertex:[],normal:[],colors:[],uvs:[],materialIndex:[],vertexWeights:[],weightsIndices:[]},n=0,r=0,i=!1,a=[],o=[],s=[],l=[],u=[],c=[];return e.vertexIndices.forEach(function(h,f){var d=!1;h<0&&(h^=-1,d=!0);var p=[],m=[];if(a.push(3*h,3*h+1,3*h+2),e.color){var v=ve(f,n,h,e.color);s.push(v[0],v[1],v[2])}if(e.skeleton){if(void 0!==e.weightTable[h]&&e.weightTable[h].forEach(function(e){m.push(e.weight),p.push(e.id)}),m.length>4){i||(console.warn("FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),i=!0);var g=[0,0,0,0],_=[0,0,0,0];m.forEach(function(e,t){var n=e,r=p[t];_.forEach(function(e,t,i){if(n>e){i[t]=n,n=e;var a=g[t];g[t]=r,r=a}})}),p=g,m=_}for(;m.length<4;)m.push(0),p.push(0);for(var y=0;y<4;++y)u.push(m[y]),c.push(p[y])}if(e.normal){v=ve(f,n,h,e.normal);o.push(v[0],v[1],v[2])}if(e.material&&"AllSame"!==e.material.mappingType)var A=ve(f,n,h,e.material)[0];e.uv&&e.uv.forEach(function(e,t){var r=ve(f,n,h,e);void 0===l[t]&&(l[t]=[]),l[t].push(r[0]),l[t].push(r[1])}),r++,d&&(!function(e,t,n,r,i,a,o,s,l,u){for(var c=2;c<u;c++)e.vertex.push(t.vertexPositions[n[0]]),e.vertex.push(t.vertexPositions[n[1]]),e.vertex.push(t.vertexPositions[n[2]]),e.vertex.push(t.vertexPositions[n[3*(c-1)]]),e.vertex.push(t.vertexPositions[n[3*(c-1)+1]]),e.vertex.push(t.vertexPositions[n[3*(c-1)+2]]),e.vertex.push(t.vertexPositions[n[3*c]]),e.vertex.push(t.vertexPositions[n[3*c+1]]),e.vertex.push(t.vertexPositions[n[3*c+2]]),t.skeleton&&(e.vertexWeights.push(s[0]),e.vertexWeights.push(s[1]),e.vertexWeights.push(s[2]),e.vertexWeights.push(s[3]),e.vertexWeights.push(s[4*(c-1)]),e.vertexWeights.push(s[4*(c-1)+1]),e.vertexWeights.push(s[4*(c-1)+2]),e.vertexWeights.push(s[4*(c-1)+3]),e.vertexWeights.push(s[4*c]),e.vertexWeights.push(s[4*c+1]),e.vertexWeights.push(s[4*c+2]),e.vertexWeights.push(s[4*c+3]),e.weightsIndices.push(l[0]),e.weightsIndices.push(l[1]),e.weightsIndices.push(l[2]),e.weightsIndices.push(l[3]),e.weightsIndices.push(l[4*(c-1)]),e.weightsIndices.push(l[4*(c-1)+1]),e.weightsIndices.push(l[4*(c-1)+2]),e.weightsIndices.push(l[4*(c-1)+3]),e.weightsIndices.push(l[4*c]),e.weightsIndices.push(l[4*c+1]),e.weightsIndices.push(l[4*c+2]),e.weightsIndices.push(l[4*c+3])),t.color&&(e.colors.push(a[0]),e.colors.push(a[1]),e.colors.push(a[2]),e.colors.push(a[3*(c-1)]),e.colors.push(a[3*(c-1)+1]),e.colors.push(a[3*(c-1)+2]),e.colors.push(a[3*c]),e.colors.push(a[3*c+1]),e.colors.push(a[3*c+2])),t.material&&"AllSame"!==t.material.mappingType&&(e.materialIndex.push(r),e.materialIndex.push(r),e.materialIndex.push(r)),t.normal&&(e.normal.push(i[0]),e.normal.push(i[1]),e.normal.push(i[2]),e.normal.push(i[3*(c-1)]),e.normal.push(i[3*(c-1)+1]),e.normal.push(i[3*(c-1)+2]),e.normal.push(i[3*c]),e.normal.push(i[3*c+1]),e.normal.push(i[3*c+2])),t.uv&&t.uv.forEach(function(t,n){void 0===e.uvs[n]&&(e.uvs[n]=[]),e.uvs[n].push(o[n][0]),e.uvs[n].push(o[n][1]),e.uvs[n].push(o[n][2*(c-1)]),e.uvs[n].push(o[n][2*(c-1)+1]),e.uvs[n].push(o[n][2*c]),e.uvs[n].push(o[n][2*c+1])})}(t,e,a,A,o,s,l,u,c,r),n++,r=0,a=[],o=[],s=[],l=[],u=[],c=[])}),t}function pe(e){var t=e.MappingInformationType,n=e.ReferenceInformationType,r=e.UV.a,i=[];return"IndexToDirect"===n&&(i=e.UVIndex.a),{dataSize:2,buffer:r,indices:i,mappingType:t,referenceType:n}}Object.assign(ae.prototype,{load:function(e,t,n,i){var a=this,o=r.LoaderUtils.extractUrlBase(e),s=new r.FileLoader(this.manager);s.setResponseType("arraybuffer"),s.load(e,function(n){try{var r=a.parse(n,o);t(r)}catch(t){window.setTimeout(function(){i&&i(t),a.manager.itemError(e)},0)}},n,i)},parse:function(e,t){var n;if(function(e){var t="Kaydara FBX Binary  \0";return e.byteLength>=t.length&&t===Oe(e,0,t.length)}(e))n=(new Pe).parse(e);else{var i=Oe(e);if(!function(e){var t=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],n=0;function r(t){var r=e[t-1];return e=e.slice(n+t),n++,r}for(var i=0;i<t.length;++i){var a=r(1);if(a===t[i])return!1}return!0}(i))throw new Error("FBXLoader: Unknown format.");if(Ce(i)<7e3)throw new Error("FBXLoader: FBX version not supported, FileVersion: "+Ce(i));n=(new Le).parse(i)}var a=function(e){var t=new Map;if("Connections"in e){var n=e.Connections.connections;n.forEach(function(e){var n=e[0],r=e[1],i=e[2];t.has(n)||t.set(n,{parents:[],children:[]});var a={ID:r,relationship:i};t.get(n).parents.push(a),t.has(r)||t.set(r,{parents:[],children:[]});var o={ID:n,relationship:i};t.get(r).children.push(o)})}return t}(n),o=function(e){var t={},n={};if("Video"in e.Objects){var r=e.Objects.Video;for(var i in r){var a=r[i],o=parseInt(i);if(t[o]=a.RelativeFilename||a.Filename,"Content"in a){var s=a.Content instanceof ArrayBuffer&&a.Content.byteLength>0,l="string"==typeof a.Content&&""!==a.Content;if(s||l){var u=oe(r[i]);n[a.RelativeFilename||a.Filename]=u}}}}for(var o in t){var c=t[o];void 0!==n[c]?t[o]=n[c]:t[o]=t[o].split("\\").pop()}return t}(n),s=function(e,t,n){var r=new Map;if("Material"in e.Objects){var i=e.Objects.Material;for(var a in i){var o=le(e,i[a],t,n);null!==o&&r.set(parseInt(a),o)}}return r}(n,function(e,t,n,r){var i=new Map;if("Texture"in e.Objects){var a=e.Objects.Texture;for(var o in a){var s=se(a[o],t,n,r);i.set(parseInt(o),s)}}return i}(n,new r.TextureLoader(this.manager).setPath(t),o,a),a),l=function(e,t){var n={},r={};if("Deformer"in e.Objects){var i=e.Objects.Deformer;for(var a in i){var o=i[a],s=t.get(parseInt(a));if("Skin"===o.attrType){var l=ce(s,i);l.ID=a,s.parents.length>1&&console.warn("FBXLoader: skeleton attached to more than one geometry is not supported."),l.geometryID=s.parents[0].ID,n[a]=l}else if("BlendShape"===o.attrType){var u={id:a};u.rawTargets=he(s,o,i,t),u.id=a,s.parents.length>1&&console.warn("FBXLoader: morph target attached to more than one geometry is not supported."),u.parentGeoID=s.parents[0].ID,r[a]=u}}}return{skeletons:n,morphTargets:r}}(n,a),u=function(e,t,n){var r=new Map;if("Geometry"in e.Objects){var i=e.Objects.Geometry;for(var a in i){var o=t.get(parseInt(a)),s=fe(e,o,i[a],n);r.set(parseInt(a),s)}}return r}(n,a,l);return function(e,t,n,i,a){var o=new r.Group,s=function(e,t,n,i,a){var o=new Map,s=e.Objects.Model;for(var l in s){var u=parseInt(l),c=s[l],h=a.get(u),f=ge(h,t,u,c.attrName);if(!f){switch(c.attrType){case"Camera":f=_e(e,h);break;case"Light":f=ye(e,h);break;case"Mesh":f=Ae(e,h,n,i);break;case"NurbsCurve":f=xe(h,n);break;case"LimbNode":case"Null":default:f=new r.Group}f.name=r.PropertyBinding.sanitizeNodeName(c.attrName),f.ID=u}be(e,f,c),o.set(u,f)}return o}(e,n,i,a,t),l=e.Objects.Model;return s.forEach(function(n){var i=l[n.ID];!function(e,t,n,i,a){if("LookAtProperty"in n){var o=i.get(t.ID).children;o.forEach(function(n){if("LookAtProperty"===n.relationship){var i=e.Objects.Model[n.ID];if("Lcl_Translation"in i){var o=i.Lcl_Translation.value;void 0!==t.target?(t.target.position.fromArray(o),a.add(t.target)):t.lookAt((new r.Vector3).fromArray(o))}}})}}(e,n,i,t,o),t.get(n.ID).parents.forEach(function(e){var t=s.get(e.ID);void 0!==t&&t.add(n)}),null===n.parent&&o.add(n)}),function(e,t,n,i,a){var o=function(e){var t={};if("Pose"in e.Objects){var n=e.Objects.Pose;for(var i in n)if("BindPose"===n[i].attrType){var a=n[i].PoseNode;Array.isArray(a)?a.forEach(function(e){t[e.Node]=(new r.Matrix4).fromArray(e.Matrix.a)}):t[a.Node]=(new r.Matrix4).fromArray(a.Matrix.a)}}return t}(e);for(var s in t){var l=t[s],u=a.get(parseInt(l.ID)).parents;u.forEach(function(e){if(n.has(e.ID)){var t=e.ID,s=a.get(t);s.parents.forEach(function(e){if(i.has(e.ID)){var t=i.get(e.ID);t.bind(new r.Skeleton(l.bones),o[e.ID])}})}})}}(e,n,i,s,t),function(e,t,n){n.animations=[];var i=function(e,t){if(void 0!==e.Objects.AnimationCurve){var n=function(e){var t=e.Objects.AnimationCurveNode,n=new Map;for(var r in t){var i=t[r];if(null!==i.attrName.match(/S|R|T/)){var a={id:i.id,attr:i.attrName,curves:{}};n.set(a.id,a)}}return n}(e);!function(e,t,n){var r=e.Objects.AnimationCurve;for(var i in r){var a={id:r[i].id,times:r[i].KeyTime.a.map(Ne),values:r[i].KeyValueFloat.a},o=t.get(a.id);if(void 0!==o){var s=o.parents[0].ID,l=o.parents[0].relationship;l.match(/X/)?n.get(s).curves.x=a:l.match(/Y/)?n.get(s).curves.y=a:l.match(/Z/)&&(n.get(s).curves.z=a)}}}(e,t,n);var i=function(e,t,n){var i=e.Objects.AnimationLayer,a=new Map;for(var o in i){var s=[],l=t.get(parseInt(o));if(void 0!==l){var u=l.children;u.forEach(function(i,a){if(n.has(i.ID)){var o=n.get(i.ID);if(void 0!==o.curves.x||void 0!==o.curves.y||void 0!==o.curves.z){if(void 0===s[a]){var l;t.get(i.ID).parents.forEach(function(e){void 0!==e.relationship&&(l=e.ID)});var u=e.Objects.Model[l.toString()],c={modelName:r.PropertyBinding.sanitizeNodeName(u.attrName),initialPosition:[0,0,0],initialRotation:[0,0,0],initialScale:[1,1,1]};"Lcl_Translation"in u&&(c.initialPosition=u.Lcl_Translation.value),"Lcl_Rotation"in u&&(c.initialRotation=u.Lcl_Rotation.value),"Lcl_Scaling"in u&&(c.initialScale=u.Lcl_Scaling.value),"PreRotation"in u&&(c.preRotations=u.PreRotation.value),s[a]=c}s[a][o.attr]=o}}}),a.set(parseInt(o),s)}}return a}(e,t,n);return function(e,t,n){var r=e.Objects.AnimationStack,i={};for(var a in r){var o=t.get(parseInt(a)).children;o.length>1&&console.warn("FBXLoader: Encountered an animation stack with multiple layers, this is currently not supported. Ignoring subsequent layers.");var s=n.get(o[0].ID);i[a]={name:r[a].attrName,layer:s}}return i}(e,t,i)}}(e,t);if(void 0!==i)for(var a in i){var o=i[a],s=we(o);n.animations.push(s)}}(e,t,o),function(e,t){if("GlobalSettings"in e&&"AmbientColor"in e.GlobalSettings){var n=e.GlobalSettings.AmbientColor.value,i=n[0],a=n[1],o=n[2];if(0!==i||0!==a||0!==o){var s=new r.Color(i,a,o);t.add(new r.AmbientLight(s,1))}}}(e,o),o}(n,a,l.skeletons,u,s)}});var me=[];function ve(e,t,n,r){var i;switch(r.mappingType){case"ByPolygonVertex":i=e;break;case"ByPolygon":i=t;break;case"ByVertice":i=n;break;case"AllSame":i=r.indices[0];break;default:console.warn("FBXLoader: unknown attribute mapping type "+r.mappingType)}"IndexToDirect"===r.referenceType&&(i=r.indices[i]);var a=i*r.dataSize,o=a+r.dataSize;return function(e,t,n,r){for(var i=n,a=0;i<r;i++,a++)e[a]=t[i];return e}(me,r.buffer,a,o)}function ge(e,t,n,i){var a=null;return e.parents.forEach(function(e){for(var o in t){var s=t[o];s.rawBones.forEach(function(t,o){if(t.ID===e.ID){var l=a;(a=new r.Bone).matrixWorld.copy(t.transformLink),a.name=r.PropertyBinding.sanitizeNodeName(i),a.ID=n,s.bones[o]=a,null!==l&&a.add(l)}})}}),a}function _e(e,t){var n,i;if(t.children.forEach(function(t){var n=e.Objects.NodeAttribute[t.ID];void 0!==n&&(i=n)}),void 0===i)n=new r.Object3D;else{var a=0;void 0!==i.CameraProjectionType&&1===i.CameraProjectionType.value&&(a=1);var o=1;void 0!==i.NearPlane&&(o=i.NearPlane.value/1e3);var s=1e3;void 0!==i.FarPlane&&(s=i.FarPlane.value/1e3);var l=window.innerWidth,u=window.innerHeight;void 0!==i.AspectWidth&&void 0!==i.AspectHeight&&(l=i.AspectWidth.value,u=i.AspectHeight.value);var c=l/u,h=45;void 0!==i.FieldOfView&&(h=i.FieldOfView.value);var f=i.FocalLength?i.FocalLength.value:null;switch(a){case 0:n=new r.PerspectiveCamera(h,c,o,s),null!==f&&n.setFocalLength(f);break;case 1:n=new r.OrthographicCamera(-l/2,l/2,u/2,-u/2,o,s);break;default:console.warn("FBXLoader: Unknown camera type "+a+"."),n=new r.Object3D}}return n}function ye(e,t){var n,i;if(t.children.forEach(function(t){var n=e.Objects.NodeAttribute[t.ID];void 0!==n&&(i=n)}),void 0===i)n=new r.Object3D;else{var a;a=void 0===i.LightType?0:i.LightType.value;var o=16777215;void 0!==i.Color&&(o=(new r.Color).fromArray(i.Color.value));var s=void 0===i.Intensity?1:i.Intensity.value/100;void 0!==i.CastLightOnObject&&0===i.CastLightOnObject.value&&(s=0);var l=0;void 0!==i.FarAttenuationEnd&&(l=void 0!==i.EnableFarAttenuation&&0===i.EnableFarAttenuation.value?0:i.FarAttenuationEnd.value);switch(a){case 0:n=new r.PointLight(o,s,l,1);break;case 1:n=new r.DirectionalLight(o,s);break;case 2:var u=Math.PI/3;void 0!==i.InnerAngle&&(u=r.Math.degToRad(i.InnerAngle.value));var c=0;void 0!==i.OuterAngle&&(c=r.Math.degToRad(i.OuterAngle.value),c=Math.max(c,1)),n=new r.SpotLight(o,s,l,u,c,1);break;default:console.warn("FBXLoader: Unknown light type "+i.LightType.value+", defaulting to a THREE.PointLight."),n=new r.PointLight(o,s)}void 0!==i.CastShadows&&1===i.CastShadows.value&&(n.castShadow=!0)}return n}function Ae(e,t,n,i){var a,o=null,s=null,l=[];return t.children.forEach(function(e){n.has(e.ID)&&(o=n.get(e.ID)),i.has(e.ID)&&l.push(i.get(e.ID))}),l.length>1?s=l:l.length>0?s=l[0]:(s=new r.MeshPhongMaterial({color:13421772}),l.push(s)),"color"in o.attributes&&l.forEach(function(e){e.vertexColors=r.VertexColors}),o.FBX_Deformer?(l.forEach(function(e){e.skinning=!0}),a=new r.SkinnedMesh(o,s)):a=new r.Mesh(o,s),a}function xe(e,t){var n=e.children.reduce(function(e,n){return t.has(n.ID)&&(e=t.get(n.ID)),e},null),i=new r.LineBasicMaterial({color:3342591,linewidth:1});return new r.Line(n,i)}function be(e,t,n){if("RotationOrder"in n){var i=parseInt(n.RotationOrder.value,10);i>0&&i<6?console.warn("FBXLoader: unsupported Euler Order: %s. Currently only XYZ order is supported. Animations and rotations may be incorrect.",["XYZ","XZY","YZX","ZXY","YXZ","ZYX","SphericXYZ"][i]):6===i&&console.warn("FBXLoader: unsupported Euler Order: Spherical XYZ. Animations and rotations may be incorrect.")}if("Lcl_Translation"in n&&t.position.fromArray(n.Lcl_Translation.value),"Lcl_Rotation"in n){var a=n.Lcl_Rotation.value.map(r.Math.degToRad);a.push("ZYX"),t.quaternion.setFromEuler((new r.Euler).fromArray(a))}if("Lcl_Scaling"in n&&t.scale.fromArray(n.Lcl_Scaling.value),"PreRotation"in n){var o=n.PreRotation.value.map(r.Math.degToRad);o[3]="ZYX";var s=(new r.Euler).fromArray(o);s=(new r.Quaternion).setFromEuler(s),t.quaternion.premultiply(s)}}function we(e){var t=[];return e.layer.forEach(function(e){t=t.concat(function(e){var t=[];if(void 0!==e.T&&Object.keys(e.T.curves).length>0){var n=Se(e.modelName,e.T.curves,e.initialPosition,"position");void 0!==n&&t.push(n)}if(void 0!==e.R&&Object.keys(e.R.curves).length>0){var i=function(e,t,n,i){void 0!==t.x&&(Ee(t.x),t.x.values=t.x.values.map(r.Math.degToRad));void 0!==t.y&&(Ee(t.y),t.y.values=t.y.values.map(r.Math.degToRad));void 0!==t.z&&(Ee(t.z),t.z.values=t.z.values.map(r.Math.degToRad));var a=Te(t),o=Fe(a,t,n);void 0!==i&&((i=i.map(r.Math.degToRad)).push("ZYX"),i=(new r.Euler).fromArray(i),i=(new r.Quaternion).setFromEuler(i));for(var s=new r.Quaternion,l=new r.Euler,u=[],c=0;c<o.length;c+=3)l.set(o[c],o[c+1],o[c+2],"ZYX"),s.setFromEuler(l),void 0!==i&&s.premultiply(i),s.toArray(u,c/3*4);return new r.QuaternionKeyframeTrack(e+".quaternion",a,u)}(e.modelName,e.R.curves,e.initialRotation,e.preRotations);void 0!==i&&t.push(i)}if(void 0!==e.S&&Object.keys(e.S.curves).length>0){var a=Se(e.modelName,e.S.curves,e.initialScale,"scale");void 0!==a&&t.push(a)}return t}(e))}),new r.AnimationClip(e.name,-1,t)}function Se(e,t,n,i){var a=Te(t),o=Fe(a,t,n);return new r.VectorKeyframeTrack(e+"."+i,a,o)}function Fe(e,t,n){var r=n,i=[],a=-1,o=-1,s=-1;return e.forEach(function(e){if(t.x&&(a=t.x.times.indexOf(e)),t.y&&(o=t.y.times.indexOf(e)),t.z&&(s=t.z.times.indexOf(e)),-1!==a){var n=t.x.values[a];i.push(n),r[0]=n}else i.push(r[0]);if(-1!==o){var l=t.y.values[o];i.push(l),r[1]=l}else i.push(r[1]);if(-1!==s){var u=t.z.values[s];i.push(u),r[2]=u}else i.push(r[2])}),i}function Te(e){var t=[];return void 0!==e.x&&(t=t.concat(e.x.times)),void 0!==e.y&&(t=t.concat(e.y.times)),void 0!==e.z&&(t=t.concat(e.z.times)),t=t.sort(function(e,t){return e-t}).filter(function(e,t,n){return n.indexOf(e)==t})}function Ee(e){for(var t=1;t<e.values.length;t++){var n=e.values[t-1],r=e.values[t]-n,i=Math.abs(r);if(i>=180){for(var a=i/180,o=r/a,s=n+o,l=e.times[t-1],u=(e.times[t]-l)/a,c=l+u,h=[],f=[];c<e.times[t];)h.push(c),c+=u,f.push(s),s+=o;e.times=Ue(e.times,t,h),e.values=Ue(e.values,t,f)}}}function Le(){}function Pe(){}function Ie(e,t){this.dv=new DataView(e),this.offset=0,this.littleEndian=void 0===t||t}function Me(){}function Ce(e){var t=e.match(/FBXVersion: (\d+)/);if(t)return parseInt(t[1]);throw new Error("FBXLoader: Cannot find the version number for the file given.")}function Ne(e){return e/46186158e3}function Re(e){return e.split(",").map(function(e){return parseFloat(e)})}function Oe(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=e.byteLength),r.LoaderUtils.decodeText(new Uint8Array(e,t,n))}function Ue(e,t,n){return e.slice(0,t).concat(n).concat(e.slice(t))}Object.assign(Le.prototype,{getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(e){this.nodeStack.push(e),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(e,t){this.currentProp=e,this.currentPropName=t},parse:function(e){this.currentIndent=0,this.allNodes=new Me,this.nodeStack=[],this.currentProp=[],this.currentPropName="";var t=this,n=e.split("\n");return n.forEach(function(e,r){var i=e.match(/^[\s\t]*;/),a=e.match(/^[\s\t]*$/);if(!i&&!a){var o=e.match("^\\t{"+t.currentIndent+"}(\\w+):(.*){",""),s=e.match("^\\t{"+t.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),l=e.match("^\\t{"+(t.currentIndent-1)+"}}");o?t.parseNodeBegin(e,o):s?t.parseNodeProperty(e,s,n[++r]):l?t.popStack():e.match(/^[^\s\t}]/)&&t.parseNodePropertyContinued(e)}}),this.allNodes},parseNodeBegin:function(e,t){var n=t[1].trim().replace(/^"/,"").replace(/"$/,""),r=t[2].split(",").map(function(e){return e.trim().replace(/^"/,"").replace(/"$/,"")}),i={name:n},a=this.parseNodeAttr(r),o=this.getCurrentNode();0===this.currentIndent?this.allNodes.add(n,i):n in o?("PoseNode"===n?o.PoseNode.push(i):void 0!==o[n].id&&(o[n]={},o[n][o[n].id]=o[n]),""!==a.id&&(o[n][a.id]=i)):"number"==typeof a.id?(o[n]={},o[n][a.id]=i):"Properties70"!==n&&(o[n]="PoseNode"===n?[i]:i),"number"==typeof a.id&&(i.id=a.id),""!==a.name&&(i.attrName=a.name),""!==a.type&&(i.attrType=a.type),this.pushStack(i)},parseNodeAttr:function(e){var t=e[0];""!==e[0]&&(t=parseInt(e[0]),isNaN(t)&&(t=e[0]));var n="",r="";return e.length>1&&(n=e[1].replace(/^(\w+)::/,""),r=e[2]),{id:t,name:n,type:r}},parseNodeProperty:function(e,t,n){var r=t[1].replace(/^"/,"").replace(/"$/,"").trim(),i=t[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===r&&","===i&&(i=n.replace(/"/g,"").replace(/,$/,"").trim());var a=this.getCurrentNode();if("Properties70"!==a.name){if("C"===r){var o=i.split(",").slice(1),s=parseInt(o[0]),l=parseInt(o[1]),u=i.split(",").slice(3);r="connections",function(e,t){for(var n=0,r=e.length,i=t.length;n<i;n++,r++)e[r]=t[n]}(i=[s,l],u=u.map(function(e){return e.trim().replace(/^"/,"")})),void 0===a[r]&&(a[r]=[])}"Node"===r&&(a.id=i),r in a&&Array.isArray(a[r])?a[r].push(i):"a"!==r?a[r]=i:a.a=i,this.setCurrentProp(a,r),"a"===r&&","!==i.slice(-1)&&(a.a=Re(i))}else this.parseNodeSpecialProperty(e,r,i)},parseNodePropertyContinued:function(e){var t=this.getCurrentNode();t.a+=e,","!==e.slice(-1)&&(t.a=Re(t.a))},parseNodeSpecialProperty:function(e,t,n){var r=n.split('",').map(function(e){return e.trim().replace(/^\"/,"").replace(/\s/,"_")}),i=r[0],a=r[1],o=r[2],s=r[3],l=r[4];switch(a){case"int":case"enum":case"bool":case"ULongLong":case"double":case"Number":case"FieldOfView":l=parseFloat(l);break;case"Color":case"ColorRGB":case"Vector3D":case"Lcl_Translation":case"Lcl_Rotation":case"Lcl_Scaling":l=Re(l)}this.getPrevNode()[i]={type:a,type2:o,flag:s,value:l},this.setCurrentProp(this.getPrevNode(),i)}}),Object.assign(Pe.prototype,{parse:function(e){var t=new Ie(e);t.skip(23);for(var n=t.getUint32(),r=new Me;!this.endOfContent(t);){var i=this.parseNode(t,n);null!==i&&r.add(i.name,i)}return r},endOfContent:function(e){return e.size()%16==0?(e.getOffset()+160+16&-16)>=e.size():e.getOffset()+160+16>=e.size()},parseNode:function(e,t){var n={},r=t>=7500?e.getUint64():e.getUint32(),i=t>=7500?e.getUint64():e.getUint32(),a=(t>=7500?e.getUint64():e.getUint32(),e.getUint8()),o=e.getString(a);if(0===r)return null;for(var s=[],l=0;l<i;l++)s.push(this.parseProperty(e));var u=s.length>0?s[0]:"",c=s.length>1?s[1]:"",h=s.length>2?s[2]:"";for(n.singleProperty=1===i&&e.getOffset()===r;r>e.getOffset();){var f=this.parseNode(e,t);null!==f&&this.parseSubNode(o,n,f)}return n.propertyList=s,"number"==typeof u&&(n.id=u),""!==c&&(n.attrName=c),""!==h&&(n.attrType=h),""!==o&&(n.name=o),n},parseSubNode:function(e,t,n){if(!0===n.singleProperty){var r=n.propertyList[0];Array.isArray(r)?(t[n.name]=n,n.a=r):t[n.name]=r}else if("Connections"===e&&"C"===n.name){var i=[];n.propertyList.forEach(function(e,t){0!==t&&i.push(e)}),void 0===t.connections&&(t.connections=[]),t.connections.push(i)}else if("Properties70"===n.name){Object.keys(n).forEach(function(e){t[e]=n[e]})}else if("Properties70"===e&&"P"===n.name){var a,o=n.propertyList[0],s=n.propertyList[1],l=n.propertyList[2],u=n.propertyList[3];0===o.indexOf("Lcl ")&&(o=o.replace("Lcl ","Lcl_")),0===s.indexOf("Lcl ")&&(s=s.replace("Lcl ","Lcl_")),a="Color"===s||"ColorRGB"===s||"Vector"===s||"Vector3D"===s||0===s.indexOf("Lcl_")?[n.propertyList[4],n.propertyList[5],n.propertyList[6]]:n.propertyList[4],t[o]={type:s,type2:l,flag:u,value:a}}else void 0===t[n.name]?"number"==typeof n.id?(t[n.name]={},t[n.name][n.id]=n):t[n.name]=n:"PoseNode"===n.name?(Array.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n)):void 0===t[n.name][n.id]&&(t[n.name][n.id]=n)},parseProperty:function(e){var t=e.getString(1);switch(t){case"C":return e.getBoolean();case"D":return e.getFloat64();case"F":return e.getFloat32();case"I":return e.getInt32();case"L":return e.getInt64();case"R":var n=e.getUint32();return e.getArrayBuffer(n);case"S":n=e.getUint32();return e.getString(n);case"Y":return e.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var r=e.getUint32(),i=e.getUint32(),a=e.getUint32();if(0===i)switch(t){case"b":case"c":return e.getBooleanArray(r);case"d":return e.getFloat64Array(r);case"f":return e.getFloat32Array(r);case"i":return e.getInt32Array(r);case"l":return e.getInt64Array(r)}var o=new Ie(new ie.Zlib.Inflate(new Uint8Array(e.getArrayBuffer(a))).decompress().buffer);switch(t){case"b":case"c":return o.getBooleanArray(r);case"d":return o.getFloat64Array(r);case"f":return o.getFloat32Array(r);case"i":return o.getInt32Array(r);case"l":return o.getInt64Array(r)}default:throw new Error("FBXLoader: Unknown property type "+t)}}}),Object.assign(Ie.prototype,{getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(e){this.offset+=e},getBoolean:function(){return 1==(1&this.getUint8())},getBooleanArray:function(e){for(var t=[],n=0;n<e;n++)t.push(this.getBoolean());return t},getUint8:function(){var e=this.dv.getUint8(this.offset);return this.offset+=1,e},getInt16:function(){var e=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,e},getInt32:function(){var e=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,e},getInt32Array:function(e){for(var t=[],n=0;n<e;n++)t.push(this.getInt32());return t},getUint32:function(){var e=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,e},getInt64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),2147483648&t?(t=4294967295&~t,4294967295===(e=4294967295&~e)&&(t=t+1&4294967295),-(4294967296*t+(e=e+1&4294967295))):4294967296*t+e},getInt64Array:function(e){for(var t=[],n=0;n<e;n++)t.push(this.getInt64());return t},getUint64:function(){var e,t;return this.littleEndian?(e=this.getUint32(),t=this.getUint32()):(t=this.getUint32(),e=this.getUint32()),4294967296*t+e},getFloat32:function(){var e=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,e},getFloat32Array:function(e){for(var t=[],n=0;n<e;n++)t.push(this.getFloat32());return t},getFloat64:function(){var e=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,e},getFloat64Array:function(e){for(var t=[],n=0;n<e;n++)t.push(this.getFloat64());return t},getArrayBuffer:function(e){var t=this.dv.buffer.slice(this.offset,this.offset+e);return this.offset+=e,t},getString:function(e){for(var t=new Uint8Array(e),n=0;n<e;n++)t[n]=this.getUint8();var i=t.indexOf(0);return i>=0&&(t=t.slice(0,i)),r.LoaderUtils.decodeText(t)}}),Object.assign(Me.prototype,{add:function(e,t){this[e]=t}});var ke=n(6),De=n.n(ke);n.d(t,"CameraController",function(){return i}),n.d(t,"Character",function(){return V}),n.d(t,"CharacterAI",function(){return p}),n.d(t,"CharacterStates",function(){return R}),n.d(t,"Controls",function(){return f}),n.d(t,"GameModes",function(){return X}),n.d(t,"InputManager",function(){return j}),n.d(t,"Item",function(){return G}),n.d(t,"Object",function(){return O}),n.d(t,"ObjectPhysics",function(){return k}),n.d(t,"Shaders",function(){return $}),n.d(t,"Springs",function(){return h}),n.d(t,"Utilities",function(){return l}),n.d(t,"World",function(){return re}),n.d(t,"FBXLoader",function(){return ae}),n.d(t,"GLTFLoader",function(){return De.a})}])});